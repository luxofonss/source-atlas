<html>
    <head>
        <meta charset="utf-8">
        
            <script src="lib/bindings/utils.js"></script>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/dist/vis-network.min.css" integrity="sha512-WgxfT5LWjfszlPHXRmBWHkV2eceiWTOBvrKCNbdgDYTHrT2AeLCGbF4sZlZw3UMN3WtL0tGUoIAKsu8mllg/XA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
            <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" integrity="sha512-LnvoEWDFrqGHlHmDD2101OrLcbsfkrzoSpvtSQtxK3RMnRV0eOkhhBN2dXHKRrUU8p2DGRTk35n4O8nWSVe1mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            
        
<center>
<h1></h1>
</center>

<!-- <link rel="stylesheet" href="../node_modules/vis/dist/vis.min.css" type="text/css" />
<script type="text/javascript" src="../node_modules/vis/dist/vis.js"> </script>-->
        <link
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
          crossorigin="anonymous"
        />
        <script
          src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
          crossorigin="anonymous"
        ></script>


        <center>
          <h1></h1>
        </center>
        <style type="text/css">

             #mynetwork {
                 width: 100%;
                 height: 900px;
                 background-color: #ffffff;
                 border: 1px solid lightgray;
                 position: relative;
                 float: left;
             }

             

             

             
        </style>
    </head>


    <body>
        <div class="card" style="width: 100%">
            
            
            <div id="mynetwork" class="card-body"></div>
        </div>

        
        

        <script type="text/javascript">

              // initialize global variables.
              var edges;
              var nodes;
              var allNodes;
              var allEdges;
              var nodeColors;
              var originalNodes;
              var network;
              var container;
              var options, data;
              var filter = {
                  item : '',
                  property : '',
                  value : []
              };

              

              

              // This method is responsible for drawing the graph, returns the drawn network
              function drawGraph() {
                  var container = document.getElementById('mynetwork');

                  

                  // parsing and collecting nodes and edges from the python
                  nodes = new vis.DataSet([{"color": "#10b981", "id": "QuizServiceImpl", "label": "Class: QuizServiceImpl", "shape": "dot", "title": "@Service\n@Slf4j\npublic class QuizServiceImpl implements QuizService {\n    private final QuizMapper quizMapper;\n    private final QuestionMapper questionMapper;\n    private final QuizRepository quizRepository;\n    private final QuestionRepository questionRepository;\n    private final QuizAttemptRepository quizAttemptRepository;\n    private final QuizAnswerRepository quizAnswerRepository;\n    private final UserRepository userRepository;\n    private final SavedQuizRepository savedQuizRepository;\n  "}, {"color": "#22c55e", "id": "QuizServiceImpl.createQuiz", "label": "QuizServiceImpl.createQuiz()", "shape": "dot", "title": "@Override\n    public BaseCreateUpdateResponse createQuiz(CreateQuizDto request, UUID authorId) {\n        Quiz q = quizMapper.createQuizDtoToQuiz(request);\n        q.setAuthorId(authorId);\n        quizRepository.save(q);\n        return new BaseCreateUpdateResponse(q.getId().toString());\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.updateQuiz", "label": "QuizServiceImpl.updateQuiz()", "shape": "dot", "title": "@Override\n    @Transactional(rollbackFor = Exception.class)\n    public BaseCreateUpdateResponse updateQuiz(CreateQuizDto request) {\n        if (request.getId() == null) {\n            throw new IllegalArgumentException(\"Quiz ID must be provided for update operation.\");\n        }\n        UUID quizId = UUID.fromString(request.getId());\n        Quiz existingQuiz = quizRepository.findById(request.getId())\n                .orElseThrow(() -\u003e new EntityNotFoundException(\"Quiz with ID \" + request.getId()"}, {"color": "#22c55e", "id": "QuizServiceImpl.getAllPublicQuizzes", "label": "QuizServiceImpl.getAllPublicQuizzes()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e getAllPublicQuizzes() {\n        List\u003cQuiz\u003e quizzes = quizRepository.findAllPublic();\n        getQuizAuthor(quizzes);\n        return quizzes;\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getMyQuizzes", "label": "QuizServiceImpl.getMyQuizzes()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e getMyQuizzes(UUID id) {\n        List\u003cQuiz\u003e quizzes = quizRepository.findByUserId(id);\n        getQuizAuthor(quizzes);\n        return quizzes;\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getById", "label": "QuizServiceImpl.getById()", "shape": "dot", "title": "@Override\n    public Quiz getById(String id) {\n        Quiz quiz = quizRepository.findById(id)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n        Set\u003cQuestion\u003e questions = new HashSet\u003c\u003e(questionRepository.findByQuizId(id));\n        quiz.setQuestions(questions);\n        getQuizAuthor(Collections.singletonList(quiz));\n        return quiz;\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.deleteQuiz", "label": "QuizServiceImpl.deleteQuiz()", "shape": "dot", "title": "@Override\n    public void deleteQuiz(String id) {\n        Quiz quiz = quizRepository.findById(id)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n        quiz.setDeletedAt(LocalDateTime.now());\n        quizRepository.save(quiz);\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.startQuiz", "label": "QuizServiceImpl.startQuiz()", "shape": "dot", "title": "@Override\n    @Transactional\n    public BaseCreateUpdateResponse startQuiz(String quizId, UUID userId) {\n        quizRepository.findById(quizId)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n        QuizAttempt quizAttempt = new QuizAttempt();\n        quizAttempt.setQuizId(UUID.fromString(quizId));\n        quizAttempt.setUserId(userId);\n        quizAttempt.setScore(BigDecimal.ZERO);\n        quizAttempt.setCorrectAnswers(0);\n        quizAttempt.setTimeSp"}, {"color": "#22c55e", "id": "QuizServiceImpl.submitQuizQuestion", "label": "QuizServiceImpl.submitQuizQuestion()", "shape": "dot", "title": "@Override\n    @Transactional\n    public BaseCreateUpdateResponse submitQuizQuestion(String attemptId, SubmitAnswerRequest request, UUID id) {\n        UUID questionId = UUID.fromString(request.getQuestionId());\n        QuizAttempt quizAttempt = quizAttemptRepository.findById(attemptId)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_ATTEMPT_NOT_FOUND));\n        if (quizAttempt.getCompletedAt() != null) {\n            throw new BusinessException(ErrorConstant.QUIZ_ATTEMP"}, {"color": "#22c55e", "id": "QuizServiceImpl.getMyQuizAttempts", "label": "QuizServiceImpl.getMyQuizAttempts()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e getMyQuizAttempts(String userId) {\n        List\u003cQuizAttempt\u003e attempts = quizAttemptRepository.findByUserId(UUID.fromString(userId));\n        if (CollectionUtils.isEmpty(attempts)) {\n            return Collections.emptyList();\n        }\n        Set\u003cString\u003e quizId = attempts.stream()\n                .map(QuizAttempt::getQuizId)\n                .map(UUID::toString)\n                .collect(Collectors.toSet());\n        List\u003cQuiz\u003e quizzes = quizRepository.findByIdIn(qu"}, {"color": "#22c55e", "id": "QuizServiceImpl.getAttempt", "label": "QuizServiceImpl.getAttempt()", "shape": "dot", "title": "@Override\n    public QuizAttempt getAttempt(String attemptId, UUID userId) {\n        QuizAttempt attempt = quizAttemptRepository.findById(attemptId).orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_ATTEMPT_NOT_FOUND));\n        Quiz quiz = this.getById(attempt.getQuizId().toString());\n        getQuizAuthor(Collections.singletonList(quiz));\n        attempt.setQuiz(quiz);\n        List\u003cQuizAnswer\u003e answers = quizAnswerRepository.findByQuizAttemptId(attemptId);\n        attempt.setAnswers(ans"}, {"color": "#22c55e", "id": "QuizServiceImpl.submitQuizComplete", "label": "QuizServiceImpl.submitQuizComplete()", "shape": "dot", "title": "@Override\n    public void submitQuizComplete(String attemptId, UUID id) {\n        QuizAttempt attempt = quizAttemptRepository.findById(attemptId).orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_ATTEMPT_NOT_FOUND));\n        if (!id.equals(attempt.getUserId())) {\n            throw new BusinessException(ErrorConstant.QUIZ_ATTEMPT_NOT_BELONG_TO_USER);\n        }\n        if (attempt.getCompletedAt() != null) {\n            throw new BusinessException(ErrorConstant.QUIZ_ATTEMPT_SUBMITTED);\n  "}, {"color": "#22c55e", "id": "QuizServiceImpl.getQuizStatsById", "label": "QuizServiceImpl.getQuizStatsById()", "shape": "dot", "title": "@Override\n    public Quiz getQuizStatsById(String id) {\n        Quiz quiz = quizRepository.findById(id)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n        getQuizAuthor(Collections.singletonList(quiz));\n        List\u003cQuestion\u003e questions = questionRepository.findByQuizId(id);\n        quiz.setQuestions(new HashSet\u003c\u003e(questions));\n        List\u003cQuizAttempt\u003e attempts = quizAttemptRepository.findByQuizId(quiz.getId().toString());\n        attempts.forEach(att"}, {"color": "#22c55e", "id": "QuizServiceImpl.saveQuiz", "label": "QuizServiceImpl.saveQuiz()", "shape": "dot", "title": "@Override\n    public void saveQuiz(String quizId, UUID userId) {\n        savedQuizRepository.saveQuiz(quizId, userId.toString());\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getSavedQuizzes", "label": "QuizServiceImpl.getSavedQuizzes()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e getSavedQuizzes(UUID userId) {\n        List\u003cUserSavedQuiz\u003e savedQuizzes = savedQuizRepository.findAllByUserId(userId.toString());\n        if (CollectionUtils.isEmpty(savedQuizzes)) {\n            return Collections.emptyList();\n        }\n        Set\u003cString\u003e quizIds = savedQuizzes.stream()\n                .map(UserSavedQuiz::getQuizId)\n                .map(UUID::toString)\n                .collect(Collectors.toSet());\n        if (CollectionUtils.isEmpty(quizIds)) {\n "}, {"color": "#22c55e", "id": "QuizServiceImpl.unsaveQuiz", "label": "QuizServiceImpl.unsaveQuiz()", "shape": "dot", "title": "@Override\n    public void unsaveQuiz(String quizId, UUID userId) {\n        UserSavedQuiz savedQuiz = savedQuizRepository.findAllByQuizId(quizId)\n                .stream()\n                .filter(q -\u003e q.getUserId().equals(userId))\n                .findFirst()\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_SAVED));\n        savedQuiz.setSavedAt(LocalDateTime.now());\n        savedQuiz.setDeletedAt(null);\n        savedQuizRepository.update(savedQuiz);\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getUserSavedQuiz", "label": "QuizServiceImpl.getUserSavedQuiz()", "shape": "dot", "title": "@Override\n    public List\u003cUserSavedQuiz\u003e getUserSavedQuiz(String quizId, UUID userId) {\n        List\u003cUserSavedQuiz\u003e savedQuizzes = savedQuizRepository.findAllByUserId(userId.toString());\n        savedQuizzes.forEach(savedQuiz -\u003e {\n            userRepository.getUserById(savedQuiz.getUserId().toString()).ifPresent(savedQuiz::setUser);\n        });\n        return savedQuizzes;\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.search", "label": "QuizServiceImpl.search()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e search(String query) {\n        if (query == null) throw new BusinessException(ErrorConstant.QUIZ_NOT_FOUND); \n        return quizRepository.findAll();\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.search2", "label": "QuizServiceImpl.search2()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e search2(String query) {\n        if (query == null) throw new BusinessException(ErrorConstant.QUIZ_NOT_FOUND); \n        return quizRepository.findAll();\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getQuizAuthor", "label": "QuizServiceImpl.getQuizAuthor()", "shape": "dot", "title": "private void getQuizAuthor(List\u003cQuiz\u003e quizzes) {\n        quizzes.forEach(q -\u003e {\n            if (q.getAuthorId() != null) {\n                q.setAuthor(userRepository.getUserById(q.getAuthorId().toString()).orElse(null));\n            }\n        });\n    }"}]);
                  edges = new vis.DataSet([{"arrows": "to", "color": "#374151", "from": "QuizServiceImpl.getAllPublicQuizzes", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor", "width": 1}, {"arrows": "to", "color": "#374151", "from": "QuizServiceImpl.getMyQuizzes", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor", "width": 1}, {"arrows": "to", "color": "#374151", "from": "QuizServiceImpl.getById", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor", "width": 1}, {"arrows": "to", "color": "#374151", "from": "QuizServiceImpl.getMyQuizAttempts", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor", "width": 1}, {"arrows": "to", "color": "#374151", "from": "QuizServiceImpl.getAttempt", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor", "width": 1}, {"arrows": "to", "color": "#374151", "from": "QuizServiceImpl.getQuizStatsById", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor", "width": 1}, {"arrows": "to", "color": "#374151", "from": "QuizServiceImpl.getSavedQuizzes", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor", "width": 1}]);

                  nodeColors = {};
                  allNodes = nodes.get({ returnType: "Object" });
                  for (nodeId in allNodes) {
                    nodeColors[nodeId] = allNodes[nodeId].color;
                  }
                  allEdges = edges.get({ returnType: "Object" });
                  // adding nodes and edges to the graph
                  data = {nodes: nodes, edges: edges};

                  var options = {"physics": {"enabled": true, "stabilization": {"iterations": 100}}, "interaction": {"multiselect": true, "selectConnectedEdges": false}};

                  


                  

                  network = new vis.Network(container, data, options);

                  

                  

                  


                  

                  return network;

              }
              drawGraph();
        </script>
    </body>
</html>
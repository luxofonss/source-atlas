<html>
    <head>
        <meta charset="utf-8">
        
            <script src="lib/bindings/utils.js"></script>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/dist/vis-network.min.css" integrity="sha512-WgxfT5LWjfszlPHXRmBWHkV2eceiWTOBvrKCNbdgDYTHrT2AeLCGbF4sZlZw3UMN3WtL0tGUoIAKsu8mllg/XA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
            <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" integrity="sha512-LnvoEWDFrqGHlHmDD2101OrLcbsfkrzoSpvtSQtxK3RMnRV0eOkhhBN2dXHKRrUU8p2DGRTk35n4O8nWSVe1mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            
        
<center>
<h1></h1>
</center>

<!-- <link rel="stylesheet" href="../node_modules/vis/dist/vis.min.css" type="text/css" />
<script type="text/javascript" src="../node_modules/vis/dist/vis.js"> </script>-->
        <link
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
          crossorigin="anonymous"
        />
        <script
          src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
          crossorigin="anonymous"
        ></script>


        <center>
          <h1></h1>
        </center>
        <style type="text/css">

             #mynetwork {
                 width: 100%;
                 height: 900px;
                 background-color: #ffffff;
                 border: 1px solid lightgray;
                 position: relative;
                 float: left;
             }

             
             #loadingBar {
                 position:absolute;
                 top:0px;
                 left:0px;
                 width: 100%;
                 height: 900px;
                 background-color:rgba(200,200,200,0.8);
                 -webkit-transition: all 0.5s ease;
                 -moz-transition: all 0.5s ease;
                 -ms-transition: all 0.5s ease;
                 -o-transition: all 0.5s ease;
                 transition: all 0.5s ease;
                 opacity:1;
             }

             #bar {
                 position:absolute;
                 top:0px;
                 left:0px;
                 width:20px;
                 height:20px;
                 margin:auto auto auto auto;
                 border-radius:11px;
                 border:2px solid rgba(30,30,30,0.05);
                 background: rgb(0, 173, 246); /* Old browsers */
                 box-shadow: 2px 0px 4px rgba(0,0,0,0.4);
             }

             #border {
                 position:absolute;
                 top:10px;
                 left:10px;
                 width:500px;
                 height:23px;
                 margin:auto auto auto auto;
                 box-shadow: 0px 0px 4px rgba(0,0,0,0.2);
                 border-radius:10px;
             }

             #text {
                 position:absolute;
                 top:8px;
                 left:530px;
                 width:30px;
                 height:50px;
                 margin:auto auto auto auto;
                 font-size:22px;
                 color: #000000;
             }

             div.outerBorder {
                 position:relative;
                 top:400px;
                 width:600px;
                 height:44px;
                 margin:auto auto auto auto;
                 border:8px solid rgba(0,0,0,0.1);
                 background: rgb(252,252,252); /* Old browsers */
                 background: -moz-linear-gradient(top,  rgba(252,252,252,1) 0%, rgba(237,237,237,1) 100%); /* FF3.6+ */
                 background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(252,252,252,1)), color-stop(100%,rgba(237,237,237,1))); /* Chrome,Safari4+ */
                 background: -webkit-linear-gradient(top,  rgba(252,252,252,1) 0%,rgba(237,237,237,1) 100%); /* Chrome10+,Safari5.1+ */
                 background: -o-linear-gradient(top,  rgba(252,252,252,1) 0%,rgba(237,237,237,1) 100%); /* Opera 11.10+ */
                 background: -ms-linear-gradient(top,  rgba(252,252,252,1) 0%,rgba(237,237,237,1) 100%); /* IE10+ */
                 background: linear-gradient(to bottom,  rgba(252,252,252,1) 0%,rgba(237,237,237,1) 100%); /* W3C */
                 filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fcfcfc', endColorstr='#ededed',GradientType=0 ); /* IE6-9 */
                 border-radius:72px;
                 box-shadow: 0px 0px 10px rgba(0,0,0,0.2);
             }
             

             

             
        </style>
    </head>


    <body>
        <div class="card" style="width: 100%">
            
            
            <div id="mynetwork" class="card-body"></div>
        </div>

        
            <div id="loadingBar">
              <div class="outerBorder">
                <div id="text">0%</div>
                <div id="border">
                  <div id="bar"></div>
                </div>
              </div>
            </div>
        
        

        <script type="text/javascript">

              // initialize global variables.
              var edges;
              var nodes;
              var allNodes;
              var allEdges;
              var nodeColors;
              var originalNodes;
              var network;
              var container;
              var options, data;
              var filter = {
                  item : '',
                  property : '',
                  value : []
              };

              

              

              // This method is responsible for drawing the graph, returns the drawn network
              function drawGraph() {
                  var container = document.getElementById('mynetwork');

                  

                  // parsing and collecting nodes and edges from the python
                  nodes = new vis.DataSet([{"color": "#3b82f6", "id": "OneStudyApplication", "label": "Class: OneStudyApplication", "shape": "dot", "title": "@SpringBootApplication\n@PropertySource(value = \"classpath:errors.properties\", encoding = \"UTF-8\")\n@ComponentScan(\"com.edu\")\n@EnableCaching\n@EnableAspectJAutoProxy\n@EnableFeignClients(basePackages = \"com.edu.onestudy.thirdparty\")\npublic class OneStudyApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(OneStudyApplication.class, args);\n    }\n\n}"}, {"color": "#22c55e", "id": "OneStudyApplication.main", "label": "OneStudyApplication.main()", "shape": "dot", "title": "public static void main(String[] args) {\n        SpringApplication.run(OneStudyApplication.class, args);\n    }"}, {"color": "#3b82f6", "id": "CurrentUser", "label": "Class: CurrentUser", "shape": "dot", "title": "@Target({ElementType.PARAMETER, ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@AuthenticationPrincipal\npublic @interface CurrentUser {\n}"}, {"color": "#3b82f6", "id": "LogsActivityAnnotation", "label": "Class: LogsActivityAnnotation", "shape": "dot", "title": "@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface LogsActivityAnnotation {\n}"}, {"color": "#3b82f6", "id": "ValueOfEnum", "label": "Class: ValueOfEnum", "shape": "dot", "title": "@Target(value = {METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE})\n@Retention(RUNTIME)\n@Documented\n@Constraint(validatedBy = ValueOfEnumValidator.class)\npublic @interface ValueOfEnum {\n    Class\u003c? extends Enum\u003c?\u003e\u003e enumClass();\n    String message() default \"must be any of enum {enumClass}\";\n    Class\u003c?\u003e[] groups() default {};\n    Class\u003c? extends Payload\u003e[] payload() default {};\n}"}, {"color": "#3b82f6", "id": "AppConfig", "label": "Class: AppConfig", "shape": "dot", "title": "@Configuration\npublic class AppConfig {\n\n    @Value(\"${cors.whitelist}\")\n    private String corsWhitelistString;\n\n    @Bean\n    public CorsConfigurationSource corsConfigurationSource() {\n        List\u003cString\u003e allowedOrigins = Arrays.stream(corsWhitelistString.split(\",\"))\n                .map(String::trim)\n                .filter(origin -\u003e !origin.isEmpty())\n                .toList();\n\n        CorsConfiguration configuration = new CorsConfiguration();\n        configuration.setAllowedOrigins(allowedOrigins);\n        configuration.setAllowedMethods(List.of(\"HEAD\", \"GET\", \"POST\", \"PUT\", \"DELETE\", \"PATCH\"));\n        configuration.setAllowCredentials(true);\n        configuration.setAllowedHeaders(List.of(\"*\"));\n\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration(\"/**\", configuration);\n        return source;\n    }\n}"}, {"color": "#22c55e", "id": "AppConfig.corsConfigurationSource", "label": "AppConfig.corsConfigurationSource()", "shape": "dot", "title": "@Bean\n    public CorsConfigurationSource corsConfigurationSource() {\n        List\u003cString\u003e allowedOrigins = Arrays.stream(corsWhitelistString.split(\",\"))\n                .map(String::trim)\n                .filter(origin -\u003e !origin.isEmpty())\n                .toList();\n\n        CorsConfiguration configuration = new CorsConfiguration();\n        configuration.setAllowedOrigins(allowedOrigins);\n        configuration.setAllowedMethods(List.of(\"HEAD\", \"GET\", \"POST\", \"PUT\", \"DELETE\", \"PATCH\"));\n        configuration.setAllowCredentials(true);\n        configuration.setAllowedHeaders(List.of(\"*\"));\n\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration(\"/**\", configuration);\n        return source;\n    }"}, {"color": "#3b82f6", "id": "AwsS3Config", "label": "Class: AwsS3Config", "shape": "dot", "title": "@Configuration\npublic class AwsS3Config {\n    @Value(\"${aws.accessKey}\")\n    private String accessKey;\n\n    @Value(\"${aws.secretKey}\")\n    private String secretKey;\n\n    @Value(\"${aws.region}\")\n    private String region;\n\n    @Bean\n    public S3Client getS3Client() {\n        AwsBasicCredentials credentials = AwsBasicCredentials.create(accessKey, secretKey);\n\n        return S3Client.builder()\n                .region(Region.of(region))\n                .credentialsProvider(StaticCredentialsProvider.create(credentials))\n                .build();\n    }\n}"}, {"color": "#22c55e", "id": "AwsS3Config.getS3Client", "label": "AwsS3Config.getS3Client()", "shape": "dot", "title": "@Bean\n    public S3Client getS3Client() {\n        AwsBasicCredentials credentials = AwsBasicCredentials.create(accessKey, secretKey);\n\n        return S3Client.builder()\n                .region(Region.of(region))\n                .credentialsProvider(StaticCredentialsProvider.create(credentials))\n                .build();\n    }"}, {"color": "#3b82f6", "id": "StringListConverter", "label": "Class: StringListConverter", "shape": "dot", "title": "@Converter\npublic class StringListConverter implements AttributeConverter\u003cList\u003cString\u003e, String\u003e {\n\n    private static final String SPLIT_CHAR = \",\"; \n\n    @Override\n    public String convertToDatabaseColumn(List\u003cString\u003e stringList) {\n        if (stringList == null || stringList.isEmpty()) {\n            return null;\n        }\n        \n        return \"{\" + String.join(SPLIT_CHAR, stringList) + \"}\";\n    }\n\n    @Override\n    public List\u003cString\u003e convertToEntityAttribute(String string) {\n        if (string == null || string.isEmpty()) {\n            return null;\n        }\n        \n        String cleanedString = string.replaceAll(\"^\\\\{|\\\\}$\", \"\");\n        return Arrays.asList(cleanedString.split(SPLIT_CHAR));\n    }\n}"}, {"color": "#22c55e", "id": "StringListConverter.convertToDatabaseColumn", "label": "StringListConverter.convertToDatabaseColumn()", "shape": "dot", "title": "@Override\n    public String convertToDatabaseColumn(List\u003cString\u003e stringList) {\n        if (stringList == null || stringList.isEmpty()) {\n            return null;\n        }\n        \n        return \"{\" + String.join(SPLIT_CHAR, stringList) + \"}\";\n    }"}, {"color": "#22c55e", "id": "StringListConverter.convertToEntityAttribute", "label": "StringListConverter.convertToEntityAttribute()", "shape": "dot", "title": "@Override\n    public List\u003cString\u003e convertToEntityAttribute(String string) {\n        if (string == null || string.isEmpty()) {\n            return null;\n        }\n        \n        String cleanedString = string.replaceAll(\"^\\\\{|\\\\}$\", \"\");\n        return Arrays.asList(cleanedString.split(SPLIT_CHAR));\n    }"}, {"color": "#3b82f6", "id": "Constant", "label": "Class: Constant", "shape": "dot", "title": "public final class Constant {\n\n    public static final Integer COURSE_CODE_LENGTH = 6;\n\n    public static final Integer SIGNED_URL_EXPIRATION = 60 * 1000;\n\n    public static final String STORAGE_AWS = \"AWS_S3_NORMAL\";\n\n    public static final String STORAGE_GCP = \"STORAGE_GCP\";\n}"}, {"color": "#3b82f6", "id": "Difficulty", "label": "Class: Difficulty", "shape": "dot", "title": "@Getter\npublic enum Difficulty {\n    BEGINNER(\"beginner\"),\n    INTERMEDIATE(\"intermediate\"),\n    ADVANCED(\"advanced\");\n\n    private final String value;\n\n    Difficulty(String value) {\n        this.value = value;\n    }\n}"}, {"color": "#3b82f6", "id": "ErrorConstant", "label": "Class: ErrorConstant", "shape": "dot", "title": "public class ErrorConstant {\n\n    private ErrorConstant() {}\n\n    public static final int SUCCESS = 200000;\n    public static final int SUCCESS_200 = 200;\n\n    public static final int INVALID_PARAMETERS = 4000001;\n\n    public static final int SYSTEM_CONFIGURATION_NOT_FOUND = 4004208;\n\n    public static final int TRANSACTION_NOT_FOUND = 4001210;\n\n    public static final int TRANSACTION_NOT_EXIST = 4001218;\n\n    public static final int TRANSACTION_MUST_NOT_REFUND = 4001212;\n\n    public static final int TRANSACTION_NOT_SUCCESS = 4001213;\n\n    public static final int TRANSACTION_NOT_ENOUGH_AMOUNT = 4001214;\n\n    public static final int HTTP_CONNECTION_ERROR  = 4009000;\n\n    public static final int NULL_META_DATA_RESPONSE  = 4009001;\n\n    public static final int UNAUTHORIZED = 4010001;\n    public static final int USERNAME_PASSWORD_WRONG = 4010002;\n\n    public static final int FORBIDDEN_ERROR = 4030001;\n\n    public static final int NOT_FOUND = 4040001;\n    public static final int QUIZ_NOT_FOUND = 4040002;\n    public static final int QUIZ_ATTEMPT_NOT_FOUND = 4040003;\n    public static final int QUIZ_ATTEMPT_SUBMITTED = 4040004;\n    public static final int QUESTION_DOES_NOT_BELONG_TO_QUIZ = 4040005;\n    public static final int QUESTION_NOT_FOUND = 4040006;\n    public static final int QUIZ_ATTEMPT_NOT_BELONG_TO_USER = 4040007;\n    public static final int QUIZ_TIME_LIMIT_EXCEEDED = 4040008;\n    public static final int QUIZ_NOT_SAVED = 4040009;\n    public static final int GET_PRONUNCIATION_SAMPLE_ERROR = 4040010;\n    public static final int GET_PRONUNCIATION_ACCURACY_ERROR = 4040011;\n\n    public static final int INVALID_VA_NUMBER = 40010525;\n\n    public static final int INTERNAL_SERVER_ERROR = 5001001;\n\n}"}, {"color": "#3b82f6", "id": "PronunciationLevel", "label": "Class: PronunciationLevel", "shape": "dot", "title": "@Getter\npublic enum PronunciationLevel {\n    HARD(\"3\"),\n    MEDIUM(\"2\"),\n    EASY(\"1\"),\n    RANDOM(\"0\"),\n    ;\n\n    private final String value;\n\n    PronunciationLevel(String value) {\n        this.value = value;\n    }\n\n    public static PronunciationLevel fromLevel(String level) {\n        for (PronunciationLevel pronunciationLevel : values()) {\n            if (pronunciationLevel.getValue().equals(level)) {\n                return pronunciationLevel;\n            }\n        }\n        throw new IllegalArgumentException(\"Unknown level: \" + level);\n    }\n\n}"}, {"color": "#3b82f6", "id": "QuestionType", "label": "Class: QuestionType", "shape": "dot", "title": "@Getter\npublic enum QuestionType {\n    MULTIPLE_CHOICE(\"multiple-choice\"),\n    PRONUNCIATION(\"pronunciation\"),\n    FILL_IN_THE_BLANK(\"fill-in-the-blank\"),\n    TRUE_FALSE(\"true-false\"),\n    LISTENING(\"listening\");\n\n    private final String value;\n\n    QuestionType(String value) {\n        this.value = value;\n    }\n}"}, {"color": "#3b82f6", "id": "QuizNavigationMode", "label": "Class: QuizNavigationMode", "shape": "dot", "title": "@Getter\npublic enum QuizNavigationMode {\n    SEQUENTIAL(\"sequential\"),\n    BACK_ONLY(\"back-only\"),\n    FREE_NAVIGATION(\"free-navigation\");\n\n    private final String value;\n\n    QuizNavigationMode(String value) {\n        this.value = value;\n    }\n}"}, {"color": "#3b82f6", "id": "QuizStatus", "label": "Class: QuizStatus", "shape": "dot", "title": "public enum QuizStatus {\n    DRAFT,\n    PUBLIC,\n    PRIVATE\n}"}, {"color": "#3b82f6", "id": "RequestKeyConstant", "label": "Class: RequestKeyConstant", "shape": "dot", "title": "public class RequestKeyConstant {\n\n    private RequestKeyConstant() {}\n\n    public static final String REQUEST_ID = \"request_id\";\n\n    public static final String THREAD_REQUEST_ID = \"requestId\";\n\n    public static final String REQUEST_PARAMETERS = \"request_parameters\";\n\n    public static final String REQUEST_BODY = \"request_body\";\n\n    public static final String URI = \"uri\";\n\n    public static final String X_REQUEST_ID = \"X-Request-ID\";\n\n    public static final String CONTENT_TYPE = \"Content-Type\";\n\n    public static final String USER_AGENT = \"User-Agent\";\n\n    public static final String X_API_KEY = \"x-api-key\";\n\n    public static final String X_API_SECRET = \"x-api-secret\";\n\n    public static final String API_KEY = \"api_key\";\n\n    public static final String API_SECRET = \"api_secret\";\n\n    public static final String AUTHORIZATION = \"Authorization\";\n\n}"}, {"color": "#3b82f6", "id": "Symbol", "label": "Class: Symbol", "shape": "dot", "title": "public class Symbol {\n    public static final String BACK_SLASH = \"\\\\\";\n    public static final String B_SLASH = \"/\";\n    public static final String ARRAY_OF_OBJECTS_START = \"[{\";\n    public static final String UNDERSCORE = \"_\";\n    public static final String COLON = \":\";\n    public static final String COMMA = \",\";\n    public static final String COMMA_SPACE= \", \";\n    public static final char PLUS = \u0027+\u0027;\n    public static final char MINUS = \u0027-\u0027;\n    public static final String EQUAL = \"=\";\n    public static final String VN_CURRENCY = \"\u0111\u1ed3ng\";\n    public static final String SPACE = \" \";\n    public static final String AT_SIGN = \"@\";\n    public static final String LOGICAL_AND = \"\u0026\u0026\";\n    public static final String OPEN_BRACKET = \"[\";\n    public static final String CLOSE_BRACKET = \"]\";\n}"}, {"color": "#3b82f6", "id": "UrlConstant", "label": "Class: UrlConstant", "shape": "dot", "title": "public class UrlConstant {\n\n    private UrlConstant() {}\n\n    public static final String HEALTH_CHECK_URL = \"/actuator/health\";\n\n    public enum TransactionLogClientServiceApi {\n        GET_TRANSACTION(\"internal/transaction-history/v1/transactions/\"),\n        GET_LIST_TRANSACTION(\"internal/transaction-history/v1/transaction-filters\"),\n        ;\n\n        private String value;\n\n        private TransactionLogClientServiceApi(String value) {\n            this.value = value;\n        }\n\n        public String getValue() {\n            return value;\n        }\n\n        public void setValue(String value) {\n            this.value = value;\n        }\n    }\n}"}, {"color": "#3b82f6", "id": "UserRole", "label": "Class: UserRole", "shape": "dot", "title": "public enum UserRole {\n    USER,\n    ADMIN\n}"}, {"color": "#3b82f6", "id": "BaseCreateUpdateResponse", "label": "Class: BaseCreateUpdateResponse", "shape": "dot", "title": "@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class BaseCreateUpdateResponse {\n\n    private String id;\n\n}"}, {"color": "#3b82f6", "id": "BaseResponse", "label": "Class: BaseResponse", "shape": "dot", "title": "@Data\n@Accessors(chain = true)\n@JsonInclude(JsonInclude.Include.NON_NULL)\n@Slf4j\n@NoArgsConstructor\n@JsonNaming(PropertyNamingStrategies.SnakeCaseStrategy.class)\n@SuperBuilder\npublic class BaseResponse\u003cT\u003e {\n\n    private Meta meta = new Meta();\n\n    private T data;\n\n    public BaseResponse(Meta meta, T data) {\n        this.meta = meta;\n        this.data = data;\n    }\n\n    public static void verifyMetaResponse(BaseResponse\u003c?\u003e baseResponse, HttpStatus httpStatus, int status) {\n        if (Objects.isNull(baseResponse) || Objects.isNull(baseResponse.meta)) {\n            return;\n        }\n\n        Meta meta = baseResponse.meta;\n        if (status != meta.getCode()) {\n            throw new BusinessException(meta.getCode(), meta.getMessage(), httpStatus);\n        }\n    }\n\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofSucceeded(T data) {\n        BaseResponse\u003cT\u003e response = new BaseResponse\u003c\u003e();\n        response.data = data;\n        response.meta.setCode(ErrorConstant.SUCCESS);\n        response.meta.setMessage(\"OK\");\n        return response;\n    }\n\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofSucceeded() {\n        BaseResponse\u003cT\u003e response = new BaseResponse\u003c\u003e();\n        response.meta.setCode(ErrorConstant.SUCCESS);\n        return response;\n    }\n\n    public static BaseResponse ofFailed(BusinessError error) {\n        return ofFailed(error, null);\n    }\n\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(BusinessError error, T data) {\n        return ofFailed(error, null, data);\n    }\n\n    public static BaseResponse ofFailed(BusinessError error, String message) {\n        return ofFailed(error, message, null);\n    }\n\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(BusinessError error, String message, T data) {\n        return ofFailed(error, message, null, data);\n    }\n\n    public static BaseResponse ofFailed(BusinessError error, String message, List\u003cErrorViolation\u003e errors) {\n        BaseResponse response = new BaseResponse\u003c\u003e();\n        response.meta.setCode(error.getCode());\n        response.meta.setMessage((message != null) ? message : error.getMessage());\n        response.meta.setErrors((errors != null) ? new ArrayList\u003c\u003e(errors) : null);\n        if(errors != null \u0026\u0026 errors.size() \u003e 0) {\n            response.meta.setMessage(errors.get(0).getDescription());\n        }\n        return response;\n    }\n\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(BusinessError error, String message, List\u003cErrorViolation\u003e errors, T data) {\n        BaseResponse\u003cT\u003e response = new BaseResponse\u003c\u003e();\n        response.meta.setCode(error.getCode());\n        response.meta.setMessage((message != null) ? message : error.getMessage());\n        response.meta.setErrors((errors != null) ? new ArrayList\u003c\u003e(errors) : null);\n        if(errors != null \u0026\u0026 errors.size() \u003e 0) {\n            response.meta.setMessage(errors.get(0).getDescription());\n        }\n        response.data = data;\n        return response;\n    }\n\n    public static BaseResponse ofFailed(BusinessException exception) {\n        return ofFailed(exception.getError(), exception.getMessage());\n    }\n\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(BusinessException exception, T data) {\n        return ofFailed(exception.getError(), exception.getMessage(), data);\n    }\n\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofSucceeded(String requestId, T data) {\n        BaseResponse\u003cT\u003e response = ofSucceeded(data);\n        response.meta.setRequestId(requestId);\n        return response;\n    }\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofGetListSucceeded(T data, BasicRequestList requestList) {\n        BaseResponse\u003cT\u003e response = ofSucceeded(data);\n        response.meta.setRequestId(requestList.getRequestId());\n        response.meta.setPageSize(requestList.getPageSize());\n        response.meta.setPageIndex(requestList.getPageIndex());\n        response.meta.setTotalItems(requestList.getTotalItems());\n        response.data = data;\n        return response;\n    }\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofSucceeded(BasicRequest request, T data) {\n        BaseResponse\u003cT\u003e response = ofSucceeded(data);\n        response.meta.setRequestId(request.getRequestId());\n        return response;\n    }\n\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofSucceeded(String requestId) {\n        BaseResponse\u003cT\u003e response = ofSucceeded();\n        response.meta.setRequestId(requestId);\n        return response;\n    }\n\n    public static BaseResponse ofFailed(String requestId, BusinessError error) {\n        BaseResponse response = ofFailed(error);\n        response.meta.setRequestId(requestId);\n        return response;\n    }\n\n    public static BaseResponse ofFailed(String requestId, BusinessError error, String message) {\n        BaseResponse response = ofFailed(error, message);\n        response.meta.setRequestId(requestId);\n        return response;\n    }\n\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(String requestId, BusinessError error, T data) {\n        BaseResponse\u003cT\u003e response = ofFailed(error, data);\n        response.meta.setRequestId(requestId);\n        response.data = data;\n        return response;\n    }\n\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(String requestId, BusinessError error, String message, T data) {\n        BaseResponse\u003cT\u003e response = ofFailed(error, message, data);\n        response.meta.setRequestId(requestId);\n        response.data = data;\n        return response;\n    }\n\n    public static BaseResponse ofFailed(String requestId, BusinessError error, String message, List\u003cErrorViolation\u003e errors) {\n        BaseResponse response = ofFailed(error, message, errors);\n        response.meta.setRequestId(requestId);\n        return response;\n    }\n\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(String requestId, BusinessError error, String message, List\u003cErrorViolation\u003e errors, T data) {\n        BaseResponse\u003cT\u003e response = ofFailed(error, message, errors, data);\n        response.meta.setRequestId(requestId);\n        response.data = data;\n        return response;\n    }\n\n    public static BaseResponse ofFailed(String requestId, BusinessException exception) {\n        BaseResponse response = ofFailed(exception);\n        response.meta.setRequestId(requestId);\n        return response;\n    }\n\n    public static \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(String requestId, BusinessException exception, T data) {\n        BaseResponse\u003cT\u003e response = ofFailed(exception, data);\n        response.meta.setRequestId(requestId);\n        response.data = data;\n        return response;\n    }\n}"}, {"color": "#22c55e", "id": "BaseResponse.verifyMetaResponse", "label": "BaseResponse.verifyMetaResponse()", "shape": "dot", "title": "public static void verifyMetaResponse(BaseResponse\u003c?\u003e baseResponse, HttpStatus httpStatus, int status) {\n        if (Objects.isNull(baseResponse) || Objects.isNull(baseResponse.meta)) {\n            return;\n        }\n\n        Meta meta = baseResponse.meta;\n        if (status != meta.getCode()) {\n            throw new BusinessException(meta.getCode(), meta.getMessage(), httpStatus);\n        }\n    }"}, {"color": "#22c55e", "id": "BaseResponse.ofSucceeded", "label": "BaseResponse.ofSucceeded()", "shape": "dot", "title": "public static \u003cT\u003e BaseResponse\u003cT\u003e ofSucceeded(T data) {\n        BaseResponse\u003cT\u003e response = new BaseResponse\u003c\u003e();\n        response.data = data;\n        response.meta.setCode(ErrorConstant.SUCCESS);\n        response.meta.setMessage(\"OK\");\n        return response;\n    }"}, {"color": "#22c55e", "id": "BaseResponse.ofFailed", "label": "BaseResponse.ofFailed()", "shape": "dot", "title": "public static BaseResponse ofFailed(BusinessError error) {\n        return ofFailed(error, null);\n    }"}, {"color": "#22c55e", "id": "BaseResponse.ofGetListSucceeded", "label": "BaseResponse.ofGetListSucceeded()", "shape": "dot", "title": "public static \u003cT\u003e BaseResponse\u003cT\u003e ofGetListSucceeded(T data, BasicRequestList requestList) {\n        BaseResponse\u003cT\u003e response = ofSucceeded(data);\n        response.meta.setRequestId(requestList.getRequestId());\n        response.meta.setPageSize(requestList.getPageSize());\n        response.meta.setPageIndex(requestList.getPageIndex());\n        response.meta.setTotalItems(requestList.getTotalItems());\n        response.data = data;\n        return response;\n    }"}, {"color": "#3b82f6", "id": "BasicCreationResponse", "label": "Class: BasicCreationResponse", "shape": "dot", "title": "@Data\n@Builder\n@JsonNaming(PropertyNamingStrategies.SnakeCaseStrategy.class)\npublic class BasicCreationResponse {\n\n    private String id;\n\n}"}, {"color": "#3b82f6", "id": "BasicRequest", "label": "Class: BasicRequest", "shape": "dot", "title": "@NoArgsConstructor\n@AllArgsConstructor\n@Data\n@SuperBuilder\n@JsonInclude(JsonInclude.Include.NON_NULL)\n@JsonNaming(PropertyNamingStrategies.SnakeCaseStrategy.class)\npublic class BasicRequest implements Serializable {\n\n    private static final long serialVersionUID = 1606619939033520333L;\n\n    private String requestId;\n\n    private String uri;\n\n    private String opsUserEmail;\n\n    private String opsUserId;\n\n    private String opsUsername;\n\n    private List\u003cString\u003e manageMerchants;\n\n    private List\u003cString\u003e branchCodes;\n\n    public boolean isValidByManageMerchants(String merchantCode) {\n        if (StringUtils.isBlank(merchantCode)) {\n            return true;\n        }\n\n        return new HashSet\u003c\u003e(manageMerchants).contains(merchantCode);\n    }\n\n}"}, {"color": "#22c55e", "id": "BasicRequest.isValidByManageMerchants", "label": "BasicRequest.isValidByManageMerchants()", "shape": "dot", "title": "public boolean isValidByManageMerchants(String merchantCode) {\n        if (StringUtils.isBlank(merchantCode)) {\n            return true;\n        }\n\n        return new HashSet\u003c\u003e(manageMerchants).contains(merchantCode);\n    }"}, {"color": "#3b82f6", "id": "BasicRequestList", "label": "Class: BasicRequestList", "shape": "dot", "title": "@NoArgsConstructor\n@AllArgsConstructor\n@Data\n@SuperBuilder\n@JsonInclude(JsonInclude.Include.NON_NULL)\n@JsonNaming(PropertyNamingStrategies.SnakeCaseStrategy.class)\npublic class BasicRequestList extends BasicRequest {\n\n    private static final long serialVersionUID = -2411435498386121564L;\n\n    @NotNull(message = \"page_index must not be null!\")\n    private Long pageIndex;\n\n    private Long pageStart;\n\n    @NotNull(message = \"page_size must not be null!\")\n    private Long pageSize;\n\n    private Long totalItems;\n\n    public BasicRequestList(Long totalItems, String requestId) {\n        this.setTotalItems(totalItems);\n        this.setRequestId(requestId);\n    }\n\n}"}, {"color": "#3b82f6", "id": "ErrorViolation", "label": "Class: ErrorViolation", "shape": "dot", "title": "@Data\n@Accessors(chain = true)\n@AllArgsConstructor\n@NoArgsConstructor\n@JsonInclude(JsonInclude.Include.NON_NULL)\n@JsonNaming(PropertyNamingStrategies.SnakeCaseStrategy.class)\n@SuperBuilder\npublic class ErrorViolation {\n\n    private String field;\n\n    private String code;\n\n    private String description;\n}"}, {"color": "#3b82f6", "id": "Meta", "label": "Class: Meta", "shape": "dot", "title": "@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@JsonInclude(JsonInclude.Include.NON_NULL)\n@SuperBuilder\npublic class Meta {\n\n    private Integer code;\n\n    private Long pageIndex;\n\n    private Long pageSize;\n\n    private Long totalItems;\n\n    private List\u003cErrorViolation\u003e errors;\n\n    private String message;\n\n    private String requestId;\n\n    public Meta(String requestId, int code, Long pageIndex, Long pageSize, long totalItems) {\n        this.requestId = requestId;\n        this.code = code;\n        this.pageSize = pageSize;\n        this.pageIndex = pageIndex;\n        this.totalItems = totalItems;\n    }\n\n    public Meta(String requestId, int code, String message) {\n        this.requestId = requestId;\n        this.code = code;\n        this.message = message;\n    }\n}"}, {"color": "#3b82f6", "id": "FillInBlanks", "label": "Class: FillInBlanks", "shape": "dot", "title": "@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class FillInBlanks {\n\n    private List\u003cString\u003e correctBlanks;\n\n}"}, {"color": "#3b82f6", "id": "LeaderboardEntry", "label": "Class: LeaderboardEntry", "shape": "dot", "title": "@Entity\n@Table(name = \"leaderboard\")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@IdClass(LeaderboardEntryId.class)\npublic class LeaderboardEntry {\n\n    @Id\n    @Column(name = \"quiz_id\", nullable = false)\n    private UUID quizId;\n\n    @Id\n    @Column(name = \"user_id\", nullable = false)\n    private UUID userId;\n\n    @Column(name = \"score\", precision = 5, scale = 2)\n    private BigDecimal score;\n\n    @Column(name = \"completion_time\")\n    private Integer completionTime;\n\n    @Column(name = \"accuracy\", precision = 3, scale = 2)\n    private BigDecimal accuracy;\n\n    @Column(name = \"attempts\")\n    private Integer attempts;\n\n    @Column(name = \"last_attempt\")\n    private LocalDateTime lastAttempt;\n\n    @Column(name = \"rank\")\n    private Integer rank;\n\n    @Column(name = \"deleted_at\")\n    private LocalDateTime deletedAt;\n\n    @Transient\n    private Quiz quiz;\n\n    @Transient\n    private User user;\n\n}"}, {"color": "#3b82f6", "id": "LeaderboardEntryId", "label": "Class: LeaderboardEntryId", "shape": "dot", "title": "@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class LeaderboardEntryId implements Serializable {\n    private UUID quizId;\n    private UUID userId;\n\n    @Override\n    public boolean equals(Object o) {\n        if (this == o) return true;\n        if (o == null || getClass() != o.getClass()) return false;\n        LeaderboardEntryId that = (LeaderboardEntryId) o;\n        return Objects.equals(quizId, that.quizId) \u0026\u0026\n                Objects.equals(userId, that.userId);\n    }\n\n    @Override\n    public int hashCode() {\n        return Objects.hash(quizId, userId);\n    }\n}"}, {"color": "#22c55e", "id": "LeaderboardEntryId.equals", "label": "LeaderboardEntryId.equals()", "shape": "dot", "title": "@Override\n    public boolean equals(Object o) {\n        if (this == o) return true;\n        if (o == null || getClass() != o.getClass()) return false;\n        LeaderboardEntryId that = (LeaderboardEntryId) o;\n        return Objects.equals(quizId, that.quizId) \u0026\u0026\n                Objects.equals(userId, that.userId);\n    }"}, {"color": "#22c55e", "id": "LeaderboardEntryId.hashCode", "label": "LeaderboardEntryId.hashCode()", "shape": "dot", "title": "@Override\n    public int hashCode() {\n        return Objects.hash(quizId, userId);\n    }"}, {"color": "#3b82f6", "id": "Question", "label": "Class: Question", "shape": "dot", "title": "@Entity\n@Table(name = \"questions\")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class Question {\n\n    @Id\n    @GeneratedValue(generator = \"UUID\")\n    @Column(name = \"id\")\n    private UUID id;\n\n    @Column(name = \"quiz_id\")\n    private UUID quizId;\n\n    @Column(name = \"type\")\n    private String type;\n\n    @Column(name = \"text\")\n    private String text;\n\n    @JdbcTypeCode(SqlTypes.JSON)\n    @Column(name = \"options\", columnDefinition = \"jsonb\")\n    private List\u003cQuestionOption\u003e options;\n\n    @Column(name = \"pronunciation_text\")\n    private String pronunciationText;\n\n    @JdbcTypeCode(SqlTypes.JSON)\n    @Column(name = \"fill_in_blanks\", columnDefinition = \"jsonb\")\n    private List\u003cString\u003e correctBlanks;\n\n    @Column(name = \"true_false_answer\")\n    private Boolean trueFalseAnswer;\n\n    @Column(name = \"audio_url\")\n    private String audioUrl;\n\n    @Column(name = \"image_url\")\n    private String imageUrl;\n\n    @Column(name = \"max_listening_time\")\n    private Integer maxListeningTime;\n\n    @Column(name = \"correct_answer\", columnDefinition = \"text[]\")\n    @Type(ListArrayType.class)\n    private List\u003cString\u003e correctAnswer = new ArrayList\u003c\u003e();\n\n    @Column(name = \"explanation\")\n    private String explanation;\n\n    @Column(name = \"points\")\n    private Integer points;\n\n    @Column(name = \"time_limit\")\n    private Integer timeLimit;\n\n    @Column(name = \"difficulty\")\n    private String difficulty;\n\n    @Column(name = \"category\")\n    private String category;\n\n    @Column(name = \"accept_rate\")\n    private Integer acceptRate;\n\n    @CreationTimestamp\n    @Column(name = \"created_at\")\n    private LocalDateTime createdAt;\n\n    @UpdateTimestamp\n    @Column(name = \"updated_at\")\n    private LocalDateTime updatedAt;\n\n    @Column(name = \"deleted_at\")\n    private LocalDateTime deletedAt;\n\n    @Transient\n    private Quiz quiz;\n\n}"}, {"color": "#3b82f6", "id": "QuestionOption", "label": "Class: QuestionOption", "shape": "dot", "title": "@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class QuestionOption {\n\n    private UUID id;\n\n    private Boolean isCorrect;\n\n    private String text;\n\n}"}, {"color": "#3b82f6", "id": "Quiz", "label": "Class: Quiz", "shape": "dot", "title": "@Entity\n@Table(name = \"quizzes\")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class Quiz {\n\n    @Id\n    @GeneratedValue(generator = \"UUID\")\n    @GenericGenerator(name = \"UUID\", strategy = \"org.hibernate.id.UUIDGenerator\")\n    @Column(name = \"id\", updatable = false, nullable = false)\n    private UUID id;\n\n    @Column(name = \"title\")\n    private String title;\n\n    @Column(name = \"description\")\n    private String description;\n\n    @Column(name = \"category\")\n    private String category;\n\n    @Column(name = \"difficulty\")\n    private String difficulty;\n\n    @Column(name = \"duration\")\n    private Integer duration;\n\n    @Column(name = \"question_count\")\n    private Integer questionCount = 0;\n\n    @Column(name = \"tags\", columnDefinition = \"text[]\")\n    @Type(ListArrayType.class)\n    private List\u003cString\u003e tags = new ArrayList\u003c\u003e();\n\n    @Column(name = \"status\")\n    @Enumerated(EnumType.STRING)\n    private QuizStatus status;\n\n    @CreationTimestamp\n    @Column(name = \"created_at\")\n    private LocalDateTime createdAt;\n\n    @UpdateTimestamp\n    @Column(name = \"updated_at\")\n    private LocalDateTime updatedAt;\n\n    @Column(name = \"deleted_at\")\n    private LocalDateTime deletedAt;\n\n    @Column(name = \"author_id\") \n    private UUID authorId;\n\n    @Transient\n    private User author;\n\n    @Column(name = \"rating\", precision = 3, scale = 2)\n    private BigDecimal rating = BigDecimal.valueOf(0.00);\n\n    @Column(name = \"attempts\")\n    private Integer attempts = 0;\n\n    @Column(name = \"passing_score\")\n    private Integer passingScore;\n\n    @Column(name = \"navigation_mode\")\n    private String navigationMode;\n\n    @Column(name = \"has_timer\")\n    private Boolean hasTimer = false;\n\n    @Column(name = \"time_limit\")\n    private Integer timeLimit;\n\n    @Column(name = \"warning_time\")\n    private Integer warningTime;\n\n    @Column(name = \"allow_question_picker\")\n    private Boolean allowQuestionPicker = false;\n\n    @Column(name = \"shuffle_questions\")\n    private Boolean shuffleQuestions = false;\n\n    @Column(name = \"shuffle_answers\")\n    private Boolean shuffleAnswers = false;\n\n    @Column(name = \"show_progress\")\n    private Boolean showProgress = false;\n\n    @Column(name = \"allow_pause\")\n    private Boolean allowPause = false;\n\n    @Column(name = \"max_attempts\")\n    private Integer maxAttempts;\n\n    @Transient\n    private Set\u003cQuestion\u003e questions;\n\n    @Transient\n    private Set\u003cQuizAttempt\u003e quizAttempts;\n\n    @Transient\n    private Set\u003cUser\u003e savedByUsers;\n\n    @Transient\n    private Set\u003cLeaderboardEntry\u003e leaderboardEntries;\n\n}"}, {"color": "#3b82f6", "id": "QuizAnswer", "label": "Class: QuizAnswer", "shape": "dot", "title": "@Entity\n@Table(name = \"quiz_answers\")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class QuizAnswer {\n    @Id\n    @GeneratedValue(generator = \"UUID\")\n    @Column(name = \"id\", updatable = false, nullable = false)\n    private UUID id;\n\n    @Column(name = \"quiz_attempt_id\", nullable = false)\n    private UUID quizAttemptId;\n\n    @Column(name = \"question_id\", nullable = false)\n    private UUID questionId;\n\n    @JdbcTypeCode(SqlTypes.JSON)\n    @Column(name = \"selected_answers\", columnDefinition = \"jsonb\")\n    private List\u003cQuestionOption\u003e selectedAnswers;\n\n    @JdbcTypeCode(SqlTypes.JSON)\n    @Column(name = \"fill_in_blanks_answers\", columnDefinition = \"jsonb\")\n    private List\u003cString\u003e fillInBlanksAnswers;\n\n    @Column(name = \"answer_text\")\n    private String answerText;\n\n    @Column(name = \"is_correct\")\n    private boolean isCorrect;\n\n    @Column(name = \"score_achieved\")\n    private Integer scoreAchieved;\n\n    @Column(name = \"time_taken\")\n    private Integer timeTaken;\n\n    @Column(name = \"audio_url\")\n    private String audioUrl;\n\n    @CreationTimestamp\n    @Column(name = \"answered_at\")\n    private LocalDateTime answeredAt;\n\n}"}, {"color": "#3b82f6", "id": "QuizAttempt", "label": "Class: QuizAttempt", "shape": "dot", "title": "@Entity\n@Table(name = \"quiz_attempts\")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class QuizAttempt {\n\n    @Id\n    @GeneratedValue(generator = \"UUID\")\n    @GenericGenerator(name = \"UUID\", strategy = \"org.hibernate.id.UUIDGenerator\")\n    @Column(name = \"id\", updatable = false, nullable = false)\n    private UUID id;\n\n    @Column(name = \"quiz_id\", nullable = false)\n    private UUID quizId;\n\n    @Column(name = \"user_id\", nullable = false)\n    private UUID userId;\n\n    @Transient\n    private Quiz quiz;\n\n    @Transient\n    private User user;\n\n    @Transient\n    private List\u003cQuizAnswer\u003e answers;\n\n    @Column(name = \"score\", precision = 5, scale = 2)\n    private BigDecimal score;\n\n    @Column(name = \"total_questions\")\n    private Integer totalQuestions;\n\n    @Column(name = \"correct_answers\")\n    private Integer correctAnswers;\n\n    @Column(name = \"time_spent\")\n    private Long timeSpent;\n\n    @Column(name = \"completed_at\")\n    private LocalDateTime completedAt;\n\n    @Column(name = \"passed\")\n    private Boolean passed;\n\n    @Column(name = \"deleted_at\")\n    private LocalDateTime deletedAt;\n\n    @Column(name = \"created_at\")\n    @CreationTimestamp\n    private LocalDateTime createdAt;\n\n}"}, {"color": "#3b82f6", "id": "Resource", "label": "Class: Resource", "shape": "dot", "title": "@Entity\n@Table(name = \"resources\")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@Builder\npublic class Resource {\n\n    @Id\n    @GeneratedValue(generator = \"UUID\")\n    @GenericGenerator(name = \"UUID\", strategy = \"org.hibernate.id.UUIDGenerator\")\n    @Column(name = \"id\")\n    private UUID id;\n\n    @Column(name = \"name\")\n    private String name;\n\n    @Column(name = \"path\")\n    private String path; \n\n    @Column(name = \"url\")\n    private String url;\n\n    @Column(name = \"owner_id\")\n    private UUID ownerId; \n\n    @Column(name = \"extension\")\n    private String extension; \n\n    @Column(name = \"size_bytes\")\n    private Long sizeBytes;\n\n    @Column(name = \"cloud_id\")\n    private String cloudId; \n\n    @Column(name = \"uploaded_at\")\n    private LocalDateTime uploadedAt;\n\n    @Column(name = \"last_modified_at\")\n    private LocalDateTime lastModifiedAt;\n\n    @Column(name = \"deleted_at\")\n    private LocalDateTime deletedAt;\n\n    @JdbcTypeCode(SqlTypes.JSON)\n    @Column(name = \"metadata\", columnDefinition = \"jsonb\")\n    private String metadata;\n\n}"}, {"color": "#3b82f6", "id": "User", "label": "Class: User", "shape": "dot", "title": "@Entity\n@Table(name = \"users\")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class User {\n\n    @Id\n    @GeneratedValue(generator = \"UUID\")\n    @GenericGenerator(name = \"UUID\", strategy = \"org.hibernate.id.UUIDGenerator\")\n    @Column(name = \"id\", updatable = false, nullable = false)\n    private UUID id;\n\n    @Column(name = \"username\", nullable = false, unique = true)\n    private String username;\n\n    @Column(name = \"name\", nullable = false)\n    private String name;\n\n    @Column(name = \"email\", nullable = false, unique = true)\n    private String email;\n\n    @Column(name = \"avatar\")\n    private String avatar;\n\n    @CreationTimestamp\n    @Column(name = \"joined_at\")\n    private LocalDateTime joinedAt;\n\n    @Column(name = \"last_login_at\")\n    private LocalDateTime lastLoginAt;\n\n    @Column(name = \"is_active\")\n    private Boolean isActive = true;\n\n    @Column(name = \"role\", nullable = false)\n    @Enumerated(EnumType.STRING)\n    private UserRole role;\n\n    @Transient\n    private UserCredential credentials;\n\n    @Transient\n    private Set\u003cQuiz\u003e createdQuizzes;\n\n    @Transient\n    private Set\u003cQuizAttempt\u003e quizAttempts;\n\n    @Transient\n    private Set\u003cQuiz\u003e savedQuizzes;\n\n    @Transient\n    private Set\u003cLeaderboardEntry\u003e leaderboardEntries;\n\n}"}, {"color": "#3b82f6", "id": "UserCredential", "label": "Class: UserCredential", "shape": "dot", "title": "@Entity\n@Table(name = \"user_credentials\")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@Builder\npublic class UserCredential {\n\n    @Id\n    @Column(name = \"user_id\", updatable = false, nullable = false)\n    private UUID userId;\n\n    @Transient\n    private User user;\n\n    @Column(name = \"password_hash\", nullable = false)\n    private String passwordHash;\n\n    @CreationTimestamp\n    @Column(name = \"last_password_change_at\")\n    private LocalDateTime lastPasswordChangeAt;\n\n    @Column(name = \"failed_login_attempts\")\n    private Integer failedLoginAttempts = 0;\n\n    @Column(name = \"locked_until\")\n    private LocalDateTime lockedUntil;\n\n    @Column(name = \"deleted_at\")\n    private LocalDateTime deletedAt;\n\n}"}, {"color": "#3b82f6", "id": "UserSavedQuiz", "label": "Class: UserSavedQuiz", "shape": "dot", "title": "@Entity\n@Table(name = \"user_saved_quizzes\")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@IdClass(UserSavedQuizId.class)\npublic class UserSavedQuiz {\n\n    @Id\n    @Column(name = \"user_id\", nullable = false)\n    private UUID userId;\n\n    @Id\n    @Column(name = \"quiz_id\", nullable = false)\n    private UUID quizId;\n\n    @Transient\n    private User user;\n    @Transient\n    private Quiz quiz;\n\n    @CreationTimestamp\n    @Column(name = \"saved_at\", updatable = false)\n    private LocalDateTime savedAt;\n\n    @Column(name = \"deleted_at\")\n    private LocalDateTime deletedAt;\n\n}"}, {"color": "#3b82f6", "id": "UserSavedQuizId", "label": "Class: UserSavedQuizId", "shape": "dot", "title": "@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class UserSavedQuizId implements Serializable {\n    private UUID userId;\n    private UUID quizId;\n\n    @Override\n    public boolean equals(Object o) {\n        if (this == o) return true;\n        if (o == null || getClass() != o.getClass()) return false;\n        UserSavedQuizId that = (UserSavedQuizId) o;\n        return Objects.equals(userId, that.userId) \u0026\u0026\n                Objects.equals(quizId, that.quizId);\n    }\n\n    @Override\n    public int hashCode() {\n        return Objects.hash(userId, quizId);\n    }\n}"}, {"color": "#22c55e", "id": "UserSavedQuizId.equals", "label": "UserSavedQuizId.equals()", "shape": "dot", "title": "@Override\n    public boolean equals(Object o) {\n        if (this == o) return true;\n        if (o == null || getClass() != o.getClass()) return false;\n        UserSavedQuizId that = (UserSavedQuizId) o;\n        return Objects.equals(userId, that.userId) \u0026\u0026\n                Objects.equals(quizId, that.quizId);\n    }"}, {"color": "#22c55e", "id": "UserSavedQuizId.hashCode", "label": "UserSavedQuizId.hashCode()", "shape": "dot", "title": "@Override\n    public int hashCode() {\n        return Objects.hash(userId, quizId);\n    }"}, {"color": "#3b82f6", "id": "BusinessError", "label": "Class: BusinessError", "shape": "dot", "title": "@Data\n@AllArgsConstructor\n@NoArgsConstructor\n@SuperBuilder\npublic class BusinessError implements Serializable {\n\n    private static final long serialVersionUID = 2405172041950251807L;\n\n    private int code;\n\n    private String message;\n\n    private HttpStatus httpStatus;\n\n    private Object data;\n\n    public BusinessError(int code, HttpStatus httpStatus) {\n        this.code = code;\n        this.httpStatus = httpStatus;\n    }\n\n    public BusinessError(int code) {\n        this.code = code;\n    }\n\n    public BusinessError(int code, HttpStatus httpStatus, Object data) {\n        this.code = code;\n        this.httpStatus = httpStatus;\n        this.data = data;\n    }\n\n    public BusinessError(int code, Object data) {\n        this.code = code;\n        this.data = data;\n    }\n\n    public BusinessError(int code, String message) {\n        this.code = code;\n        this.message = message;\n    }\n\n    public BusinessError(int code, String message, HttpStatus httpStatus) {\n        this.code = code;\n        this.message = message;\n        this.httpStatus = httpStatus;\n    }\n}"}, {"color": "#3b82f6", "id": "BusinessException", "label": "Class: BusinessException", "shape": "dot", "title": "@Getter\n@Builder\npublic class BusinessException extends RuntimeException implements Serializable {\n\n    private static final long serialVersionUID = 1905122041950251207L;\n\n    private final BusinessError error;\n\n    public BusinessException(int code, String message, HttpStatus status) {\n        super(message);\n        this.error = new BusinessError(code, message, status);\n    }\n\n    public BusinessException(int code, HttpStatus status) {\n        this.error = new BusinessError(code, status);\n    }\n\n    public BusinessException(int code) {\n        this.error = new BusinessError(code);\n    }\n\n    public BusinessException(int code, Object data) {\n        this.error = new BusinessError(code, data);\n    }\n\n    public BusinessException(int code, String message) {\n        this.error = new BusinessError(code, message);\n    }\n\n    public BusinessException(BusinessError error) {\n        super(error.getMessage());\n        this.error = error;\n    }\n\n    public BusinessException(BusinessError error, String message) {\n        super(message);\n        this.error = error;\n    }\n\n    public BusinessException(BusinessError error, String message, Throwable cause) {\n        super(message, cause);\n        this.error = error;\n    }\n}"}, {"color": "#3b82f6", "id": "CommonExceptionHandler", "label": "Class: CommonExceptionHandler", "shape": "dot", "title": "@Controller\n@ControllerAdvice\n@Slf4j\npublic class CommonExceptionHandler extends BaseService {\n\n    @ExceptionHandler(BusinessException.class)\n    @LogsActivityAnnotation\n    public ResponseEntity\u003cBaseResponse\u003c?\u003e\u003e handleBusinessException(BusinessException exception) {\n        exception.getError().setMessage(getMessage(exception.getError()));\n        Object dataException = exception.getError().getData();\n        BaseResponse\u003c?\u003e data = ofFailed(exception);\n        if(!ObjectUtils.isEmpty(dataException) \u0026\u0026 dataException instanceof String) {\n            data.getMeta().setErrors(Collections.singletonList(\n                ErrorViolation.builder().description((String) dataException).build()));\n        }\n        return new ResponseEntity\u003c\u003e(data, exception.getError().getHttpStatus() == null\n                ? HttpStatus.OK : exception.getError().getHttpStatus());\n    }\n\n    @ExceptionHandler(MethodArgumentNotValidException.class)\n    @LogsActivityAnnotation\n    public ResponseEntity\u003cBaseResponse\u003c?\u003e\u003e handleMethodArgumentNotValidException(MethodArgumentNotValidException exception) {\n        List\u003cErrorViolation\u003e errors = exception.getBindingResult().getFieldErrors().stream()\n            .map(e -\u003e ErrorViolation.builder()\n                .field(CaseFormat.UPPER_CAMEL.to(CaseFormat.LOWER_UNDERSCORE, e.getField()))\n                .code(Integer.toString(getErrorCode(e.getDefaultMessage(), ErrorConstant.INVALID_PARAMETERS)))\n                .description(getMessage(e.getDefaultMessage()))\n                .build())\n            .collect(Collectors.toList());\n\n        BusinessError error = getBusinessError(ErrorConstant.INVALID_PARAMETERS);\n        BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), errors);\n        return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n    }\n\n    @ExceptionHandler(MissingServletRequestParameterException.class)\n    @LogsActivityAnnotation\n    public ResponseEntity\u003cBaseResponse\u003c?\u003e\u003e handleMethodArgumentNotValidException(MissingServletRequestParameterException exception) {\n        BusinessError error = getBusinessError(ErrorConstant.INVALID_PARAMETERS);\n        BaseResponse\u003c?\u003e data = ofFailed(error,\"Param \" + exception.getParameterName() + \" is required\");\n        return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n    }\n\n    @ExceptionHandler(Exception.class)\n    @LogsActivityAnnotation\n    public ResponseEntity\u003cBaseResponse\u003c?\u003e\u003e handleException(Exception exception) {\n        BusinessError error = getBusinessError(ErrorConstant.INTERNAL_SERVER_ERROR);\n        BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), null);\n        return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n    }\n    @ExceptionHandler(HttpMessageNotReadableException.class)\n    @LogsActivityAnnotation\n    public ResponseEntity\u003cBaseResponse\u003c?\u003e\u003e handleException(HttpMessageNotReadableException exception) {\n        BusinessError error = getBusinessError(ErrorConstant.INVALID_PARAMETERS);\n        BaseResponse\u003c?\u003e data = ofFailed(error,\"invalid parameter\");\n        return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n    }\n\n    @ExceptionHandler(IllegalArgumentException.class)\n    @LogsActivityAnnotation\n    public ResponseEntity\u003cBaseResponse\u003c?\u003e\u003e handleIllegalArgumentException(IllegalArgumentException exception) {\n        BusinessError error = getBusinessError(ErrorConstant.INVALID_PARAMETERS);\n        BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), exception.getMessage());\n        return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n    }\n\n    @ExceptionHandler(HttpStatusCodeException.class)\n    @LogsActivityAnnotation\n    public ResponseEntity\u003cBaseResponse\u003c?\u003e\u003e handleHttpStatusCodeException(HttpStatusCodeException exception) {\n        HttpStatus statusCode = (HttpStatus) exception.getStatusCode();\n\n        if (statusCode.value() == HttpStatus.BAD_REQUEST.value()) {\n            BusinessError error = getBusinessError(ErrorConstant.INVALID_PARAMETERS);\n            BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), exception.getMessage());\n            return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n        }\n\n        if (statusCode.value() == HttpStatus.UNAUTHORIZED.value()) {\n            BusinessError error = getBusinessError(ErrorConstant.UNAUTHORIZED);\n            BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), exception.getMessage());\n            return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n        }\n\n        if (statusCode.value() == HttpStatus.FORBIDDEN.value()) {\n            BusinessError error = getBusinessError(ErrorConstant.FORBIDDEN_ERROR);\n            BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), exception.getMessage());\n            return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n        }\n\n        if (statusCode.value() == HttpStatus.NOT_FOUND.value()) {\n            BusinessError error = getBusinessError(ErrorConstant.NOT_FOUND);\n            BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), exception.getMessage());\n            return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n        }\n\n        if (statusCode.value() == HttpStatus.INTERNAL_SERVER_ERROR.value()) {\n            BusinessError error = getBusinessError(ErrorConstant.INTERNAL_SERVER_ERROR);\n            BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), exception.getMessage());\n            return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n        }\n\n        throw exception;\n    }\n}"}, {"color": "#22c55e", "id": "CommonExceptionHandler.handleBusinessException", "label": "CommonExceptionHandler.handleBusinessException()", "shape": "dot", "title": "@ExceptionHandler(BusinessException.class)\n    @LogsActivityAnnotation\n    public ResponseEntity\u003cBaseResponse\u003c?\u003e\u003e handleBusinessException(BusinessException exception) {\n        exception.getError().setMessage(getMessage(exception.getError()));\n        Object dataException = exception.getError().getData();\n        BaseResponse\u003c?\u003e data = ofFailed(exception);\n        if(!ObjectUtils.isEmpty(dataException) \u0026\u0026 dataException instanceof String) {\n            data.getMeta().setErrors(Collections.singletonList(\n                ErrorViolation.builder().description((String) dataException).build()));\n        }\n        return new ResponseEntity\u003c\u003e(data, exception.getError().getHttpStatus() == null\n                ? HttpStatus.OK : exception.getError().getHttpStatus());\n    }"}, {"color": "#22c55e", "id": "CommonExceptionHandler.handleMethodArgumentNotValidException", "label": "CommonExceptionHandler.handleMethodArgumentNotValidException()", "shape": "dot", "title": "@ExceptionHandler(MethodArgumentNotValidException.class)\n    @LogsActivityAnnotation\n    public ResponseEntity\u003cBaseResponse\u003c?\u003e\u003e handleMethodArgumentNotValidException(MethodArgumentNotValidException exception) {\n        List\u003cErrorViolation\u003e errors = exception.getBindingResult().getFieldErrors().stream()\n            .map(e -\u003e ErrorViolation.builder()\n                .field(CaseFormat.UPPER_CAMEL.to(CaseFormat.LOWER_UNDERSCORE, e.getField()))\n                .code(Integer.toString(getErrorCode(e.getDefaultMessage(), ErrorConstant.INVALID_PARAMETERS)))\n                .description(getMessage(e.getDefaultMessage()))\n                .build())\n            .collect(Collectors.toList());\n\n        BusinessError error = getBusinessError(ErrorConstant.INVALID_PARAMETERS);\n        BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), errors);\n        return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n    }"}, {"color": "#22c55e", "id": "CommonExceptionHandler.handleException", "label": "CommonExceptionHandler.handleException()", "shape": "dot", "title": "@ExceptionHandler(Exception.class)\n    @LogsActivityAnnotation\n    public ResponseEntity\u003cBaseResponse\u003c?\u003e\u003e handleException(Exception exception) {\n        BusinessError error = getBusinessError(ErrorConstant.INTERNAL_SERVER_ERROR);\n        BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), null);\n        return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n    }"}, {"color": "#22c55e", "id": "CommonExceptionHandler.handleIllegalArgumentException", "label": "CommonExceptionHandler.handleIllegalArgumentException()", "shape": "dot", "title": "@ExceptionHandler(IllegalArgumentException.class)\n    @LogsActivityAnnotation\n    public ResponseEntity\u003cBaseResponse\u003c?\u003e\u003e handleIllegalArgumentException(IllegalArgumentException exception) {\n        BusinessError error = getBusinessError(ErrorConstant.INVALID_PARAMETERS);\n        BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), exception.getMessage());\n        return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n    }"}, {"color": "#22c55e", "id": "CommonExceptionHandler.handleHttpStatusCodeException", "label": "CommonExceptionHandler.handleHttpStatusCodeException()", "shape": "dot", "title": "@ExceptionHandler(HttpStatusCodeException.class)\n    @LogsActivityAnnotation\n    public ResponseEntity\u003cBaseResponse\u003c?\u003e\u003e handleHttpStatusCodeException(HttpStatusCodeException exception) {\n        HttpStatus statusCode = (HttpStatus) exception.getStatusCode();\n\n        if (statusCode.value() == HttpStatus.BAD_REQUEST.value()) {\n            BusinessError error = getBusinessError(ErrorConstant.INVALID_PARAMETERS);\n            BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), exception.getMessage());\n            return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n        }\n\n        if (statusCode.value() == HttpStatus.UNAUTHORIZED.value()) {\n            BusinessError error = getBusinessError(ErrorConstant.UNAUTHORIZED);\n            BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), exception.getMessage());\n            return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n        }\n\n        if (statusCode.value() == HttpStatus.FORBIDDEN.value()) {\n            BusinessError error = getBusinessError(ErrorConstant.FORBIDDEN_ERROR);\n            BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), exception.getMessage());\n            return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n        }\n\n        if (statusCode.value() == HttpStatus.NOT_FOUND.value()) {\n            BusinessError error = getBusinessError(ErrorConstant.NOT_FOUND);\n            BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), exception.getMessage());\n            return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n        }\n\n        if (statusCode.value() == HttpStatus.INTERNAL_SERVER_ERROR.value()) {\n            BusinessError error = getBusinessError(ErrorConstant.INTERNAL_SERVER_ERROR);\n            BaseResponse\u003c?\u003e data = ofFailed(error, getMessage(error), exception.getMessage());\n            return new ResponseEntity\u003c\u003e(data, HttpStatus.OK);\n        }\n\n        throw exception;\n    }"}, {"color": "#3b82f6", "id": "ApiKeyVerifyRequestWrapper", "label": "Class: ApiKeyVerifyRequestWrapper", "shape": "dot", "title": "public class ApiKeyVerifyRequestWrapper extends HttpServletRequestWrapper {\n\n    private final String body; \n\n    public ApiKeyVerifyRequestWrapper(HttpServletRequest request) throws IOException {\n        super(request);\n        StringBuilder stringBuilder = new StringBuilder();\n        BufferedReader bufferedReader = null;\n        try (InputStream inputStream = request.getInputStream()) { \n            if (inputStream != null) {\n                \n                bufferedReader = new BufferedReader(new InputStreamReader(inputStream, StandardCharsets.UTF_8));\n                char[] charBuffer = new char[128];\n                int bytesRead;\n                while ((bytesRead = bufferedReader.read(charBuffer)) \u003e 0) {\n                    stringBuilder.append(charBuffer, 0, bytesRead);\n                }\n            }\n        } finally {\n            \n        }\n        body = stringBuilder.toString();\n    }\n\n    @Override\n    public ServletInputStream getInputStream() throws IOException {\n        \n        final ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(body.getBytes(StandardCharsets.UTF_8));\n\n        return new ServletInputStream() {\n            @Override\n            public int read() throws IOException {\n                return byteArrayInputStream.read();\n            }\n\n            @Override\n            public boolean isFinished() {\n                \n                return byteArrayInputStream.available() == 0;\n            }\n\n            @Override\n            public boolean isReady() {\n                \n                return true; \n            }\n\n            @Override\n            public void setReadListener(ReadListener listener) {\n                \n            }\n        };\n    }\n\n    @Override\n    public BufferedReader getReader() throws IOException {\n        \n        return new BufferedReader(new InputStreamReader(this.getInputStream(), StandardCharsets.UTF_8));\n    }\n\n    public String getBody() {\n        return body;\n    }\n\n    @Override\n    public String getContentType() {\n        String contentType = super.getContentType();\n        \n        return contentType == null ? MediaType.APPLICATION_JSON_VALUE : contentType;\n    }\n}"}, {"color": "#22c55e", "id": "ApiKeyVerifyRequestWrapper.getInputStream", "label": "ApiKeyVerifyRequestWrapper.getInputStream()", "shape": "dot", "title": "@Override\n    public ServletInputStream getInputStream() throws IOException {\n        \n        final ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(body.getBytes(StandardCharsets.UTF_8));\n\n        return new ServletInputStream() {\n            @Override\n            public int read() throws IOException {\n                return byteArrayInputStream.read();\n            }\n\n            @Override\n            public boolean isFinished() {\n                \n                return byteArrayInputStream.available() == 0;\n            }\n\n            @Override\n            public boolean isReady() {\n                \n                return true; \n            }\n\n            @Override\n            public void setReadListener(ReadListener listener) {\n                \n            }\n        };\n    }"}, {"color": "#22c55e", "id": "ApiKeyVerifyRequestWrapper.getReader", "label": "ApiKeyVerifyRequestWrapper.getReader()", "shape": "dot", "title": "@Override\n    public BufferedReader getReader() throws IOException {\n        \n        return new BufferedReader(new InputStreamReader(this.getInputStream(), StandardCharsets.UTF_8));\n    }"}, {"color": "#22c55e", "id": "ApiKeyVerifyRequestWrapper.getBody", "label": "ApiKeyVerifyRequestWrapper.getBody()", "shape": "dot", "title": "public String getBody() {\n        return body;\n    }"}, {"color": "#22c55e", "id": "ApiKeyVerifyRequestWrapper.getContentType", "label": "ApiKeyVerifyRequestWrapper.getContentType()", "shape": "dot", "title": "@Override\n    public String getContentType() {\n        String contentType = super.getContentType();\n        \n        return contentType == null ? MediaType.APPLICATION_JSON_VALUE : contentType;\n    }"}, {"color": "#3b82f6", "id": "AppCorsFilter", "label": "Class: AppCorsFilter", "shape": "dot", "title": "@Component\n@Order(Ordered.HIGHEST_PRECEDENCE)\n@Slf4j \npublic class AppCorsFilter implements Filter {\n\n    private final MultipartResolver multipartResolver;\n\n    public AppCorsFilter(MultipartResolver multipartResolver) {\n        this.multipartResolver = multipartResolver;\n    }\n\n    public AppCorsFilter() {\n        \n        this.multipartResolver = new StandardServletMultipartResolver();\n    }\n\n    @Override\n    public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException {\n        HttpServletResponse response = (HttpServletResponse) res;\n        HttpServletRequest request = (HttpServletRequest) req;\n\n        if (request.getRequestURI().contains(HEALTH_CHECK_URL)) {\n            chain.doFilter(req, res);\n            return;\n        }\n\n        String requestId = UUID.randomUUID().toString(); \n        ThreadContext.put(THREAD_REQUEST_ID, requestId); \n\n        try {\n            \n            boolean isMultipart = multipartResolver.isMultipart(request); \n\n            if (isMultipart) {\n                \n                MultipartHttpServletRequest multipartRequest = multipartResolver.resolveMultipart(request);\n\n                String headerRequestId = multipartRequest.getHeader(X_REQUEST_ID);\n                if (!ObjectUtils.isEmpty(headerRequestId)) {\n                    requestId = headerRequestId;\n                    ThreadContext.put(THREAD_REQUEST_ID, requestId); \n                }\n\n                multipartRequest.setAttribute(REQUEST_BODY, multipartRequest);\n                multipartRequest.setAttribute(REQUEST_ID, requestId);\n\n                chain.doFilter(multipartRequest, response);\n\n            } else {\n                \n                ApiKeyVerifyRequestWrapper requestWrapper = new ApiKeyVerifyRequestWrapper(request);\n\n                String headerRequestId = requestWrapper.getHeader(X_REQUEST_ID);\n                if (!ObjectUtils.isEmpty(headerRequestId)) {\n                    requestId = headerRequestId;\n                    ThreadContext.put(THREAD_REQUEST_ID, requestId); \n                }\n\n                JSONObject dataRequest = new JSONObject();\n                String requestBodyString = requestWrapper.getBody();\n                if (!ObjectUtils.isEmpty(requestBodyString)) {\n                    try {\n                        JSONParser parser = new JSONParser();\n                        dataRequest = (JSONObject) parser.parse(requestBodyString);\n                    } catch (ParseException e) {\n                        log.warn(\"Failed to parse request body as JSON for URI: {}. Body: {}\", request.getRequestURI(), requestBodyString, e);\n                        \n                    }\n                }\n\n                dataRequest.put(REQUEST_ID, requestId);\n                request.setAttribute(REQUEST_ID, requestId); \n\n                dataRequest.put(API_KEY, requestWrapper.getHeader(API_KEY));\n                request.setAttribute(API_KEY, requestWrapper.getHeader(API_KEY));\n\n                dataRequest.put(API_SECRET, requestWrapper.getHeader(API_SECRET));\n                request.setAttribute(API_SECRET, requestWrapper.getHeader(API_SECRET));\n\n                dataRequest.put(URI, request.getRequestURI());\n                request.setAttribute(URI, request.getRequestURI()); \n\n                request.setAttribute(REQUEST_PARAMETERS, request.getParameterMap()); \n                request.setAttribute(REQUEST_BODY, dataRequest); \n\n                chain.doFilter(requestWrapper, response);\n            }\n        } catch (IOException | ServletException e) {\n            log.error(\"Filter processing error for URI: {}\", request.getRequestURI(), e);\n            response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR); \n        } catch (Throwable e) { \n            log.error(\"An unexpected error occurred in filter for URI: {}\", request.getRequestURI(), e);\n            response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);\n        } finally {\n            \n            ThreadContext.clearAll();\n        }\n    }\n}"}, {"color": "#22c55e", "id": "AppCorsFilter.doFilter", "label": "AppCorsFilter.doFilter()", "shape": "dot", "title": "@Override\n    public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException {\n        HttpServletResponse response = (HttpServletResponse) res;\n        HttpServletRequest request = (HttpServletRequest) req;\n\n        if (request.getRequestURI().contains(HEALTH_CHECK_URL)) {\n            chain.doFilter(req, res);\n            return;\n        }\n\n        String requestId = UUID.randomUUID().toString(); \n        ThreadContext.put(THREAD_REQUEST_ID, requestId); \n\n        try {\n            \n            boolean isMultipart = multipartResolver.isMultipart(request); \n\n            if (isMultipart) {\n                \n                MultipartHttpServletRequest multipartRequest = multipartResolver.resolveMultipart(request);\n\n                String headerRequestId = multipartRequest.getHeader(X_REQUEST_ID);\n                if (!ObjectUtils.isEmpty(headerRequestId)) {\n                    requestId = headerRequestId;\n                    ThreadContext.put(THREAD_REQUEST_ID, requestId); \n                }\n\n                multipartRequest.setAttribute(REQUEST_BODY, multipartRequest);\n                multipartRequest.setAttribute(REQUEST_ID, requestId);\n\n                chain.doFilter(multipartRequest, response);\n\n            } else {\n                \n                ApiKeyVerifyRequestWrapper requestWrapper = new ApiKeyVerifyRequestWrapper(request);\n\n                String headerRequestId = requestWrapper.getHeader(X_REQUEST_ID);\n                if (!ObjectUtils.isEmpty(headerRequestId)) {\n                    requestId = headerRequestId;\n                    ThreadContext.put(THREAD_REQUEST_ID, requestId); \n                }\n\n                JSONObject dataRequest = new JSONObject();\n                String requestBodyString = requestWrapper.getBody();\n                if (!ObjectUtils.isEmpty(requestBodyString)) {\n                    try {\n                        JSONParser parser = new JSONParser();\n                        dataRequest = (JSONObject) parser.parse(requestBodyString);\n                    } catch (ParseException e) {\n                        log.warn(\"Failed to parse request body as JSON for URI: {}. Body: {}\", request.getRequestURI(), requestBodyString, e);\n                        \n                    }\n                }\n\n                dataRequest.put(REQUEST_ID, requestId);\n                request.setAttribute(REQUEST_ID, requestId); \n\n                dataRequest.put(API_KEY, requestWrapper.getHeader(API_KEY));\n                request.setAttribute(API_KEY, requestWrapper.getHeader(API_KEY));\n\n                dataRequest.put(API_SECRET, requestWrapper.getHeader(API_SECRET));\n                request.setAttribute(API_SECRET, requestWrapper.getHeader(API_SECRET));\n\n                dataRequest.put(URI, request.getRequestURI());\n                request.setAttribute(URI, request.getRequestURI()); \n\n                request.setAttribute(REQUEST_PARAMETERS, request.getParameterMap()); \n                request.setAttribute(REQUEST_BODY, dataRequest); \n\n                chain.doFilter(requestWrapper, response);\n            }\n        } catch (IOException | ServletException e) {\n            log.error(\"Filter processing error for URI: {}\", request.getRequestURI(), e);\n            response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR); \n        } catch (Throwable e) { \n            log.error(\"An unexpected error occurred in filter for URI: {}\", request.getRequestURI(), e);\n            response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);\n        } finally {\n            \n            ThreadContext.clearAll();\n        }\n    }"}, {"color": "#3b82f6", "id": "PronunciationMapper", "label": "Class: PronunciationMapper", "shape": "dot", "title": "@Mapper(componentModel = \"spring\")\npublic interface PronunciationMapper {\n\n    @Mapping(target = \"transcript\", source = \"customText\")\n    GetSampleRequest toSampleRequest(GetSampleRequestDto req);\n\n    GetPronunciationSampleResponseDto toGetPronunciationSampleResponseDto(GetSampleResponse response);\n\n    PronunciationAccuracyRequest toPronunciationAccuracyRequest(PronunciationAccuracyRequestDto req);\n\n    PronunciationAccuracyResponseDto toPronunciationAccuracyResponseDto(PronunciationAccuracyResponse response);\n\n}"}, {"color": "#22c55e", "id": "PronunciationMapper.toSampleRequest", "label": "PronunciationMapper.toSampleRequest()", "shape": "dot", "title": "@Mapping(target = \"transcript\", source = \"customText\")\n    GetSampleRequest toSampleRequest(GetSampleRequestDto req);"}, {"color": "#22c55e", "id": "PronunciationMapper.toGetPronunciationSampleResponseDto", "label": "PronunciationMapper.toGetPronunciationSampleResponseDto()", "shape": "dot", "title": "GetPronunciationSampleResponseDto toGetPronunciationSampleResponseDto(GetSampleResponse response);"}, {"color": "#22c55e", "id": "PronunciationMapper.toPronunciationAccuracyRequest", "label": "PronunciationMapper.toPronunciationAccuracyRequest()", "shape": "dot", "title": "PronunciationAccuracyRequest toPronunciationAccuracyRequest(PronunciationAccuracyRequestDto req);"}, {"color": "#22c55e", "id": "PronunciationMapper.toPronunciationAccuracyResponseDto", "label": "PronunciationMapper.toPronunciationAccuracyResponseDto()", "shape": "dot", "title": "PronunciationAccuracyResponseDto toPronunciationAccuracyResponseDto(PronunciationAccuracyResponse response);"}, {"color": "#3b82f6", "id": "QuestionMapper", "label": "Class: QuestionMapper", "shape": "dot", "title": "@Mapper(componentModel = \"spring\")\npublic interface QuestionMapper {\n\n    Question questionDtoToQuestion(QuestionDto dto);\n\n    @Mapping(target = \"createdAt\", ignore = true)\n    @Mapping(target = \"id\", ignore = true)\n    void updateQuestionFromDto(QuestionDto dto, @MappingTarget Question entity);\n\n    QuestionOption optionDtoToOption(OptionDto dto);\n\n    void updateOptionFromDto(OptionDto dto, @MappingTarget QuestionOption entity);\n\n}"}, {"color": "#22c55e", "id": "QuestionMapper.questionDtoToQuestion", "label": "QuestionMapper.questionDtoToQuestion()", "shape": "dot", "title": "Question questionDtoToQuestion(QuestionDto dto);"}, {"color": "#22c55e", "id": "QuestionMapper.updateQuestionFromDto", "label": "QuestionMapper.updateQuestionFromDto()", "shape": "dot", "title": "@Mapping(target = \"createdAt\", ignore = true)\n    @Mapping(target = \"id\", ignore = true)\n    void updateQuestionFromDto(QuestionDto dto, @MappingTarget Question entity);"}, {"color": "#22c55e", "id": "QuestionMapper.optionDtoToOption", "label": "QuestionMapper.optionDtoToOption()", "shape": "dot", "title": "QuestionOption optionDtoToOption(OptionDto dto);"}, {"color": "#22c55e", "id": "QuestionMapper.updateOptionFromDto", "label": "QuestionMapper.updateOptionFromDto()", "shape": "dot", "title": "void updateOptionFromDto(OptionDto dto, @MappingTarget QuestionOption entity);"}, {"color": "#3b82f6", "id": "QuizMapper", "label": "Class: QuizMapper", "shape": "dot", "title": "@Mapper(componentModel = \"spring\")\npublic interface QuizMapper {\n\n    Quiz createQuizDtoToQuiz(CreateQuizDto request);\n\n    @Mapping(target = \"createdAt\", ignore = true)\n    @Mapping(target = \"id\", ignore = true)\n    void updateQuizFromDto(CreateQuizDto dto, @MappingTarget Quiz entity);\n\n}"}, {"color": "#22c55e", "id": "QuizMapper.createQuizDtoToQuiz", "label": "QuizMapper.createQuizDtoToQuiz()", "shape": "dot", "title": "Quiz createQuizDtoToQuiz(CreateQuizDto request);"}, {"color": "#22c55e", "id": "QuizMapper.updateQuizFromDto", "label": "QuizMapper.updateQuizFromDto()", "shape": "dot", "title": "@Mapping(target = \"createdAt\", ignore = true)\n    @Mapping(target = \"id\", ignore = true)\n    void updateQuizFromDto(CreateQuizDto dto, @MappingTarget Quiz entity);"}, {"color": "#3b82f6", "id": "UserMapper", "label": "Class: UserMapper", "shape": "dot", "title": "@Mapper(componentModel = \"spring\")\npublic interface UserMapper {\n\n    User authRegisterRequestToUser(AuthRegisterRequest request);\n\n    AuthProfileResponse userToAuthProfileResponse(User user);\n\n}"}, {"color": "#22c55e", "id": "UserMapper.authRegisterRequestToUser", "label": "UserMapper.authRegisterRequestToUser()", "shape": "dot", "title": "User authRegisterRequestToUser(AuthRegisterRequest request);"}, {"color": "#22c55e", "id": "UserMapper.userToAuthProfileResponse", "label": "UserMapper.userToAuthProfileResponse()", "shape": "dot", "title": "AuthProfileResponse userToAuthProfileResponse(User user);"}, {"color": "#3b82f6", "id": "QuestionRepository", "label": "Class: QuestionRepository", "shape": "dot", "title": "public interface QuestionRepository {\n\n    Question save(Question question);\n\n    Optional\u003cQuestion\u003e findById(String id);\n\n    List\u003cQuestion\u003e findByQuizId(String quizId);\n\n    void saveAll(List\u003cQuestion\u003e questions);\n\n    void deleteAll(List\u003cQuestion\u003e questions);\n\n    Integer countByQuizId(String quizId);\n\n}"}, {"color": "#22c55e", "id": "QuestionRepository.save", "label": "QuestionRepository.save()", "shape": "dot", "title": "Question save(Question question);"}, {"color": "#22c55e", "id": "QuestionRepository.findById", "label": "QuestionRepository.findById()", "shape": "dot", "title": "Optional\u003cQuestion\u003e findById(String id);"}, {"color": "#22c55e", "id": "QuestionRepository.findByQuizId", "label": "QuestionRepository.findByQuizId()", "shape": "dot", "title": "List\u003cQuestion\u003e findByQuizId(String quizId);"}, {"color": "#22c55e", "id": "QuestionRepository.saveAll", "label": "QuestionRepository.saveAll()", "shape": "dot", "title": "void saveAll(List\u003cQuestion\u003e questions);"}, {"color": "#22c55e", "id": "QuestionRepository.deleteAll", "label": "QuestionRepository.deleteAll()", "shape": "dot", "title": "void deleteAll(List\u003cQuestion\u003e questions);"}, {"color": "#22c55e", "id": "QuestionRepository.countByQuizId", "label": "QuestionRepository.countByQuizId()", "shape": "dot", "title": "Integer countByQuizId(String quizId);"}, {"color": "#3b82f6", "id": "QuizAnswerRepository", "label": "Class: QuizAnswerRepository", "shape": "dot", "title": "public interface QuizAnswerRepository {\n\n    QuizAnswer save(QuizAnswer answer);\n\n    void saveAll(List\u003cQuizAnswer\u003e answers);\n\n    Optional\u003cQuizAnswer\u003e findById(String id);\n\n    List\u003cQuizAnswer\u003e findByQuizAttemptId(String attemptId);\n\n    void delete(QuizAnswer oldAnswer);\n}"}, {"color": "#22c55e", "id": "QuizAnswerRepository.save", "label": "QuizAnswerRepository.save()", "shape": "dot", "title": "QuizAnswer save(QuizAnswer answer);"}, {"color": "#22c55e", "id": "QuizAnswerRepository.saveAll", "label": "QuizAnswerRepository.saveAll()", "shape": "dot", "title": "void saveAll(List\u003cQuizAnswer\u003e answers);"}, {"color": "#22c55e", "id": "QuizAnswerRepository.findById", "label": "QuizAnswerRepository.findById()", "shape": "dot", "title": "Optional\u003cQuizAnswer\u003e findById(String id);"}, {"color": "#22c55e", "id": "QuizAnswerRepository.findByQuizAttemptId", "label": "QuizAnswerRepository.findByQuizAttemptId()", "shape": "dot", "title": "List\u003cQuizAnswer\u003e findByQuizAttemptId(String attemptId);"}, {"color": "#22c55e", "id": "QuizAnswerRepository.delete", "label": "QuizAnswerRepository.delete()", "shape": "dot", "title": "void delete(QuizAnswer oldAnswer);"}, {"color": "#3b82f6", "id": "QuizAttemptRepository", "label": "Class: QuizAttemptRepository", "shape": "dot", "title": "public interface QuizAttemptRepository {\n\n    QuizAttempt save(QuizAttempt attempt);\n\n    Optional\u003cQuizAttempt\u003e findById(String id);\n\n    List\u003cQuizAttempt\u003e findAll();\n\n    List\u003cQuizAttempt\u003e findByUserId(UUID id);\n\n    List\u003cQuizAttempt\u003e findByQuizId(String id);\n}"}, {"color": "#22c55e", "id": "QuizAttemptRepository.save", "label": "QuizAttemptRepository.save()", "shape": "dot", "title": "QuizAttempt save(QuizAttempt attempt);"}, {"color": "#22c55e", "id": "QuizAttemptRepository.findById", "label": "QuizAttemptRepository.findById()", "shape": "dot", "title": "Optional\u003cQuizAttempt\u003e findById(String id);"}, {"color": "#22c55e", "id": "QuizAttemptRepository.findAll", "label": "QuizAttemptRepository.findAll()", "shape": "dot", "title": "List\u003cQuizAttempt\u003e findAll();"}, {"color": "#22c55e", "id": "QuizAttemptRepository.findByUserId", "label": "QuizAttemptRepository.findByUserId()", "shape": "dot", "title": "List\u003cQuizAttempt\u003e findByUserId(UUID id);"}, {"color": "#22c55e", "id": "QuizAttemptRepository.findByQuizId", "label": "QuizAttemptRepository.findByQuizId()", "shape": "dot", "title": "List\u003cQuizAttempt\u003e findByQuizId(String id);"}, {"color": "#3b82f6", "id": "QuizRepository", "label": "Class: QuizRepository", "shape": "dot", "title": "public interface QuizRepository {\n\n    void save(Quiz quiz);\n\n    Optional\u003cQuiz\u003e findById(String id);\n\n    List\u003cQuiz\u003e findAll();\n\n    List\u003cQuiz\u003e findByUserId(UUID id);\n\n    List\u003cQuiz\u003e findByIdIn(Set\u003cString\u003e quizId);\n\n    List\u003cQuiz\u003e findAllPublic();\n\n}"}, {"color": "#22c55e", "id": "QuizRepository.save", "label": "QuizRepository.save()", "shape": "dot", "title": "void save(Quiz quiz);"}, {"color": "#22c55e", "id": "QuizRepository.findById", "label": "QuizRepository.findById()", "shape": "dot", "title": "Optional\u003cQuiz\u003e findById(String id);"}, {"color": "#22c55e", "id": "QuizRepository.findAll", "label": "QuizRepository.findAll()", "shape": "dot", "title": "List\u003cQuiz\u003e findAll();"}, {"color": "#22c55e", "id": "QuizRepository.findByUserId", "label": "QuizRepository.findByUserId()", "shape": "dot", "title": "List\u003cQuiz\u003e findByUserId(UUID id);"}, {"color": "#22c55e", "id": "QuizRepository.findByIdIn", "label": "QuizRepository.findByIdIn()", "shape": "dot", "title": "List\u003cQuiz\u003e findByIdIn(Set\u003cString\u003e quizId);"}, {"color": "#22c55e", "id": "QuizRepository.findAllPublic", "label": "QuizRepository.findAllPublic()", "shape": "dot", "title": "List\u003cQuiz\u003e findAllPublic();"}, {"color": "#3b82f6", "id": "ResourceRepository", "label": "Class: ResourceRepository", "shape": "dot", "title": "public interface ResourceRepository {\n\n    Resource save(Resource resource);\n\n    Resource findById(String id);\n\n}"}, {"color": "#22c55e", "id": "ResourceRepository.save", "label": "ResourceRepository.save()", "shape": "dot", "title": "Resource save(Resource resource);"}, {"color": "#22c55e", "id": "ResourceRepository.findById", "label": "ResourceRepository.findById()", "shape": "dot", "title": "Resource findById(String id);"}, {"color": "#3b82f6", "id": "SavedQuizRepository", "label": "Class: SavedQuizRepository", "shape": "dot", "title": "public interface SavedQuizRepository {\n\n    void saveQuiz(String quizId, String userId);\n\n    List\u003cUserSavedQuiz\u003e findAllByUserId(String userId);\n\n    void deleteByQuizIdAndUserId(String quizId, String userId);\n\n    boolean existsByQuizIdAndUserId(String quizId, String userId);\n\n    List\u003cUserSavedQuiz\u003e findAllByQuizId(String quizId);\n\n    void update(UserSavedQuiz savedQuiz);\n}"}, {"color": "#22c55e", "id": "SavedQuizRepository.saveQuiz", "label": "SavedQuizRepository.saveQuiz()", "shape": "dot", "title": "void saveQuiz(String quizId, String userId);"}, {"color": "#22c55e", "id": "SavedQuizRepository.findAllByUserId", "label": "SavedQuizRepository.findAllByUserId()", "shape": "dot", "title": "List\u003cUserSavedQuiz\u003e findAllByUserId(String userId);"}, {"color": "#22c55e", "id": "SavedQuizRepository.deleteByQuizIdAndUserId", "label": "SavedQuizRepository.deleteByQuizIdAndUserId()", "shape": "dot", "title": "void deleteByQuizIdAndUserId(String quizId, String userId);"}, {"color": "#22c55e", "id": "SavedQuizRepository.existsByQuizIdAndUserId", "label": "SavedQuizRepository.existsByQuizIdAndUserId()", "shape": "dot", "title": "boolean existsByQuizIdAndUserId(String quizId, String userId);"}, {"color": "#22c55e", "id": "SavedQuizRepository.findAllByQuizId", "label": "SavedQuizRepository.findAllByQuizId()", "shape": "dot", "title": "List\u003cUserSavedQuiz\u003e findAllByQuizId(String quizId);"}, {"color": "#22c55e", "id": "SavedQuizRepository.update", "label": "SavedQuizRepository.update()", "shape": "dot", "title": "void update(UserSavedQuiz savedQuiz);"}, {"color": "#3b82f6", "id": "UserRepository", "label": "Class: UserRepository", "shape": "dot", "title": "public interface UserRepository {\n\n    Optional\u003cUser\u003e getUserById(String userId);\n\n    Optional\u003cUser\u003e getByUsername(String username);\n\n    Optional\u003cUser\u003e getByUsernameForAuth(String username);\n\n    User persist(User user);\n\n    List\u003cUser\u003e getByUserIdList(List\u003cUUID\u003e studentIds);\n\n    List\u003cBasicUserDto\u003e basicSearch(String keyword);\n\n    Optional\u003cUser\u003e getByEmail(String username);\n}"}, {"color": "#22c55e", "id": "UserRepository.getUserById", "label": "UserRepository.getUserById()", "shape": "dot", "title": "Optional\u003cUser\u003e getUserById(String userId);"}, {"color": "#22c55e", "id": "UserRepository.getByUsername", "label": "UserRepository.getByUsername()", "shape": "dot", "title": "Optional\u003cUser\u003e getByUsername(String username);"}, {"color": "#22c55e", "id": "UserRepository.getByUsernameForAuth", "label": "UserRepository.getByUsernameForAuth()", "shape": "dot", "title": "Optional\u003cUser\u003e getByUsernameForAuth(String username);"}, {"color": "#22c55e", "id": "UserRepository.persist", "label": "UserRepository.persist()", "shape": "dot", "title": "User persist(User user);"}, {"color": "#22c55e", "id": "UserRepository.getByUserIdList", "label": "UserRepository.getByUserIdList()", "shape": "dot", "title": "List\u003cUser\u003e getByUserIdList(List\u003cUUID\u003e studentIds);"}, {"color": "#22c55e", "id": "UserRepository.basicSearch", "label": "UserRepository.basicSearch()", "shape": "dot", "title": "List\u003cBasicUserDto\u003e basicSearch(String keyword);"}, {"color": "#22c55e", "id": "UserRepository.getByEmail", "label": "UserRepository.getByEmail()", "shape": "dot", "title": "Optional\u003cUser\u003e getByEmail(String username);"}, {"color": "#3b82f6", "id": "AuthConfig", "label": "Class: AuthConfig", "shape": "dot", "title": "@Configuration\n@EnableWebSecurity\n@EnableMethodSecurity(prePostEnabled = true)\n@RequiredArgsConstructor\npublic class AuthConfig {\n\n    private final AuthenticationProvider authProvider;\n\n    private final JwtFilter jwtFilter;\n\n    private final JwtAuthenticationEntryPoint unAuthorizedHandler;\n\n    @Bean\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n        http\n                .cors(Customizer.withDefaults())\n                .csrf(AbstractHttpConfigurer::disable)\n                .authorizeHttpRequests(auth -\u003e auth\n                        .requestMatchers(\"/api/v1/pub/**\").permitAll()\n                        .anyRequest().authenticated()\n                )\n                .sessionManagement(session -\u003e session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))\n                .authenticationProvider(authProvider)\n                .addFilterBefore(jwtFilter, UsernamePasswordAuthenticationFilter.class)\n                .exceptionHandling(e -\u003e e.authenticationEntryPoint(unAuthorizedHandler))\n                .securityContext(ctx -\u003e ctx.requireExplicitSave(false));\n\n        return http.build();\n    }\n\n}"}, {"color": "#22c55e", "id": "AuthConfig.securityFilterChain", "label": "AuthConfig.securityFilterChain()", "shape": "dot", "title": "@Bean\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n        http\n                .cors(Customizer.withDefaults())\n                .csrf(AbstractHttpConfigurer::disable)\n                .authorizeHttpRequests(auth -\u003e auth\n                        .requestMatchers(\"/api/v1/pub/**\").permitAll()\n                        .anyRequest().authenticated()\n                )\n                .sessionManagement(session -\u003e session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))\n                .authenticationProvider(authProvider)\n                .addFilterBefore(jwtFilter, UsernamePasswordAuthenticationFilter.class)\n                .exceptionHandling(e -\u003e e.authenticationEntryPoint(unAuthorizedHandler))\n                .securityContext(ctx -\u003e ctx.requireExplicitSave(false));\n\n        return http.build();\n    }"}, {"color": "#3b82f6", "id": "BeanConfig", "label": "Class: BeanConfig", "shape": "dot", "title": "@Configuration\npublic class BeanConfig {\n\n    private final UserRepository userRepository;\n\n    public BeanConfig(UserRepository userRepository) {\n        this.userRepository = userRepository;\n    }\n\n    @Bean\n    public UserDetailsService userDetailsService() {\n        return new AppUserDetailsService(userRepository);\n    }\n\n    @Bean\n    public AuthenticationProvider authenticationProvider() {\n        DaoAuthenticationProvider daoAuthProvider = new DaoAuthenticationProvider();\n        daoAuthProvider.setUserDetailsService(userDetailsService());\n        daoAuthProvider.setPasswordEncoder(passwordEncoder());\n\n        return daoAuthProvider;\n    }\n    @Bean\n    public AuthenticationManager authenticationManager(AuthenticationConfiguration config) throws Exception {\n        return config.getAuthenticationManager();\n    }\n\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder();\n    }\n}"}, {"color": "#22c55e", "id": "BeanConfig.userDetailsService", "label": "BeanConfig.userDetailsService()", "shape": "dot", "title": "@Bean\n    public UserDetailsService userDetailsService() {\n        return new AppUserDetailsService(userRepository);\n    }"}, {"color": "#22c55e", "id": "BeanConfig.authenticationProvider", "label": "BeanConfig.authenticationProvider()", "shape": "dot", "title": "@Bean\n    public AuthenticationProvider authenticationProvider() {\n        DaoAuthenticationProvider daoAuthProvider = new DaoAuthenticationProvider();\n        daoAuthProvider.setUserDetailsService(userDetailsService());\n        daoAuthProvider.setPasswordEncoder(passwordEncoder());\n\n        return daoAuthProvider;\n    }"}, {"color": "#22c55e", "id": "BeanConfig.authenticationManager", "label": "BeanConfig.authenticationManager()", "shape": "dot", "title": "@Bean\n    public AuthenticationManager authenticationManager(AuthenticationConfiguration config) throws Exception {\n        return config.getAuthenticationManager();\n    }"}, {"color": "#22c55e", "id": "BeanConfig.passwordEncoder", "label": "BeanConfig.passwordEncoder()", "shape": "dot", "title": "@Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder();\n    }"}, {"color": "#3b82f6", "id": "JwtAuthenticationEntryPoint", "label": "Class: JwtAuthenticationEntryPoint", "shape": "dot", "title": "@Component\n@Slf4j\npublic class JwtAuthenticationEntryPoint implements AuthenticationEntryPoint {\n\n    @Override\n    public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) throws IOException, ServletException {\n        log.error(\"Unauthorized error: {}\", authException.getMessage());\n\n        response.setContentType(MediaType.APPLICATION_JSON_VALUE);\n        response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);\n\n        final Map\u003cString, Object\u003e body = new HashMap\u003c\u003e();\n        body.put(\"status\", HttpServletResponse.SC_UNAUTHORIZED);\n        body.put(\"error\", \"Unauthorized\");\n        body.put(\"message\", authException.getMessage());\n        body.put(\"path\", request.getServletPath());\n\n        final ObjectMapper mapper = new ObjectMapper();\n        mapper.writeValue(response.getOutputStream(), body);\n    }\n}"}, {"color": "#22c55e", "id": "JwtAuthenticationEntryPoint.commence", "label": "JwtAuthenticationEntryPoint.commence()", "shape": "dot", "title": "@Override\n    public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) throws IOException, ServletException {\n        log.error(\"Unauthorized error: {}\", authException.getMessage());\n\n        response.setContentType(MediaType.APPLICATION_JSON_VALUE);\n        response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);\n\n        final Map\u003cString, Object\u003e body = new HashMap\u003c\u003e();\n        body.put(\"status\", HttpServletResponse.SC_UNAUTHORIZED);\n        body.put(\"error\", \"Unauthorized\");\n        body.put(\"message\", authException.getMessage());\n        body.put(\"path\", request.getServletPath());\n\n        final ObjectMapper mapper = new ObjectMapper();\n        mapper.writeValue(response.getOutputStream(), body);\n    }"}, {"color": "#3b82f6", "id": "JwtFilter", "label": "Class: JwtFilter", "shape": "dot", "title": "@Component\n@Slf4j\npublic class JwtFilter extends OncePerRequestFilter {\n\n    private final JwtProvider jwtProvider;\n    private final UserDetailsService userDetailsService;\n\n    private static final String[] PUBLIC_URLS = {\n            \"/api/v1/pub/.*\",\n    };\n\n    public JwtFilter(JwtProvider jwtProvider, UserDetailsService userDetailsService) {\n        this.jwtProvider = jwtProvider;\n        this.userDetailsService = userDetailsService;\n    }\n\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {\n        final String requestURI = request.getRequestURI();\n\n        boolean isPublicUrl = Arrays.stream(PUBLIC_URLS)\n                .anyMatch(requestURI::matches);\n\n        if (isPublicUrl) {\n            filterChain.doFilter(request, response);\n            return;\n        }\n\n        final String authorizationHeader = request.getHeader(\"Authorization\");\n        String jwt = null;\n        String username = null;\n\n        if (authorizationHeader != null \u0026\u0026 authorizationHeader.startsWith(\"Bearer \")) {\n            jwt = authorizationHeader.substring(7);\n            try {\n                username = jwtProvider.extractUsername(jwt);\n            } catch (ExpiredJwtException ex) {\n                log.warn(\"JWT token is expired: {}\", ex.getMessage());\n            } catch (MalformedJwtException ex) {\n                log.warn(\"JWT token is malformed: {}\", ex.getMessage());\n            } catch (SignatureException ex) {\n                log.warn(\"JWT signature is invalid: {}\", ex.getMessage());\n            } catch (IllegalArgumentException ex) {\n                log.warn(\"Unable to get JWT Token or JWT claims string is empty: {}\", ex.getMessage());\n            } catch (Exception ex) {\n                log.error(\"An unexpected error occurred during JWT token processing: {}\", ex.getMessage(), ex);\n            }\n        }\n\n        if (username != null \u0026\u0026 SecurityContextHolder.getContext().getAuthentication() == null) {\n            try {\n                UserPrincipal userDetails = (UserPrincipal) this.userDetailsService.loadUserByUsername(username);\n\n                if (jwtProvider.isTokenValid(jwt, userDetails)) {\n                    UsernamePasswordAuthenticationToken authToken = new UsernamePasswordAuthenticationToken(\n                            userDetails,\n                            null,\n                            userDetails.getAuthorities()\n                    );\n\n                    authToken.setDetails(\n                            new WebAuthenticationDetailsSource().buildDetails(request)\n                    );\n\n                    SecurityContextHolder.getContext().setAuthentication(authToken);\n                } else {\n                    log.warn(\"Invalid JWT token for user: {}\", username);\n                }\n            } catch (Exception ex) {\n                log.error(\"Error authenticating user with JWT: {}\", ex.getMessage(), ex);\n            }\n        }\n\n        filterChain.doFilter(request, response);\n    }\n}"}, {"color": "#22c55e", "id": "JwtFilter.doFilterInternal", "label": "JwtFilter.doFilterInternal()", "shape": "dot", "title": "@Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {\n        final String requestURI = request.getRequestURI();\n\n        boolean isPublicUrl = Arrays.stream(PUBLIC_URLS)\n                .anyMatch(requestURI::matches);\n\n        if (isPublicUrl) {\n            filterChain.doFilter(request, response);\n            return;\n        }\n\n        final String authorizationHeader = request.getHeader(\"Authorization\");\n        String jwt = null;\n        String username = null;\n\n        if (authorizationHeader != null \u0026\u0026 authorizationHeader.startsWith(\"Bearer \")) {\n            jwt = authorizationHeader.substring(7);\n            try {\n                username = jwtProvider.extractUsername(jwt);\n            } catch (ExpiredJwtException ex) {\n                log.warn(\"JWT token is expired: {}\", ex.getMessage());\n            } catch (MalformedJwtException ex) {\n                log.warn(\"JWT token is malformed: {}\", ex.getMessage());\n            } catch (SignatureException ex) {\n                log.warn(\"JWT signature is invalid: {}\", ex.getMessage());\n            } catch (IllegalArgumentException ex) {\n                log.warn(\"Unable to get JWT Token or JWT claims string is empty: {}\", ex.getMessage());\n            } catch (Exception ex) {\n                log.error(\"An unexpected error occurred during JWT token processing: {}\", ex.getMessage(), ex);\n            }\n        }\n\n        if (username != null \u0026\u0026 SecurityContextHolder.getContext().getAuthentication() == null) {\n            try {\n                UserPrincipal userDetails = (UserPrincipal) this.userDetailsService.loadUserByUsername(username);\n\n                if (jwtProvider.isTokenValid(jwt, userDetails)) {\n                    UsernamePasswordAuthenticationToken authToken = new UsernamePasswordAuthenticationToken(\n                            userDetails,\n                            null,\n                            userDetails.getAuthorities()\n                    );\n\n                    authToken.setDetails(\n                            new WebAuthenticationDetailsSource().buildDetails(request)\n                    );\n\n                    SecurityContextHolder.getContext().setAuthentication(authToken);\n                } else {\n                    log.warn(\"Invalid JWT token for user: {}\", username);\n                }\n            } catch (Exception ex) {\n                log.error(\"Error authenticating user with JWT: {}\", ex.getMessage(), ex);\n            }\n        }\n\n        filterChain.doFilter(request, response);\n    }"}, {"color": "#3b82f6", "id": "JwtProvider", "label": "Class: JwtProvider", "shape": "dot", "title": "@Component\n@Slf4j\npublic class JwtProvider {\n    @Value(\"${security.jwt.secret}\")\n    private String secretKey;\n\n    @Value(\"${security.jwt.access-token-expiration}\")\n    private long accessTokenExpired;\n\n    @Value(\"${security.jwt.refresh-token-expiration}\")\n    private long refreshTokenExpired;\n\n    public String extractUsername(String token) {\n        Claims claims = extractAllClaims(token);\n        return claims.getSubject();\n    }\n\n    private \u003cT\u003e T extractClaims(String token, Function\u003cClaims, T\u003e claimsResolver) {\n        final Claims claims = extractAllClaims(token);\n        return claimsResolver.apply(claims);\n    }\n\n    private Claims extractAllClaims(String token) {\n        return Jwts.\n                parserBuilder().\n                setSigningKey(getSignInKey()).\n                build().\n                parseClaimsJws(token).\n                getBody();\n    }\n\n    private Key getSignInKey() {\n        byte[] keyBytes = Decoders.BASE64.decode(secretKey);\n        return Keys.hmacShaKeyFor(keyBytes);\n    }\n\n    public String generateAccessToken(Authentication authentication) {\n        UserPrincipal userDetails = (UserPrincipal) authentication.getPrincipal();\n        return generateToken(new HashMap\u003c\u003e(), userDetails, accessTokenExpired);\n    }\n\n    public String generateRefreshToken(Authentication authentication) {\n        UserPrincipal userDetails = (UserPrincipal) authentication.getPrincipal();\n        return generateToken(new HashMap\u003c\u003e(), userDetails, refreshTokenExpired);\n    }\n\n    public String generateToken(\n            Map\u003cString, Object\u003e extractClaims,\n            UserPrincipal userDetails,\n            long maxAge\n    ) {\n\n        return Jwts.builder()\n                .setClaims(extractClaims)\n                .setSubject(userDetails.getUsername())\n                .claim(\"id\", userDetails.getId())\n                .claim(\"username\", userDetails.getUsername())\n                .claim(\"email\", userDetails.getEmail())\n                .claim(\"roles\", userDetails.getRoles())\n                .claim(\"authorities\", userDetails.getAuthorities())\n                .claim(\"scope\", buildScope(userDetails))\n                .setIssuedAt(new Date(System.currentTimeMillis()))\n                .setExpiration(new Date(System.currentTimeMillis() + maxAge))\n                .signWith(getSignInKey(), SignatureAlgorithm.HS256)\n                .compact();\n    }\n\n    private String buildScope(UserPrincipal user) {\n        StringJoiner stringJoiner = new StringJoiner(\" \");\n\n        if (!CollectionUtils.isEmpty(user.getRoles()))\n            user.getRoles().forEach(role -\u003e {\n                stringJoiner.add(\"ROLE_\" + role);\n            });\n\n        return stringJoiner.toString();\n    }\n\n    public boolean isTokenExpired(String token) {\n        return extractExpiration(token).before(new Date());\n    }\n\n    private Date extractExpiration(String token) {\n        return extractClaims(token, Claims::getExpiration);\n    }\n\n    public boolean isTokenValid(String token, UserPrincipal userDetails) {\n        final String username = extractUsername(token);\n        return (username.equals(userDetails.getUsername()) \u0026\u0026 !isTokenExpired(token));\n    }\n}"}, {"color": "#22c55e", "id": "JwtProvider.extractUsername", "label": "JwtProvider.extractUsername()", "shape": "dot", "title": "public String extractUsername(String token) {\n        Claims claims = extractAllClaims(token);\n        return claims.getSubject();\n    }"}, {"color": "#22c55e", "id": "JwtProvider.extractClaims", "label": "JwtProvider.extractClaims()", "shape": "dot", "title": "private \u003cT\u003e T extractClaims(String token, Function\u003cClaims, T\u003e claimsResolver) {\n        final Claims claims = extractAllClaims(token);\n        return claimsResolver.apply(claims);\n    }"}, {"color": "#22c55e", "id": "JwtProvider.extractAllClaims", "label": "JwtProvider.extractAllClaims()", "shape": "dot", "title": "private Claims extractAllClaims(String token) {\n        return Jwts.\n                parserBuilder().\n                setSigningKey(getSignInKey()).\n                build().\n                parseClaimsJws(token).\n                getBody();\n    }"}, {"color": "#22c55e", "id": "JwtProvider.getSignInKey", "label": "JwtProvider.getSignInKey()", "shape": "dot", "title": "private Key getSignInKey() {\n        byte[] keyBytes = Decoders.BASE64.decode(secretKey);\n        return Keys.hmacShaKeyFor(keyBytes);\n    }"}, {"color": "#22c55e", "id": "JwtProvider.generateAccessToken", "label": "JwtProvider.generateAccessToken()", "shape": "dot", "title": "public String generateAccessToken(Authentication authentication) {\n        UserPrincipal userDetails = (UserPrincipal) authentication.getPrincipal();\n        return generateToken(new HashMap\u003c\u003e(), userDetails, accessTokenExpired);\n    }"}, {"color": "#22c55e", "id": "JwtProvider.generateRefreshToken", "label": "JwtProvider.generateRefreshToken()", "shape": "dot", "title": "public String generateRefreshToken(Authentication authentication) {\n        UserPrincipal userDetails = (UserPrincipal) authentication.getPrincipal();\n        return generateToken(new HashMap\u003c\u003e(), userDetails, refreshTokenExpired);\n    }"}, {"color": "#22c55e", "id": "JwtProvider.generateToken", "label": "JwtProvider.generateToken()", "shape": "dot", "title": "public String generateToken(\n            Map\u003cString, Object\u003e extractClaims,\n            UserPrincipal userDetails,\n            long maxAge\n    ) {\n\n        return Jwts.builder()\n                .setClaims(extractClaims)\n                .setSubject(userDetails.getUsername())\n                .claim(\"id\", userDetails.getId())\n                .claim(\"username\", userDetails.getUsername())\n                .claim(\"email\", userDetails.getEmail())\n                .claim(\"roles\", userDetails.getRoles())\n                .claim(\"authorities\", userDetails.getAuthorities())\n                .claim(\"scope\", buildScope(userDetails))\n                .setIssuedAt(new Date(System.currentTimeMillis()))\n                .setExpiration(new Date(System.currentTimeMillis() + maxAge))\n                .signWith(getSignInKey(), SignatureAlgorithm.HS256)\n                .compact();\n    }"}, {"color": "#22c55e", "id": "JwtProvider.buildScope", "label": "JwtProvider.buildScope()", "shape": "dot", "title": "private String buildScope(UserPrincipal user) {\n        StringJoiner stringJoiner = new StringJoiner(\" \");\n\n        if (!CollectionUtils.isEmpty(user.getRoles()))\n            user.getRoles().forEach(role -\u003e {\n                stringJoiner.add(\"ROLE_\" + role);\n            });\n\n        return stringJoiner.toString();\n    }"}, {"color": "#22c55e", "id": "JwtProvider.isTokenExpired", "label": "JwtProvider.isTokenExpired()", "shape": "dot", "title": "public boolean isTokenExpired(String token) {\n        return extractExpiration(token).before(new Date());\n    }"}, {"color": "#22c55e", "id": "JwtProvider.extractExpiration", "label": "JwtProvider.extractExpiration()", "shape": "dot", "title": "private Date extractExpiration(String token) {\n        return extractClaims(token, Claims::getExpiration);\n    }"}, {"color": "#22c55e", "id": "JwtProvider.isTokenValid", "label": "JwtProvider.isTokenValid()", "shape": "dot", "title": "public boolean isTokenValid(String token, UserPrincipal userDetails) {\n        final String username = extractUsername(token);\n        return (username.equals(userDetails.getUsername()) \u0026\u0026 !isTokenExpired(token));\n    }"}, {"color": "#3b82f6", "id": "UserPrincipal", "label": "Class: UserPrincipal", "shape": "dot", "title": "@Getter\n@Builder\n@Slf4j\n@ToString\npublic class UserPrincipal implements UserDetails {\n    private UUID id;\n    private String username;\n    private String email;\n    private String password;\n    private List\u003cString\u003e roles;\n\n    @Override\n    public Collection\u003c? extends GrantedAuthority\u003e getAuthorities(){\n        return roles.stream()\n                .map(SimpleGrantedAuthority::new)\n                .toList();\n    }\n    public UserPrincipal(UUID id, String username, String email, String password, List\u003cString\u003e roles) {\n        this.id = id;\n        this.username = username;\n        this.email = email;\n        this.password = password;\n        this.roles = roles;\n    }\n\n    public static UserPrincipal from(User user) {\n        return UserPrincipal.builder()\n                .id(UUID.fromString(user.getId().toString()))\n                .username(user.getUsername())\n                .email(user.getEmail())\n                .password(user.getCredentials().getPasswordHash())\n                .roles(List.of(user.getRole().toString()))\n                .build();\n    }\n\n    @Override\n    public String getPassword() {\n        return password;\n    }\n\n    @Override\n    public String getUsername() {\n        return username;\n    }\n\n    @Override\n    public boolean isAccountNonExpired() {\n        return true;\n    }\n\n    @Override\n    public boolean isAccountNonLocked() {\n        return true;\n    }\n\n    @Override\n    public boolean isCredentialsNonExpired() {\n        return true;\n    }\n\n    @Override\n    public boolean isEnabled() {\n        return true;\n    }\n}"}, {"color": "#22c55e", "id": "UserPrincipal.getAuthorities", "label": "UserPrincipal.getAuthorities()", "shape": "dot", "title": "@Override\n    public Collection\u003c? extends GrantedAuthority\u003e getAuthorities(){\n        return roles.stream()\n                .map(SimpleGrantedAuthority::new)\n                .toList();\n    }"}, {"color": "#22c55e", "id": "UserPrincipal.from", "label": "UserPrincipal.from()", "shape": "dot", "title": "public static UserPrincipal from(User user) {\n        return UserPrincipal.builder()\n                .id(UUID.fromString(user.getId().toString()))\n                .username(user.getUsername())\n                .email(user.getEmail())\n                .password(user.getCredentials().getPasswordHash())\n                .roles(List.of(user.getRole().toString()))\n                .build();\n    }"}, {"color": "#22c55e", "id": "UserPrincipal.getPassword", "label": "UserPrincipal.getPassword()", "shape": "dot", "title": "@Override\n    public String getPassword() {\n        return password;\n    }"}, {"color": "#22c55e", "id": "UserPrincipal.getUsername", "label": "UserPrincipal.getUsername()", "shape": "dot", "title": "@Override\n    public String getUsername() {\n        return username;\n    }"}, {"color": "#22c55e", "id": "UserPrincipal.isAccountNonExpired", "label": "UserPrincipal.isAccountNonExpired()", "shape": "dot", "title": "@Override\n    public boolean isAccountNonExpired() {\n        return true;\n    }"}, {"color": "#22c55e", "id": "UserPrincipal.isAccountNonLocked", "label": "UserPrincipal.isAccountNonLocked()", "shape": "dot", "title": "@Override\n    public boolean isAccountNonLocked() {\n        return true;\n    }"}, {"color": "#22c55e", "id": "UserPrincipal.isCredentialsNonExpired", "label": "UserPrincipal.isCredentialsNonExpired()", "shape": "dot", "title": "@Override\n    public boolean isCredentialsNonExpired() {\n        return true;\n    }"}, {"color": "#22c55e", "id": "UserPrincipal.isEnabled", "label": "UserPrincipal.isEnabled()", "shape": "dot", "title": "@Override\n    public boolean isEnabled() {\n        return true;\n    }"}, {"color": "#3b82f6", "id": "AppUserDetailsService", "label": "Class: AppUserDetailsService", "shape": "dot", "title": "@Service\n@Slf4j\npublic class AppUserDetailsService implements UserDetailsService {\n\n    private final UserRepository userRepository;\n\n    public AppUserDetailsService(UserRepository userRepository) {\n        this.userRepository = userRepository;\n    }\n\n    @Override\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n        User user = userRepository.getByUsernameForAuth(username).orElseThrow(() -\u003e new BusinessException(ErrorConstant.UNAUTHORIZED));\n\n        return UserPrincipal.from(user);\n    }\n}"}, {"color": "#22c55e", "id": "AppUserDetailsService.loadUserByUsername", "label": "AppUserDetailsService.loadUserByUsername()", "shape": "dot", "title": "@Override\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n        User user = userRepository.getByUsernameForAuth(username).orElseThrow(() -\u003e new BusinessException(ErrorConstant.UNAUTHORIZED));\n\n        return UserPrincipal.from(user);\n    }"}, {"color": "#3b82f6", "id": "AuthService", "label": "Class: AuthService", "shape": "dot", "title": "public interface AuthService {\n\n    AuthLoginResponse login(AuthLoginRequest request);\n\n    AuthRegisterResponse register(AuthRegisterRequest request);\n\n    AuthProfileResponse getAuthProfile(String email);\n\n}"}, {"color": "#22c55e", "id": "AuthService.login", "label": "AuthService.login()", "shape": "dot", "title": "AuthLoginResponse login(AuthLoginRequest request);"}, {"color": "#22c55e", "id": "AuthService.register", "label": "AuthService.register()", "shape": "dot", "title": "AuthRegisterResponse register(AuthRegisterRequest request);"}, {"color": "#22c55e", "id": "AuthService.getAuthProfile", "label": "AuthService.getAuthProfile()", "shape": "dot", "title": "AuthProfileResponse getAuthProfile(String email);"}, {"color": "#3b82f6", "id": "BaseService", "label": "Class: BaseService", "shape": "dot", "title": "@Service\n@Slf4j\npublic class BaseService {\n\n    @Autowired\n    protected Environment env;\n\n    @Value(\"${spring.application.name}\")\n    protected String appName;\n\n    @Autowired\n    protected ObjectMapper objectMapper;\n\n    @Autowired\n    protected HttpServletRequest httpServletRequest;\n\n    @Autowired\n    protected HttpServletResponse httpServletResponse;\n\n    public String getMessage(String key) {\n        try {\n            String result = env.getProperty(key);\n            return ObjectUtils.isEmpty(result) ? key : result;\n        } catch (Exception e) {\n            return key;\n        }\n    }\n\n    public String getMessage(int code) {\n        return getMessage(String.valueOf(code));\n    }\n\n    public String getMessage(BusinessError error) {\n        return ObjectUtils.isEmpty(error.getMessage()) ? getMessage(error.getCode()) : error.getMessage();\n    }\n\n    public Object getRequestValue(String key) {\n        return getRequestValue(key, Object.class);\n    }\n\n    public \u003cT\u003e T getRequestValue(String key, Class\u003cT\u003e clazz) {\n        return clazz.cast(httpServletRequest.getAttribute(key));\n    }\n\n    public String getRequestStringValue(String key) {\n        return getRequestValue(key, String.class);\n    }\n\n    public String getRequestId() {\n        return getRequestValue(RequestKeyConstant.REQUEST_ID).toString();\n    }\n\n    public Object getRequestBody() {\n        return getRequestValue(RequestKeyConstant.REQUEST_BODY);\n    }\n\n    public \u003cT\u003e BaseResponse\u003cT\u003e ofSucceeded(T data) {\n        return BaseResponse.ofSucceeded(getRequestId(), data);\n    }\n\n    public \u003cT\u003e BaseResponse\u003cT\u003e ofGetListSucceeded(T data, BasicRequestList requestList) {\n        return BaseResponse.ofGetListSucceeded(data, requestList);\n    }\n\n    public \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(BusinessException exception, T data) {\n        return BaseResponse.ofFailed(getRequestId(), exception, data);\n    }\n\n    public \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(BusinessError error, String message, T data) {\n        return BaseResponse.ofFailed(getRequestId(), error, message, data);\n    }\n\n    public \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(BusinessError error, String message, List\u003cErrorViolation\u003e errors, T data) {\n        return BaseResponse.ofFailed(getRequestId(), error, message, errors, data);\n    }\n\n    public BaseResponse ofFailed(BusinessException exception) {\n        return BaseResponse.ofFailed(getRequestId(), exception);\n    }\n\n    public BaseResponse ofFailed(BusinessError error, String message) {\n        return BaseResponse.ofFailed(getRequestId(), error, message);\n    }\n\n    public BaseResponse ofFailed(BusinessError error) {\n        return BaseResponse.ofFailed(getRequestId(), error, getMessage(error));\n    }\n\n    public BaseResponse ofFailed(BusinessError error, String message, List\u003cErrorViolation\u003e errors) {\n        return BaseResponse.ofFailed(getRequestId(), error, message, errors);\n    }\n\n    public BaseResponse ofFailed(int errorCode) {\n        return BaseResponse.ofFailed(getRequestId(), getBusinessError(errorCode));\n    }\n\n    public \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(int errorCode, T data) {\n        return BaseResponse.ofFailed(getRequestId(), getBusinessError(errorCode), data);\n    }\n\n    public BusinessError getBusinessError(int errorCode) {\n        return BusinessError.builder()\n                .code(errorCode)\n                .message(getMessage(errorCode))\n                .build();\n    }\n\n    public HttpHeaders getHeaders() {\n        HttpHeaders headers = new HttpHeaders();\n        Enumeration\u003cString\u003e headerNames = httpServletRequest.getHeaderNames();\n        while (headerNames.hasMoreElements()) {\n            String headerName = headerNames.nextElement();\n            String headerValue = httpServletRequest.getHeader(headerName);\n            headers.add(headerName, headerValue);\n        }\n        return headers;\n    }\n\n    public int getErrorCode(String errorCode, int errorCodeDefault) {\n        try {\n            return Integer.parseInt(errorCode);\n        } catch (NumberFormatException e) {\n            return errorCodeDefault;\n        }\n    }\n}"}, {"color": "#22c55e", "id": "BaseService.getMessage", "label": "BaseService.getMessage()", "shape": "dot", "title": "public String getMessage(String key) {\n        try {\n            String result = env.getProperty(key);\n            return ObjectUtils.isEmpty(result) ? key : result;\n        } catch (Exception e) {\n            return key;\n        }\n    }"}, {"color": "#22c55e", "id": "BaseService.getRequestValue", "label": "BaseService.getRequestValue()", "shape": "dot", "title": "public Object getRequestValue(String key) {\n        return getRequestValue(key, Object.class);\n    }"}, {"color": "#22c55e", "id": "BaseService.getRequestStringValue", "label": "BaseService.getRequestStringValue()", "shape": "dot", "title": "public String getRequestStringValue(String key) {\n        return getRequestValue(key, String.class);\n    }"}, {"color": "#22c55e", "id": "BaseService.getRequestId", "label": "BaseService.getRequestId()", "shape": "dot", "title": "public String getRequestId() {\n        return getRequestValue(RequestKeyConstant.REQUEST_ID).toString();\n    }"}, {"color": "#22c55e", "id": "BaseService.getRequestBody", "label": "BaseService.getRequestBody()", "shape": "dot", "title": "public Object getRequestBody() {\n        return getRequestValue(RequestKeyConstant.REQUEST_BODY);\n    }"}, {"color": "#22c55e", "id": "BaseService.ofSucceeded", "label": "BaseService.ofSucceeded()", "shape": "dot", "title": "public \u003cT\u003e BaseResponse\u003cT\u003e ofSucceeded(T data) {\n        return BaseResponse.ofSucceeded(getRequestId(), data);\n    }"}, {"color": "#22c55e", "id": "BaseService.ofGetListSucceeded", "label": "BaseService.ofGetListSucceeded()", "shape": "dot", "title": "public \u003cT\u003e BaseResponse\u003cT\u003e ofGetListSucceeded(T data, BasicRequestList requestList) {\n        return BaseResponse.ofGetListSucceeded(data, requestList);\n    }"}, {"color": "#22c55e", "id": "BaseService.ofFailed", "label": "BaseService.ofFailed()", "shape": "dot", "title": "public \u003cT\u003e BaseResponse\u003cT\u003e ofFailed(BusinessException exception, T data) {\n        return BaseResponse.ofFailed(getRequestId(), exception, data);\n    }"}, {"color": "#22c55e", "id": "BaseService.getBusinessError", "label": "BaseService.getBusinessError()", "shape": "dot", "title": "public BusinessError getBusinessError(int errorCode) {\n        return BusinessError.builder()\n                .code(errorCode)\n                .message(getMessage(errorCode))\n                .build();\n    }"}, {"color": "#22c55e", "id": "BaseService.getHeaders", "label": "BaseService.getHeaders()", "shape": "dot", "title": "public HttpHeaders getHeaders() {\n        HttpHeaders headers = new HttpHeaders();\n        Enumeration\u003cString\u003e headerNames = httpServletRequest.getHeaderNames();\n        while (headerNames.hasMoreElements()) {\n            String headerName = headerNames.nextElement();\n            String headerValue = httpServletRequest.getHeader(headerName);\n            headers.add(headerName, headerValue);\n        }\n        return headers;\n    }"}, {"color": "#22c55e", "id": "BaseService.getErrorCode", "label": "BaseService.getErrorCode()", "shape": "dot", "title": "public int getErrorCode(String errorCode, int errorCodeDefault) {\n        try {\n            return Integer.parseInt(errorCode);\n        } catch (NumberFormatException e) {\n            return errorCodeDefault;\n        }\n    }"}, {"color": "#3b82f6", "id": "PronunciationService", "label": "Class: PronunciationService", "shape": "dot", "title": "public interface PronunciationService {\n\n    GetPronunciationSampleResponseDto getSample(GetSampleRequestDto request);\n\n    PronunciationAccuracyResponseDto getAccuracy(PronunciationAccuracyRequestDto request);\n\n}"}, {"color": "#22c55e", "id": "PronunciationService.getSample", "label": "PronunciationService.getSample()", "shape": "dot", "title": "GetPronunciationSampleResponseDto getSample(GetSampleRequestDto request);"}, {"color": "#22c55e", "id": "PronunciationService.getAccuracy", "label": "PronunciationService.getAccuracy()", "shape": "dot", "title": "PronunciationAccuracyResponseDto getAccuracy(PronunciationAccuracyRequestDto request);"}, {"color": "#3b82f6", "id": "QuestionService", "label": "Class: QuestionService", "shape": "dot", "title": "public interface QuestionService {\n\n    BaseCreateUpdateResponse createQuestion(QuestionDto request, UUID authorId);\n\n    BaseCreateUpdateResponse updateQuestion(QuestionDto request);\n\n    List\u003cQuestion\u003e getAllQuestions();\n\n    List\u003cQuestion\u003e getMyQuestions(UUID id);\n\n    Question getById(String id);\n\n    void deleteQuestion(String id);\n}"}, {"color": "#22c55e", "id": "QuestionService.createQuestion", "label": "QuestionService.createQuestion()", "shape": "dot", "title": "BaseCreateUpdateResponse createQuestion(QuestionDto request, UUID authorId);"}, {"color": "#22c55e", "id": "QuestionService.updateQuestion", "label": "QuestionService.updateQuestion()", "shape": "dot", "title": "BaseCreateUpdateResponse updateQuestion(QuestionDto request);"}, {"color": "#22c55e", "id": "QuestionService.getAllQuestions", "label": "QuestionService.getAllQuestions()", "shape": "dot", "title": "List\u003cQuestion\u003e getAllQuestions();"}, {"color": "#22c55e", "id": "QuestionService.getMyQuestions", "label": "QuestionService.getMyQuestions()", "shape": "dot", "title": "List\u003cQuestion\u003e getMyQuestions(UUID id);"}, {"color": "#22c55e", "id": "QuestionService.getById", "label": "QuestionService.getById()", "shape": "dot", "title": "Question getById(String id);"}, {"color": "#22c55e", "id": "QuestionService.deleteQuestion", "label": "QuestionService.deleteQuestion()", "shape": "dot", "title": "void deleteQuestion(String id);"}, {"color": "#3b82f6", "id": "QuizService", "label": "Class: QuizService", "shape": "dot", "title": "public interface QuizService {\n\n    BaseCreateUpdateResponse createQuiz(CreateQuizDto request, UUID authorId);\n\n    BaseCreateUpdateResponse updateQuiz(CreateQuizDto request);\n\n    List\u003cQuiz\u003e getAllPublicQuizzes();\n\n    List\u003cQuiz\u003e getMyQuizzes(UUID id);\n\n    Quiz getById(String id);\n\n    void deleteQuiz(String id);\n\n    BaseCreateUpdateResponse startQuiz(String quizId, UUID userId);\n\n    BaseCreateUpdateResponse submitQuizQuestion(String attemptId, SubmitAnswerRequest request, UUID id);\n\n    List\u003cQuiz\u003e getMyQuizAttempts(String string);\n\n    QuizAttempt getAttempt(String attemptId, UUID userId);\n\n    void submitQuizComplete(String attemptId, UUID id);\n\n    Quiz getQuizStatsById(String id);\n\n    void saveQuiz(String quizId, UUID userId);\n\n    List\u003cQuiz\u003e getSavedQuizzes(UUID userId);\n\n    void unsaveQuiz(String quizId, UUID userId);\n\n    List\u003cUserSavedQuiz\u003e getUserSavedQuiz(String quizId, UUID userId);\n\n    List\u003cQuiz\u003e search(String query);\n\n    List\u003cQuiz\u003e search2(String query);\n}"}, {"color": "#22c55e", "id": "QuizService.createQuiz", "label": "QuizService.createQuiz()", "shape": "dot", "title": "BaseCreateUpdateResponse createQuiz(CreateQuizDto request, UUID authorId);"}, {"color": "#22c55e", "id": "QuizService.updateQuiz", "label": "QuizService.updateQuiz()", "shape": "dot", "title": "BaseCreateUpdateResponse updateQuiz(CreateQuizDto request);"}, {"color": "#22c55e", "id": "QuizService.getAllPublicQuizzes", "label": "QuizService.getAllPublicQuizzes()", "shape": "dot", "title": "List\u003cQuiz\u003e getAllPublicQuizzes();"}, {"color": "#22c55e", "id": "QuizService.getMyQuizzes", "label": "QuizService.getMyQuizzes()", "shape": "dot", "title": "List\u003cQuiz\u003e getMyQuizzes(UUID id);"}, {"color": "#22c55e", "id": "QuizService.getById", "label": "QuizService.getById()", "shape": "dot", "title": "Quiz getById(String id);"}, {"color": "#22c55e", "id": "QuizService.deleteQuiz", "label": "QuizService.deleteQuiz()", "shape": "dot", "title": "void deleteQuiz(String id);"}, {"color": "#22c55e", "id": "QuizService.startQuiz", "label": "QuizService.startQuiz()", "shape": "dot", "title": "BaseCreateUpdateResponse startQuiz(String quizId, UUID userId);"}, {"color": "#22c55e", "id": "QuizService.submitQuizQuestion", "label": "QuizService.submitQuizQuestion()", "shape": "dot", "title": "BaseCreateUpdateResponse submitQuizQuestion(String attemptId, SubmitAnswerRequest request, UUID id);"}, {"color": "#22c55e", "id": "QuizService.getMyQuizAttempts", "label": "QuizService.getMyQuizAttempts()", "shape": "dot", "title": "List\u003cQuiz\u003e getMyQuizAttempts(String string);"}, {"color": "#22c55e", "id": "QuizService.getAttempt", "label": "QuizService.getAttempt()", "shape": "dot", "title": "QuizAttempt getAttempt(String attemptId, UUID userId);"}, {"color": "#22c55e", "id": "QuizService.submitQuizComplete", "label": "QuizService.submitQuizComplete()", "shape": "dot", "title": "void submitQuizComplete(String attemptId, UUID id);"}, {"color": "#22c55e", "id": "QuizService.getQuizStatsById", "label": "QuizService.getQuizStatsById()", "shape": "dot", "title": "Quiz getQuizStatsById(String id);"}, {"color": "#22c55e", "id": "QuizService.saveQuiz", "label": "QuizService.saveQuiz()", "shape": "dot", "title": "void saveQuiz(String quizId, UUID userId);"}, {"color": "#22c55e", "id": "QuizService.getSavedQuizzes", "label": "QuizService.getSavedQuizzes()", "shape": "dot", "title": "List\u003cQuiz\u003e getSavedQuizzes(UUID userId);"}, {"color": "#22c55e", "id": "QuizService.unsaveQuiz", "label": "QuizService.unsaveQuiz()", "shape": "dot", "title": "void unsaveQuiz(String quizId, UUID userId);"}, {"color": "#22c55e", "id": "QuizService.getUserSavedQuiz", "label": "QuizService.getUserSavedQuiz()", "shape": "dot", "title": "List\u003cUserSavedQuiz\u003e getUserSavedQuiz(String quizId, UUID userId);"}, {"color": "#22c55e", "id": "QuizService.search", "label": "QuizService.search()", "shape": "dot", "title": "List\u003cQuiz\u003e search(String query);"}, {"color": "#22c55e", "id": "QuizService.search2", "label": "QuizService.search2()", "shape": "dot", "title": "List\u003cQuiz\u003e search2(String query);"}, {"color": "#3b82f6", "id": "ResourceService", "label": "Class: ResourceService", "shape": "dot", "title": "public interface ResourceService {\n\n    Resource uploadResource(MultipartFile file, UUID requesterId);\n\n    GetResourceResponse getResource(String id, UUID requesterId);\n\n    File downloadResourceFromUrl(String url);\n\n}"}, {"color": "#22c55e", "id": "ResourceService.uploadResource", "label": "ResourceService.uploadResource()", "shape": "dot", "title": "Resource uploadResource(MultipartFile file, UUID requesterId);"}, {"color": "#22c55e", "id": "ResourceService.getResource", "label": "ResourceService.getResource()", "shape": "dot", "title": "GetResourceResponse getResource(String id, UUID requesterId);"}, {"color": "#22c55e", "id": "ResourceService.downloadResourceFromUrl", "label": "ResourceService.downloadResourceFromUrl()", "shape": "dot", "title": "File downloadResourceFromUrl(String url);"}, {"color": "#3b82f6", "id": "FileUtils", "label": "Class: FileUtils", "shape": "dot", "title": "@Slf4j\npublic class FileUtils {\n\n    public static String convertToBase64(File file) {\n        try {\n            byte[] fileContent = Files.readAllBytes(file.toPath());\n            return Base64.getEncoder().encodeToString(fileContent);\n        } catch (Exception e) {\n            log.warn(\"failed to convert file to Base64: {}\", e.getMessage());\n            return null;\n        }\n    }\n}"}, {"color": "#22c55e", "id": "FileUtils.convertToBase64", "label": "FileUtils.convertToBase64()", "shape": "dot", "title": "public static String convertToBase64(File file) {\n        try {\n            byte[] fileContent = Files.readAllBytes(file.toPath());\n            return Base64.getEncoder().encodeToString(fileContent);\n        } catch (Exception e) {\n            log.warn(\"failed to convert file to Base64: {}\", e.getMessage());\n            return null;\n        }\n    }"}, {"color": "#3b82f6", "id": "FunctionHelper", "label": "Class: FunctionHelper", "shape": "dot", "title": "public class FunctionHelper {\n    public static String[] getNullPropertyNames (Object source, String... ignorePropertyNames) {\n        final BeanWrapper src = new BeanWrapperImpl(source);\n        java.beans.PropertyDescriptor[] pds = src.getPropertyDescriptors();\n\n        Set\u003cString\u003e emptyNames = new HashSet\u003c\u003e(Arrays.stream(ignorePropertyNames).toList());\n        for(java.beans.PropertyDescriptor pd : pds) {\n            Object srcValue = src.getPropertyValue(pd.getName());\n            if (srcValue == null) emptyNames.add(pd.getName());\n        }\n\n        String[] result = new String[emptyNames.size() + ignorePropertyNames.length];\n        return emptyNames.toArray(result);\n    }\n    public static String[] getNullPropertyNames (Object source) {\n        final BeanWrapper src = new BeanWrapperImpl(source);\n        java.beans.PropertyDescriptor[] pds = src.getPropertyDescriptors();\n\n        Set\u003cString\u003e emptyNames = new HashSet\u003c\u003e();\n        for(java.beans.PropertyDescriptor pd : pds) {\n            Object srcValue = src.getPropertyValue(pd.getName());\n            if (srcValue == null) emptyNames.add(pd.getName());\n        }\n\n        String[] result = new String[emptyNames.size()];\n        return emptyNames.toArray(result);\n    }\n\n    public static String generateRandomString(int length) {\n        String ALPHA_NUMERIC_STRING = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\n        StringBuilder builder = new StringBuilder();\n        while (length-- != 0) {\n            int character = (int)(Math.random()*ALPHA_NUMERIC_STRING.length());\n            builder.append(ALPHA_NUMERIC_STRING.charAt(character));\n        }\n        return builder.toString();\n    }\n}"}, {"color": "#22c55e", "id": "FunctionHelper.getNullPropertyNames", "label": "FunctionHelper.getNullPropertyNames()", "shape": "dot", "title": "public static String[] getNullPropertyNames (Object source, String... ignorePropertyNames) {\n        final BeanWrapper src = new BeanWrapperImpl(source);\n        java.beans.PropertyDescriptor[] pds = src.getPropertyDescriptors();\n\n        Set\u003cString\u003e emptyNames = new HashSet\u003c\u003e(Arrays.stream(ignorePropertyNames).toList());\n        for(java.beans.PropertyDescriptor pd : pds) {\n            Object srcValue = src.getPropertyValue(pd.getName());\n            if (srcValue == null) emptyNames.add(pd.getName());\n        }\n\n        String[] result = new String[emptyNames.size() + ignorePropertyNames.length];\n        return emptyNames.toArray(result);\n    }"}, {"color": "#22c55e", "id": "FunctionHelper.generateRandomString", "label": "FunctionHelper.generateRandomString()", "shape": "dot", "title": "public static String generateRandomString(int length) {\n        String ALPHA_NUMERIC_STRING = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\n        StringBuilder builder = new StringBuilder();\n        while (length-- != 0) {\n            int character = (int)(Math.random()*ALPHA_NUMERIC_STRING.length());\n            builder.append(ALPHA_NUMERIC_STRING.charAt(character));\n        }\n        return builder.toString();\n    }"}, {"color": "#3b82f6", "id": "JsonUtils", "label": "Class: JsonUtils", "shape": "dot", "title": "public class JsonUtils {\n\n    private JsonUtils() {}\n\n    public static \u003cT\u003e T getGenericObject(Object input, Class\u003cT\u003e clazz) {\n        try {\n            ObjectMapper objectMapper = new ObjectMapper();\n            objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n            objectMapper.enable(DeserializationFeature.ACCEPT_EMPTY_STRING_AS_NULL_OBJECT);\n            return objectMapper.convertValue(input, clazz);\n        } catch (Exception e) {\n            return null;\n        }\n    }\n\n    public static  \u003cT\u003e T getEntityFromJsonStr(String input, Class\u003cT\u003e clazz) {\n        try {\n            ObjectMapper objectMapper = new ObjectMapper();\n            objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n            objectMapper.enable(DeserializationFeature.ACCEPT_EMPTY_STRING_AS_NULL_OBJECT);\n            return objectMapper.readValue(input, clazz);\n        } catch (IOException e) {\n            return null;\n        }\n    }\n\n    public static String convertObjectToString(Object obj) throws JsonProcessingException {\n        return new ObjectMapper().writeValueAsString(obj);\n    }\n\n    public static String toJsonString(Object input) {\n        try {\n            ObjectMapper objectMapper = new ObjectMapper();\n            objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n            return objectMapper.writeValueAsString(input);\n        } catch (Exception e) {\n            e.printStackTrace();\n            return \"\";\n        }\n    }\n\n    public static \u003cT\u003e T readObject(String input, Class\u003cT\u003e clazz) throws IOException {\n        ObjectMapper objectMapper = new ObjectMapper();\n        objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n        return objectMapper.readValue(input, clazz);\n    }\n\n    public static \u003cT\u003e T  readListObject(Object input, Class\u003cT\u003e clazz) throws IOException {\n        ObjectMapper objectMapper = new ObjectMapper();\n        objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n        return objectMapper.readValue(objectMapper.writeValueAsString(input),\n                objectMapper.getTypeFactory().constructCollectionType(List.class, clazz));\n    }\n}"}, {"color": "#22c55e", "id": "JsonUtils.getGenericObject", "label": "JsonUtils.getGenericObject()", "shape": "dot", "title": "public static \u003cT\u003e T getGenericObject(Object input, Class\u003cT\u003e clazz) {\n        try {\n            ObjectMapper objectMapper = new ObjectMapper();\n            objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n            objectMapper.enable(DeserializationFeature.ACCEPT_EMPTY_STRING_AS_NULL_OBJECT);\n            return objectMapper.convertValue(input, clazz);\n        } catch (Exception e) {\n            return null;\n        }\n    }"}, {"color": "#22c55e", "id": "JsonUtils.getEntityFromJsonStr", "label": "JsonUtils.getEntityFromJsonStr()", "shape": "dot", "title": "public static  \u003cT\u003e T getEntityFromJsonStr(String input, Class\u003cT\u003e clazz) {\n        try {\n            ObjectMapper objectMapper = new ObjectMapper();\n            objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n            objectMapper.enable(DeserializationFeature.ACCEPT_EMPTY_STRING_AS_NULL_OBJECT);\n            return objectMapper.readValue(input, clazz);\n        } catch (IOException e) {\n            return null;\n        }\n    }"}, {"color": "#22c55e", "id": "JsonUtils.convertObjectToString", "label": "JsonUtils.convertObjectToString()", "shape": "dot", "title": "public static String convertObjectToString(Object obj) throws JsonProcessingException {\n        return new ObjectMapper().writeValueAsString(obj);\n    }"}, {"color": "#22c55e", "id": "JsonUtils.toJsonString", "label": "JsonUtils.toJsonString()", "shape": "dot", "title": "public static String toJsonString(Object input) {\n        try {\n            ObjectMapper objectMapper = new ObjectMapper();\n            objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n            return objectMapper.writeValueAsString(input);\n        } catch (Exception e) {\n            e.printStackTrace();\n            return \"\";\n        }\n    }"}, {"color": "#22c55e", "id": "JsonUtils.readObject", "label": "JsonUtils.readObject()", "shape": "dot", "title": "public static \u003cT\u003e T readObject(String input, Class\u003cT\u003e clazz) throws IOException {\n        ObjectMapper objectMapper = new ObjectMapper();\n        objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n        return objectMapper.readValue(input, clazz);\n    }"}, {"color": "#22c55e", "id": "JsonUtils.readListObject", "label": "JsonUtils.readListObject()", "shape": "dot", "title": "public static \u003cT\u003e T  readListObject(Object input, Class\u003cT\u003e clazz) throws IOException {\n        ObjectMapper objectMapper = new ObjectMapper();\n        objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n        return objectMapper.readValue(objectMapper.writeValueAsString(input),\n                objectMapper.getTypeFactory().constructCollectionType(List.class, clazz));\n    }"}, {"color": "#3b82f6", "id": "Utils", "label": "Class: Utils", "shape": "dot", "title": "public class Utils {\n\n    private static final String REGEX_FILTER_KEY =\n            \"[ : ]+((?=\\\\[)\\\\[[^]]*\\\\]|(?=\\\\{)\\\\{[^\\\\}]*\\\\}|\\\\\\\"[^\\\"]*\\\\\\\"|(\\\\d+(\\\\.\\\\d+)?))\";\n    private static final Logger log = LoggerFactory.getLogger(Utils.class);\n\n    static List\u003cString\u003e redactKeys = Collections.unmodifiableList(Arrays.asList(\n            \"api_key\", \"apiKey\", \"api_secret\", \"apiSecret\", \"otp\", \"pin\", \"access_token\", \"accessToken\", \"full_name\",\n            \"fullName\", \"phone_number\", \"phoneNumber\", \"email\", \"mobile_number\", \"mobileNumber\", \"email_address\", \"emailAddress\",\n            \"email_preference\", \"emailReference\", \"authorization\", \"verified_token\", \"verifiedToken\", \"x-api-secret\", \"xApiSecret\",\n            \"x-api-key\", \"xApiKey\", \"Authorization\", \"partner\", \"client_id\", \"clientId\", \"public_key\", \"publicKey\",\n            \"private_key\", \"privateKey\", \"x-public-key\", \"xPublicKey\", \"x-private-key\", \"xPrivateKey\", \"newrelic\",\n            \"refresh_token\", \"refreshToken\", \"password\", \"passcode\"));\n\n    public static long genAutoId(String key) {\n        if (StringUtils.isBlank(key)) {\n            key = UUID.randomUUID().toString();\n        }\n        byte[] bytes = key.getBytes(StandardCharsets.UTF_8);\n        long h = MurmurHash3.hash64(bytes);\n        return Math.abs(h);\n    }\n\n    public static String redact(@NonNull String string) {\n        try {\n            for (String key : redactKeys) {\n                Matcher matcher = Pattern.compile(String.format(\"\\\"%s\\\"%s\", key, REGEX_FILTER_KEY)).matcher(string);\n                if (matcher.find() \u0026\u0026 matcher.group(1) != null) {\n                    String group = matcher.group(1);\n                    if (!ObjectUtils.isEmpty(group.trim()) \u0026\u0026 !\"\\\"\\\"\".equals(group)) {\n                        string = string.replace(group, \"\\\"**********\\\"\");\n                    }\n                }\n            }\n            return string;\n        } catch (Exception e) {\n            return string;\n        }\n    }\n\n    public static \u003cT\u003e Map\u003cString, T\u003e convertListToMap(List\u003cT\u003e list, Function\u003cT, String\u003e keyExtractor) {\n        return list.stream().collect(Collectors.toMap(keyExtractor, Function.identity(), (oldVal, newVal) -\u003e newVal));\n    }\n\n    public static String convertDateToyyyyMMdd(Long input){\n        String pattern = \"yyyyMMdd\";\n        SimpleDateFormat simpleDateFormat = new SimpleDateFormat(pattern);\n        Date date = new Date(input);\n        return simpleDateFormat.format(date);\n    }\n\n    public static boolean isMatchRegex(String str, String regex) {\n        try {\n            if (str == null || regex == null) {\n                return false;\n            }\n\n            Pattern pattern = Pattern.compile(regex);\n            Matcher matcher = pattern.matcher(str);\n\n            return matcher.matches();\n        } catch (Exception e) {\n            log.error(e.getMessage());\n            return false;\n        }\n\n    }\n\n    public static String[] getBlankProperties(Object obj) {\n        return Arrays.stream(obj.getClass().getDeclaredFields())\n                .filter(f -\u003e {\n                    f.setAccessible(true);\n                    try {\n                        Object value = f.get(obj);\n                        return value == null || (value instanceof String \u0026\u0026 StringUtils.isBlank((String) value));\n                    } catch (IllegalAccessException e) {\n                        return true;\n                    }\n                })\n                .map(Field::getName)\n                .toArray(String[]::new);\n    }\n\n    public static String[] getExistedProperties(Object obj) {\n        return Arrays.stream(obj.getClass().getDeclaredFields())\n                .filter(f -\u003e {\n                    f.setAccessible(true);\n                    try {\n                        Object value = f.get(obj);\n                        if (value instanceof String) {\n                            return !StringUtils.isBlank((String) value);\n                        }\n                        return value != null;\n                    } catch (IllegalAccessException e) {\n                        return true;\n                    }\n                })\n                .map(Field::getName)\n                .toArray(String[]::new);\n    }\n\n    public static \u003cT extends Enum\u003cT\u003e\u003e T enumOf(Class\u003cT\u003e enumType, String value) {\n        return Arrays.stream(enumType.getEnumConstants())\n                .filter(e -\u003e e.name().equalsIgnoreCase(value))\n                .findFirst()\n                .orElse(null);\n    }\n\n    public static LocalDateTime stringToLocalDateTime(String dateOfBirth) {\n        if (StringUtils.isBlank(dateOfBirth)) {\n            return null;\n        }\n        return LocalDateTime.parse(dateOfBirth);\n    }\n}"}, {"color": "#22c55e", "id": "Utils.genAutoId", "label": "Utils.genAutoId()", "shape": "dot", "title": "public static long genAutoId(String key) {\n        if (StringUtils.isBlank(key)) {\n            key = UUID.randomUUID().toString();\n        }\n        byte[] bytes = key.getBytes(StandardCharsets.UTF_8);\n        long h = MurmurHash3.hash64(bytes);\n        return Math.abs(h);\n    }"}, {"color": "#22c55e", "id": "Utils.redact", "label": "Utils.redact()", "shape": "dot", "title": "public static String redact(@NonNull String string) {\n        try {\n            for (String key : redactKeys) {\n                Matcher matcher = Pattern.compile(String.format(\"\\\"%s\\\"%s\", key, REGEX_FILTER_KEY)).matcher(string);\n                if (matcher.find() \u0026\u0026 matcher.group(1) != null) {\n                    String group = matcher.group(1);\n                    if (!ObjectUtils.isEmpty(group.trim()) \u0026\u0026 !\"\\\"\\\"\".equals(group)) {\n                        string = string.replace(group, \"\\\"**********\\\"\");\n                    }\n                }\n            }\n            return string;\n        } catch (Exception e) {\n            return string;\n        }\n    }"}, {"color": "#22c55e", "id": "Utils.convertListToMap", "label": "Utils.convertListToMap()", "shape": "dot", "title": "public static \u003cT\u003e Map\u003cString, T\u003e convertListToMap(List\u003cT\u003e list, Function\u003cT, String\u003e keyExtractor) {\n        return list.stream().collect(Collectors.toMap(keyExtractor, Function.identity(), (oldVal, newVal) -\u003e newVal));\n    }"}, {"color": "#22c55e", "id": "Utils.convertDateToyyyyMMdd", "label": "Utils.convertDateToyyyyMMdd()", "shape": "dot", "title": "public static String convertDateToyyyyMMdd(Long input){\n        String pattern = \"yyyyMMdd\";\n        SimpleDateFormat simpleDateFormat = new SimpleDateFormat(pattern);\n        Date date = new Date(input);\n        return simpleDateFormat.format(date);\n    }"}, {"color": "#22c55e", "id": "Utils.isMatchRegex", "label": "Utils.isMatchRegex()", "shape": "dot", "title": "public static boolean isMatchRegex(String str, String regex) {\n        try {\n            if (str == null || regex == null) {\n                return false;\n            }\n\n            Pattern pattern = Pattern.compile(regex);\n            Matcher matcher = pattern.matcher(str);\n\n            return matcher.matches();\n        } catch (Exception e) {\n            log.error(e.getMessage());\n            return false;\n        }\n\n    }"}, {"color": "#22c55e", "id": "Utils.getBlankProperties", "label": "Utils.getBlankProperties()", "shape": "dot", "title": "public static String[] getBlankProperties(Object obj) {\n        return Arrays.stream(obj.getClass().getDeclaredFields())\n                .filter(f -\u003e {\n                    f.setAccessible(true);\n                    try {\n                        Object value = f.get(obj);\n                        return value == null || (value instanceof String \u0026\u0026 StringUtils.isBlank((String) value));\n                    } catch (IllegalAccessException e) {\n                        return true;\n                    }\n                })\n                .map(Field::getName)\n                .toArray(String[]::new);\n    }"}, {"color": "#22c55e", "id": "Utils.getExistedProperties", "label": "Utils.getExistedProperties()", "shape": "dot", "title": "public static String[] getExistedProperties(Object obj) {\n        return Arrays.stream(obj.getClass().getDeclaredFields())\n                .filter(f -\u003e {\n                    f.setAccessible(true);\n                    try {\n                        Object value = f.get(obj);\n                        if (value instanceof String) {\n                            return !StringUtils.isBlank((String) value);\n                        }\n                        return value != null;\n                    } catch (IllegalAccessException e) {\n                        return true;\n                    }\n                })\n                .map(Field::getName)\n                .toArray(String[]::new);\n    }"}, {"color": "#22c55e", "id": "Utils.enumOf", "label": "Utils.enumOf()", "shape": "dot", "title": "public static \u003cT extends Enum\u003cT\u003e\u003e T enumOf(Class\u003cT\u003e enumType, String value) {\n        return Arrays.stream(enumType.getEnumConstants())\n                .filter(e -\u003e e.name().equalsIgnoreCase(value))\n                .findFirst()\n                .orElse(null);\n    }"}, {"color": "#22c55e", "id": "Utils.stringToLocalDateTime", "label": "Utils.stringToLocalDateTime()", "shape": "dot", "title": "public static LocalDateTime stringToLocalDateTime(String dateOfBirth) {\n        if (StringUtils.isBlank(dateOfBirth)) {\n            return null;\n        }\n        return LocalDateTime.parse(dateOfBirth);\n    }"}, {"color": "#3b82f6", "id": "LogsActivityAOPHandler", "label": "Class: LogsActivityAOPHandler", "shape": "dot", "title": "@Aspect\n@Component\n@Order(value = 1)\n@Slf4j\npublic class LogsActivityAOPHandler extends BaseService {\n\n    private final HttpServletRequest httpServletRequest;\n\n    public static final String service_name = \"service_name\";\n\n    public static final String request_path = \"request_path\";\n\n    public static final String query_string = \"query_string\";\n\n    public static final String code_file = \"code_file\";\n\n    public static final String method_name = \"method_name\";\n\n    public static final String message_type = \"message_type\";\n\n    public static final String request_id = \"request_id\";\n\n    public static final String request = \"request\";\n\n    public static final String response = \"response\";\n\n    public static final String execution_time = \"execution_time\";\n\n    public static final String status_code = \"status_code\";\n\n    public static final String error_code = \"error_code\";\n\n    public static final String headers = \"headers\";\n\n    public LogsActivityAOPHandler(HttpServletRequest httpServletRequest) {\n        this.httpServletRequest = httpServletRequest;\n    }\n\n    @Around(\"execution(* *(..)) \u0026\u0026 @annotation(logsActivityAnnotation)\")\n    @SneakyThrows\n    public Object logsActivityAnnotation(ProceedingJoinPoint point, LogsActivityAnnotation logsActivityAnnotation) {\n        \n        Object objectRequest = point.getArgs().length \u003e 0 ? point.getArgs()[0] : httpServletRequest.getParameterMap();\n        String requestId = getRequestId();\n        \n        Map\u003cString, Object\u003e mapCustomizeLog = new HashMap\u003c\u003e();\n        mapCustomizeLog.put(LogsActivityAOPHandler.request_path, httpServletRequest.getRequestURI());\n        mapCustomizeLog.put(LogsActivityAOPHandler.query_string, httpServletRequest.getQueryString());\n        mapCustomizeLog.put(LogsActivityAOPHandler.code_file, point.getSignature().getDeclaringTypeName());\n        mapCustomizeLog.put(LogsActivityAOPHandler.method_name, point.getSignature().getName());\n        mapCustomizeLog.put(LogsActivityAOPHandler.message_type, LogsActivityAOPHandler.request);\n        mapCustomizeLog.put(LogsActivityAOPHandler.request_id, requestId);\n        mapCustomizeLog.put(LogsActivityAOPHandler.headers, Utils.redact(JsonUtils.convertObjectToString(getHeaders())));\n        displayLog(objectRequest, mapCustomizeLog);\n\n        long timeStart = new Date().getTime();\n        Object objectResponse = point.proceed();\n\n        long timeHandle = new Date().getTime() - timeStart;\n        mapCustomizeLog.put(LogsActivityAOPHandler.execution_time, timeHandle);\n        mapCustomizeLog.put(LogsActivityAOPHandler.code_file, point.getSignature().getDeclaringTypeName());\n        mapCustomizeLog.put(LogsActivityAOPHandler.method_name, point.getSignature().getName());\n        mapCustomizeLog.put(LogsActivityAOPHandler.request_id, requestId);\n        mapCustomizeLog.put(LogsActivityAOPHandler.message_type, LogsActivityAOPHandler.response);\n        mapCustomizeLog.put(LogsActivityAOPHandler.headers, Utils.redact(JsonUtils.convertObjectToString(getHeaders())));\n\n        displayLog(objectResponse, mapCustomizeLog);\n        return objectResponse;\n    }\n\n    private void displayLog(Object messageObject, Map\u003cString, Object\u003e mapCustomizeLog) throws JsonProcessingException {\n        if (messageObject instanceof Exception) {\n            Exception e = (Exception) messageObject;\n            if (e instanceof MethodArgumentNotValidException) {\n                log.info(Utils.redact(objectMapper.writeValueAsString(getRequestBody())), entries(mapCustomizeLog));\n                return;\n            } else if (e instanceof BusinessException) {\n                BusinessException businessException = (BusinessException) e;\n                if (!ObjectUtils.isEmpty(businessException.getError())) {\n                    if (!ObjectUtils.isEmpty(businessException.getError().getMessage())) {\n                        log.info(Utils.redact(e.getMessage()), entries(mapCustomizeLog));\n                        return;\n                    } else if (!ObjectUtils.isEmpty(businessException.getError().getData())) {\n                        log.info(Utils.redact(objectMapper.writeValueAsString(businessException.getError().getData())),\n                                entries(mapCustomizeLog));\n                        return;\n                    }\n                }\n            } else if (!ObjectUtils.isEmpty(e.getMessage())) {\n                log.info(Utils.redact(e.getMessage()), entries(mapCustomizeLog));\n            }\n\n            if (mapCustomizeLog.get(LogsActivityAOPHandler.message_type).toString().equals(LogsActivityAOPHandler.request)) {\n                log.error(\"Request_id: {}, Exception: \", getRequestId(), e);\n            }\n        } else {\n            if (mapCustomizeLog.get(LogsActivityAOPHandler.message_type).toString().equals(LogsActivityAOPHandler.response)) {\n                if (messageObject instanceof ResponseEntity) {\n                    ResponseEntity responseEntity = (ResponseEntity) messageObject;\n                    BaseResponse baseResponse = JsonUtils.getGenericObject(responseEntity.getBody(), BaseResponse.class);\n                    log.info(Utils.redact(objectMapper.writeValueAsString(baseResponse)), entries(mapCustomizeLog));\n                    return;\n                }\n            }\n\n            log.info(Utils.redact(objectMapper.writeValueAsString(messageObject)), entries(mapCustomizeLog));\n        }\n    }\n}"}, {"color": "#22c55e", "id": "LogsActivityAOPHandler.logsActivityAnnotation", "label": "LogsActivityAOPHandler.logsActivityAnnotation()", "shape": "dot", "title": "@Around(\"execution(* *(..)) \u0026\u0026 @annotation(logsActivityAnnotation)\")\n    @SneakyThrows\n    public Object logsActivityAnnotation(ProceedingJoinPoint point, LogsActivityAnnotation logsActivityAnnotation) {\n        \n        Object objectRequest = point.getArgs().length \u003e 0 ? point.getArgs()[0] : httpServletRequest.getParameterMap();\n        String requestId = getRequestId();\n        \n        Map\u003cString, Object\u003e mapCustomizeLog = new HashMap\u003c\u003e();\n        mapCustomizeLog.put(LogsActivityAOPHandler.request_path, httpServletRequest.getRequestURI());\n        mapCustomizeLog.put(LogsActivityAOPHandler.query_string, httpServletRequest.getQueryString());\n        mapCustomizeLog.put(LogsActivityAOPHandler.code_file, point.getSignature().getDeclaringTypeName());\n        mapCustomizeLog.put(LogsActivityAOPHandler.method_name, point.getSignature().getName());\n        mapCustomizeLog.put(LogsActivityAOPHandler.message_type, LogsActivityAOPHandler.request);\n        mapCustomizeLog.put(LogsActivityAOPHandler.request_id, requestId);\n        mapCustomizeLog.put(LogsActivityAOPHandler.headers, Utils.redact(JsonUtils.convertObjectToString(getHeaders())));\n        displayLog(objectRequest, mapCustomizeLog);\n\n        long timeStart = new Date().getTime();\n        Object objectResponse = point.proceed();\n\n        long timeHandle = new Date().getTime() - timeStart;\n        mapCustomizeLog.put(LogsActivityAOPHandler.execution_time, timeHandle);\n        mapCustomizeLog.put(LogsActivityAOPHandler.code_file, point.getSignature().getDeclaringTypeName());\n        mapCustomizeLog.put(LogsActivityAOPHandler.method_name, point.getSignature().getName());\n        mapCustomizeLog.put(LogsActivityAOPHandler.request_id, requestId);\n        mapCustomizeLog.put(LogsActivityAOPHandler.message_type, LogsActivityAOPHandler.response);\n        mapCustomizeLog.put(LogsActivityAOPHandler.headers, Utils.redact(JsonUtils.convertObjectToString(getHeaders())));\n\n        displayLog(objectResponse, mapCustomizeLog);\n        return objectResponse;\n    }"}, {"color": "#22c55e", "id": "LogsActivityAOPHandler.displayLog", "label": "LogsActivityAOPHandler.displayLog()", "shape": "dot", "title": "private void displayLog(Object messageObject, Map\u003cString, Object\u003e mapCustomizeLog) throws JsonProcessingException {\n        if (messageObject instanceof Exception) {\n            Exception e = (Exception) messageObject;\n            if (e instanceof MethodArgumentNotValidException) {\n                log.info(Utils.redact(objectMapper.writeValueAsString(getRequestBody())), entries(mapCustomizeLog));\n                return;\n            } else if (e instanceof BusinessException) {\n                BusinessException businessException = (BusinessException) e;\n                if (!ObjectUtils.isEmpty(businessException.getError())) {\n                    if (!ObjectUtils.isEmpty(businessException.getError().getMessage())) {\n                        log.info(Utils.redact(e.getMessage()), entries(mapCustomizeLog));\n                        return;\n                    } else if (!ObjectUtils.isEmpty(businessException.getError().getData())) {\n                        log.info(Utils.redact(objectMapper.writeValueAsString(businessException.getError().getData())),\n                                entries(mapCustomizeLog));\n                        return;\n                    }\n                }\n            } else if (!ObjectUtils.isEmpty(e.getMessage())) {\n                log.info(Utils.redact(e.getMessage()), entries(mapCustomizeLog));\n            }\n\n            if (mapCustomizeLog.get(LogsActivityAOPHandler.message_type).toString().equals(LogsActivityAOPHandler.request)) {\n                log.error(\"Request_id: {}, Exception: \", getRequestId(), e);\n            }\n        } else {\n            if (mapCustomizeLog.get(LogsActivityAOPHandler.message_type).toString().equals(LogsActivityAOPHandler.response)) {\n                if (messageObject instanceof ResponseEntity) {\n                    ResponseEntity responseEntity = (ResponseEntity) messageObject;\n                    BaseResponse baseResponse = JsonUtils.getGenericObject(responseEntity.getBody(), BaseResponse.class);\n                    log.info(Utils.redact(objectMapper.writeValueAsString(baseResponse)), entries(mapCustomizeLog));\n                    return;\n                }\n            }\n\n            log.info(Utils.redact(objectMapper.writeValueAsString(messageObject)), entries(mapCustomizeLog));\n        }\n    }"}, {"color": "#3b82f6", "id": "ValueOfEnumValidator", "label": "Class: ValueOfEnumValidator", "shape": "dot", "title": "public class ValueOfEnumValidator implements ConstraintValidator\u003cValueOfEnum, CharSequence\u003e {\n    private List\u003cString\u003e acceptedValues;\n\n    @Override\n    public void initialize(ValueOfEnum annotation) {\n        acceptedValues = Stream.of(annotation.enumClass().getEnumConstants())\n                .map(Enum::name)\n                .collect(Collectors.toList());\n    }\n\n    @Override\n    public boolean isValid(CharSequence value, ConstraintValidatorContext context) {\n        if (value == null) {\n            return true;\n        }\n\n        return acceptedValues.contains(value.toString());\n    }\n}"}, {"color": "#22c55e", "id": "ValueOfEnumValidator.initialize", "label": "ValueOfEnumValidator.initialize()", "shape": "dot", "title": "@Override\n    public void initialize(ValueOfEnum annotation) {\n        acceptedValues = Stream.of(annotation.enumClass().getEnumConstants())\n                .map(Enum::name)\n                .collect(Collectors.toList());\n    }"}, {"color": "#22c55e", "id": "ValueOfEnumValidator.isValid", "label": "ValueOfEnumValidator.isValid()", "shape": "dot", "title": "@Override\n    public boolean isValid(CharSequence value, ConstraintValidatorContext context) {\n        if (value == null) {\n            return true;\n        }\n\n        return acceptedValues.contains(value.toString());\n    }"}, {"color": "#3b82f6", "id": "AuthController", "label": "Class: AuthController", "shape": "dot", "title": "@RestController\n@RequestMapping(\"/api/v1/auth\")\n@Slf4j\npublic class AuthController {\n\n    private final BaseService baseService;\n\n    private final AuthService authService;\n\n    public AuthController(BaseService baseService, AuthService authService) {\n        this.baseService = baseService;\n        this.authService = authService;\n    }\n\n    @GetMapping(\"/me\")\n    public BaseResponse\u003cAuthProfileResponse\u003e whoAmI(@CurrentUser UserPrincipal requester) {\n        return baseService.ofSucceeded(authService.getAuthProfile(requester.getId().toString()));\n    }\n}"}, {"color": "#22c55e", "id": "AuthController.whoAmI", "label": "AuthController.whoAmI()", "shape": "dot", "title": "@GetMapping(\"/me\")\n    public BaseResponse\u003cAuthProfileResponse\u003e whoAmI(@CurrentUser UserPrincipal requester) {\n        return baseService.ofSucceeded(authService.getAuthProfile(requester.getId().toString()));\n    }"}, {"color": "#3b82f6", "id": "QuestionController", "label": "Class: QuestionController", "shape": "dot", "title": "@RestController\n@RequestMapping(\"/api/v1/questions\")\npublic class QuestionController {\n\n}"}, {"color": "#3b82f6", "id": "QuizController", "label": "Class: QuizController", "shape": "dot", "title": "@RestController\n@RequestMapping(\"/api/v1/quizzes\")\npublic class QuizController {\n\n    private final QuizService quizService;\n\n    private final BaseService baseService;\n\n    public QuizController(QuizService quizService, BaseService baseService) {\n        this.quizService = quizService;\n        this.baseService = baseService;\n    }\n\n    @PostMapping\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e createQuiz(@RequestBody CreateQuizDto request, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.createQuiz(request, currentUser.getId()));\n    }\n\n    @PutMapping\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e updateQuiz(@RequestBody CreateQuizDto request, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.updateQuiz(request));\n    }\n\n    @GetMapping(\"/{id}\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cQuiz\u003e getQuizById(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getById(id));\n    }\n\n    @GetMapping(\"/{id}/stats\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cQuiz\u003e getQuizStatsById(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getQuizStatsById(id));\n    }\n\n    @GetMapping(\"/my\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cQuiz\u003e\u003e getMyQuizzes(@CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getMyQuizzes(currentUser.getId()));\n    }\n\n    @DeleteMapping(\"/{id}\")\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e deleteQuiz(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        quizService.deleteQuiz(id);\n        return baseService.ofSucceeded(null);\n    }\n\n    @PostMapping(\"/{id}/save\")\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e saveQuiz(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        quizService.saveQuiz(id, currentUser.getId());\n        return baseService.ofSucceeded(null);\n    }\n\n    @DeleteMapping(\"/{id}/save\")\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e unsaveQuiz(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        quizService.unsaveQuiz(id, currentUser.getId());\n        return baseService.ofSucceeded(null);\n    }\n\n    @GetMapping(\"/{id}/save\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cUserSavedQuiz\u003e\u003e getListUserSavedQuiz(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getUserSavedQuiz(id, currentUser.getId()));\n    }\n\n    @GetMapping(\"/save\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cQuiz\u003e\u003e getSavedQuizzes(@CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getSavedQuizzes(currentUser.getId()));\n    }\n\n    @PostMapping(\"/{id}/attempts\")\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e attemptQuiz(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.startQuiz(id, currentUser.getId()));\n    }\n\n    @GetMapping(\"/attempts\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cQuiz\u003e\u003e getQuizAttempts(@CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getMyQuizAttempts(currentUser.getId().toString()));\n    }\n\n    @GetMapping(\"/attempts/{id}\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cQuizAttempt\u003e getQuizAttempt(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getAttempt(id, currentUser.getId()));\n    }\n\n    @PostMapping(\"/attempts/{attempt_id}/submit-question\")\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e submitQuizQuestion(@PathVariable String attempt_id, @RequestBody SubmitAnswerRequest request, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.submitQuizQuestion(attempt_id, request, currentUser.getId()));\n    }\n\n    @PostMapping(\"/attempts/{attempt_id}/complete\")\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e submitQuizComplete(@PathVariable String attempt_id, @CurrentUser UserPrincipal currentUser) {\n        quizService.submitQuizComplete(attempt_id, currentUser.getId());\n        return baseService.ofSucceeded(null);\n    }\n\n    @GetMapping(\"/search\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cQuiz\u003e\u003e search(@RequestParam String query) {\n        return baseService.ofSucceeded(quizService.search(query));\n    }\n\n    @GetMapping(\"/search2\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cQuiz\u003e\u003e search2(@RequestParam String query) {\n        return baseService.ofSucceeded(quizService.search2(query));\n    }\n\n}"}, {"color": "#22c55e", "id": "QuizController.createQuiz", "label": "QuizController.createQuiz()", "shape": "dot", "title": "@PostMapping\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e createQuiz(@RequestBody CreateQuizDto request, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.createQuiz(request, currentUser.getId()));\n    }"}, {"color": "#22c55e", "id": "QuizController.updateQuiz", "label": "QuizController.updateQuiz()", "shape": "dot", "title": "@PutMapping\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e updateQuiz(@RequestBody CreateQuizDto request, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.updateQuiz(request));\n    }"}, {"color": "#22c55e", "id": "QuizController.getQuizById", "label": "QuizController.getQuizById()", "shape": "dot", "title": "@GetMapping(\"/{id}\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cQuiz\u003e getQuizById(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getById(id));\n    }"}, {"color": "#22c55e", "id": "QuizController.getQuizStatsById", "label": "QuizController.getQuizStatsById()", "shape": "dot", "title": "@GetMapping(\"/{id}/stats\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cQuiz\u003e getQuizStatsById(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getQuizStatsById(id));\n    }"}, {"color": "#22c55e", "id": "QuizController.getMyQuizzes", "label": "QuizController.getMyQuizzes()", "shape": "dot", "title": "@GetMapping(\"/my\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cQuiz\u003e\u003e getMyQuizzes(@CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getMyQuizzes(currentUser.getId()));\n    }"}, {"color": "#22c55e", "id": "QuizController.deleteQuiz", "label": "QuizController.deleteQuiz()", "shape": "dot", "title": "@DeleteMapping(\"/{id}\")\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e deleteQuiz(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        quizService.deleteQuiz(id);\n        return baseService.ofSucceeded(null);\n    }"}, {"color": "#22c55e", "id": "QuizController.saveQuiz", "label": "QuizController.saveQuiz()", "shape": "dot", "title": "@PostMapping(\"/{id}/save\")\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e saveQuiz(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        quizService.saveQuiz(id, currentUser.getId());\n        return baseService.ofSucceeded(null);\n    }"}, {"color": "#22c55e", "id": "QuizController.unsaveQuiz", "label": "QuizController.unsaveQuiz()", "shape": "dot", "title": "@DeleteMapping(\"/{id}/save\")\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e unsaveQuiz(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        quizService.unsaveQuiz(id, currentUser.getId());\n        return baseService.ofSucceeded(null);\n    }"}, {"color": "#22c55e", "id": "QuizController.getListUserSavedQuiz", "label": "QuizController.getListUserSavedQuiz()", "shape": "dot", "title": "@GetMapping(\"/{id}/save\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cUserSavedQuiz\u003e\u003e getListUserSavedQuiz(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getUserSavedQuiz(id, currentUser.getId()));\n    }"}, {"color": "#22c55e", "id": "QuizController.getSavedQuizzes", "label": "QuizController.getSavedQuizzes()", "shape": "dot", "title": "@GetMapping(\"/save\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cQuiz\u003e\u003e getSavedQuizzes(@CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getSavedQuizzes(currentUser.getId()));\n    }"}, {"color": "#22c55e", "id": "QuizController.attemptQuiz", "label": "QuizController.attemptQuiz()", "shape": "dot", "title": "@PostMapping(\"/{id}/attempts\")\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e attemptQuiz(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.startQuiz(id, currentUser.getId()));\n    }"}, {"color": "#22c55e", "id": "QuizController.getQuizAttempts", "label": "QuizController.getQuizAttempts()", "shape": "dot", "title": "@GetMapping(\"/attempts\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cQuiz\u003e\u003e getQuizAttempts(@CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getMyQuizAttempts(currentUser.getId().toString()));\n    }"}, {"color": "#22c55e", "id": "QuizController.getQuizAttempt", "label": "QuizController.getQuizAttempt()", "shape": "dot", "title": "@GetMapping(\"/attempts/{id}\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cQuizAttempt\u003e getQuizAttempt(@PathVariable String id, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.getAttempt(id, currentUser.getId()));\n    }"}, {"color": "#22c55e", "id": "QuizController.submitQuizQuestion", "label": "QuizController.submitQuizQuestion()", "shape": "dot", "title": "@PostMapping(\"/attempts/{attempt_id}/submit-question\")\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e submitQuizQuestion(@PathVariable String attempt_id, @RequestBody SubmitAnswerRequest request, @CurrentUser UserPrincipal currentUser) {\n        return baseService.ofSucceeded(quizService.submitQuizQuestion(attempt_id, request, currentUser.getId()));\n    }"}, {"color": "#22c55e", "id": "QuizController.submitQuizComplete", "label": "QuizController.submitQuizComplete()", "shape": "dot", "title": "@PostMapping(\"/attempts/{attempt_id}/complete\")\n    @LogsActivityAnnotation\n    BaseResponse\u003c?\u003e submitQuizComplete(@PathVariable String attempt_id, @CurrentUser UserPrincipal currentUser) {\n        quizService.submitQuizComplete(attempt_id, currentUser.getId());\n        return baseService.ofSucceeded(null);\n    }"}, {"color": "#22c55e", "id": "QuizController.search", "label": "QuizController.search()", "shape": "dot", "title": "@GetMapping(\"/search\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cQuiz\u003e\u003e search(@RequestParam String query) {\n        return baseService.ofSucceeded(quizService.search(query));\n    }"}, {"color": "#22c55e", "id": "QuizController.search2", "label": "QuizController.search2()", "shape": "dot", "title": "@GetMapping(\"/search2\")\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cQuiz\u003e\u003e search2(@RequestParam String query) {\n        return baseService.ofSucceeded(quizService.search2(query));\n    }"}, {"color": "#3b82f6", "id": "ResourceController", "label": "Class: ResourceController", "shape": "dot", "title": "@RestController\n@RequestMapping(\"/api/v1/resources\")\npublic class ResourceController {\n\n    private final BaseService baseService;\n\n    private final ResourceService resourceService;\n\n    public ResourceController(BaseService baseService, ResourceService resourceService) {\n        this.baseService = baseService;\n        this.resourceService = resourceService;\n    }\n\n    @PostMapping()\n    public BaseResponse\u003cResource\u003e uploadResource(\n            @CurrentUser UserPrincipal requester,\n            @RequestParam(\"file\") MultipartFile file\n    ) {\n        return baseService.ofSucceeded(resourceService.uploadResource(file, requester.getId()));\n    }\n\n    @GetMapping(\"/{id}\")\n    public BaseResponse\u003cGetResourceResponse\u003e getResource(\n            @CurrentUser UserPrincipal requester,\n            @PathVariable String id\n    ) {\n        return baseService.ofSucceeded(resourceService.getResource(id, requester.getId()));\n    }\n\n}"}, {"color": "#22c55e", "id": "ResourceController.uploadResource", "label": "ResourceController.uploadResource()", "shape": "dot", "title": "@PostMapping()\n    public BaseResponse\u003cResource\u003e uploadResource(\n            @CurrentUser UserPrincipal requester,\n            @RequestParam(\"file\") MultipartFile file\n    ) {\n        return baseService.ofSucceeded(resourceService.uploadResource(file, requester.getId()));\n    }"}, {"color": "#22c55e", "id": "ResourceController.getResource", "label": "ResourceController.getResource()", "shape": "dot", "title": "@GetMapping(\"/{id}\")\n    public BaseResponse\u003cGetResourceResponse\u003e getResource(\n            @CurrentUser UserPrincipal requester,\n            @PathVariable String id\n    ) {\n        return baseService.ofSucceeded(resourceService.getResource(id, requester.getId()));\n    }"}, {"color": "#3b82f6", "id": "UserController", "label": "Class: UserController", "shape": "dot", "title": "@RestController\n@RequestMapping(\"/api/v1/users\")\npublic class UserController {\n\n    private final BaseService baseService;\n\n    public UserController(BaseService baseService) {\n        this.baseService = baseService;\n    }\n\n    @PutMapping\n    public BaseResponse\u003c?\u003e uploadResource(\n            @CurrentUser UserPrincipal requester\n    ) {\n        \n        return baseService.ofSucceeded(null);\n    }\n\n}"}, {"color": "#22c55e", "id": "UserController.uploadResource", "label": "UserController.uploadResource()", "shape": "dot", "title": "@PutMapping\n    public BaseResponse\u003c?\u003e uploadResource(\n            @CurrentUser UserPrincipal requester\n    ) {\n        \n        return baseService.ofSucceeded(null);\n    }"}, {"color": "#3b82f6", "id": "AuthPubController", "label": "Class: AuthPubController", "shape": "dot", "title": "@RestController\n@RequestMapping(\"/api/v1/pub/auth\")\n@Slf4j\npublic class AuthPubController {\n\n    private final BaseService baseService;\n\n    private final AuthService authService;\n\n    public AuthPubController(BaseService baseService, AuthService authService) {\n        this.baseService = baseService;\n        this.authService = authService;\n    }\n\n    @PostMapping(\"/login\")\n    @LogsActivityAnnotation\n    public BaseResponse\u003cAuthLoginResponse\u003e login(@Valid @RequestBody AuthLoginRequest request) {\n        return baseService.ofSucceeded(authService.login(request));\n    }\n\n    @PostMapping(\"/register\")\n    public BaseResponse\u003cAuthRegisterResponse\u003e register(@Valid @RequestBody AuthRegisterRequest request) {\n        return baseService.ofSucceeded(authService.register(request));\n    }\n\n}"}, {"color": "#22c55e", "id": "AuthPubController.login", "label": "AuthPubController.login()", "shape": "dot", "title": "@PostMapping(\"/login\")\n    @LogsActivityAnnotation\n    public BaseResponse\u003cAuthLoginResponse\u003e login(@Valid @RequestBody AuthLoginRequest request) {\n        return baseService.ofSucceeded(authService.login(request));\n    }"}, {"color": "#22c55e", "id": "AuthPubController.register", "label": "AuthPubController.register()", "shape": "dot", "title": "@PostMapping(\"/register\")\n    public BaseResponse\u003cAuthRegisterResponse\u003e register(@Valid @RequestBody AuthRegisterRequest request) {\n        return baseService.ofSucceeded(authService.register(request));\n    }"}, {"color": "#3b82f6", "id": "PronunciationController", "label": "Class: PronunciationController", "shape": "dot", "title": "@RestController\n@RequestMapping(\"/api/v1/pub/pronunciations\")\npublic class PronunciationController {\n\n    private final BaseService baseService;\n\n    private final PronunciationService pronunciationService;\n\n    public PronunciationController(BaseService baseService, PronunciationService pronunciationService) {\n        this.baseService = baseService;\n        this.pronunciationService = pronunciationService;\n    }\n\n    @GetMapping(\"/samples\")\n    public BaseResponse\u003cObject\u003e getSamplePronunciations(GetSampleRequestDto request) {\n        return baseService.ofSucceeded(pronunciationService.getSample(request));\n    }\n\n    @PostMapping(\"/accuracy\")\n    public BaseResponse\u003cObject\u003e getAccuracy(@RequestBody PronunciationAccuracyRequestDto request) {\n        return baseService.ofSucceeded(pronunciationService.getAccuracy(request));\n    }\n\n}"}, {"color": "#22c55e", "id": "PronunciationController.getSamplePronunciations", "label": "PronunciationController.getSamplePronunciations()", "shape": "dot", "title": "@GetMapping(\"/samples\")\n    public BaseResponse\u003cObject\u003e getSamplePronunciations(GetSampleRequestDto request) {\n        return baseService.ofSucceeded(pronunciationService.getSample(request));\n    }"}, {"color": "#22c55e", "id": "PronunciationController.getAccuracy", "label": "PronunciationController.getAccuracy()", "shape": "dot", "title": "@PostMapping(\"/accuracy\")\n    public BaseResponse\u003cObject\u003e getAccuracy(@RequestBody PronunciationAccuracyRequestDto request) {\n        return baseService.ofSucceeded(pronunciationService.getAccuracy(request));\n    }"}, {"color": "#3b82f6", "id": "QuizPubController", "label": "Class: QuizPubController", "shape": "dot", "title": "@RestController\n@RequestMapping(\"/api/v1/pub/quizzes\")\npublic class QuizPubController {\n\n    private final QuizService quizService;\n\n    public QuizPubController(QuizService quizService) {\n        this.quizService = quizService;\n    }\n\n    @GetMapping\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cQuiz\u003e\u003e getAllQuizzes(@CurrentUser UserPrincipal currentUser) {\n        return BaseResponse.ofSucceeded(quizService.getAllPublicQuizzes());\n    }\n\n}"}, {"color": "#22c55e", "id": "QuizPubController.getAllQuizzes", "label": "QuizPubController.getAllQuizzes()", "shape": "dot", "title": "@GetMapping\n    @LogsActivityAnnotation\n    BaseResponse\u003cList\u003cQuiz\u003e\u003e getAllQuizzes(@CurrentUser UserPrincipal currentUser) {\n        return BaseResponse.ofSucceeded(quizService.getAllPublicQuizzes());\n    }"}, {"color": "#3b82f6", "id": "AuthLoginRequest", "label": "Class: AuthLoginRequest", "shape": "dot", "title": "@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class AuthLoginRequest {\n\n    @NotBlank\n    String username;\n\n    @NotBlank\n    String password;\n\n}"}, {"color": "#3b82f6", "id": "AuthLoginResponse", "label": "Class: AuthLoginResponse", "shape": "dot", "title": "public record AuthLoginResponse(String accessToken, String refreshToken) {\n}"}, {"color": "#3b82f6", "id": "AuthProfileResponse", "label": "Class: AuthProfileResponse", "shape": "dot", "title": "@AllArgsConstructor\n@Data\npublic class AuthProfileResponse {\n\n    private String email;\n\n    private String username;\n\n    private String firstName;\n\n    private String lastName;\n\n    private String phoneNumber;\n\n    private String gender;\n\n    private String role;\n\n    private String avatar;\n\n    private Boolean isVerified;\n\n}"}, {"color": "#3b82f6", "id": "AuthRegisterRequest", "label": "Class: AuthRegisterRequest", "shape": "dot", "title": "@Data\n@JsonNaming(PropertyNamingStrategies.SnakeCaseStrategy.class)\n@AllArgsConstructor\n@NoArgsConstructor\npublic class AuthRegisterRequest {\n\n    @NotBlank(message = \"Username is required\")\n    String username;\n\n    @NotBlank(message = \"Email is required\")\n    @Email(message = \"Email is invalid\")\n    String email;\n\n    @NotBlank(message = \"Password is required\")\n    String password;\n\n    @NotBlank(message = \"Name is required\")\n    String name;\n\n}"}, {"color": "#3b82f6", "id": "AuthRegisterResponse", "label": "Class: AuthRegisterResponse", "shape": "dot", "title": "@AllArgsConstructor\n@Data\npublic class AuthRegisterResponse {\n    private String id;\n}"}, {"color": "#3b82f6", "id": "GetPronunciationSampleResponseDto", "label": "Class: GetPronunciationSampleResponseDto", "shape": "dot", "title": "@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class GetPronunciationSampleResponseDto {\n\n    private String ipaTranscript;\n\n    private String realTranscript;\n\n    private String transcriptTranslation;\n\n}"}, {"color": "#3b82f6", "id": "GetSampleRequestDto", "label": "Class: GetSampleRequestDto", "shape": "dot", "title": "@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class GetSampleRequestDto {\n\n    @NotNull\n    private PronunciationLevel level;\n\n    private String customText;\n\n}"}, {"color": "#3b82f6", "id": "PronunciationAccuracyRequestDto", "label": "Class: PronunciationAccuracyRequestDto", "shape": "dot", "title": "@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@Builder\npublic class PronunciationAccuracyRequestDto {\n\n    private String base64Audio;\n\n    private String text;\n\n}"}, {"color": "#3b82f6", "id": "PronunciationAccuracyResponseDto", "label": "Class: PronunciationAccuracyResponseDto", "shape": "dot", "title": "@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class PronunciationAccuracyResponseDto {\n\n    private String startTime;\n\n    private String endTime;\n\n    private String ipaScript;\n\n    private String isLetterCorrectAllWords;\n\n    private String matchedTranscripts;\n\n    private String matchedTranscriptsIpa;\n\n    private String pairAccuracyCategory;\n\n    private Integer pronunciationAccuracy;\n\n    private String realTranscript;\n\n    private String realTranscripts;\n\n    private String realTranscriptsIpa;\n\n}"}, {"color": "#3b82f6", "id": "CreateQuizDto", "label": "Class: CreateQuizDto", "shape": "dot", "title": "@Data\npublic class CreateQuizDto {\n\n    private String id;\n\n    private String title;\n\n    private String description;\n\n    private List\u003cQuestionDto\u003e questions;\n\n    private LocalDateTime createdAt;\n\n    private LocalDateTime updatedAt;\n\n    private Integer totalPoints;\n\n    private String difficulty;\n\n    private Integer estimatedDuration;\n\n    private List\u003cString\u003e tags;\n\n    private Boolean isPublic;\n\n    private Integer version;\n\n    private QuizNavigationMode navigationMode;\n\n    private Boolean hasTimer;\n\n    private Integer timeLimit;\n\n    private Integer warningTime;\n\n    private Boolean allowQuestionPicker;\n\n    private Boolean shuffleQuestions;\n\n    private Boolean shuffleAnswers;\n\n    private Boolean showProgress;\n\n    private Boolean allowPause;\n\n    private Integer maxAttempts;\n\n    private Integer passingScore;\n\n}"}, {"color": "#3b82f6", "id": "OptionDto", "label": "Class: OptionDto", "shape": "dot", "title": "@Data\npublic class OptionDto {\n\n    private UUID id;\n\n    private String text;\n\n    private Boolean isCorrect;\n\n}"}, {"color": "#3b82f6", "id": "QuestionDto", "label": "Class: QuestionDto", "shape": "dot", "title": "@Data\npublic class QuestionDto {\n\n    private String id;\n\n    private QuestionType type;\n\n    private String text;\n\n    private List\u003cOptionDto\u003e options;\n\n    private String pronunciationText;\n\n    private List\u003cString\u003e correctBlanks;\n\n    private Boolean trueFalseAnswer;\n\n    private String audioUrl;\n\n    private String imageUrl;\n\n    private Integer maxListeningTime;\n\n    private int points;\n\n    private Difficulty difficulty;\n\n    private Integer acceptRate;\n\n    private String category;\n\n    private LocalDateTime createdAt;\n\n    private LocalDateTime updatedAt;\n\n}"}, {"color": "#3b82f6", "id": "StartQuizResponse", "label": "Class: StartQuizResponse", "shape": "dot", "title": "@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class StartQuizResponse {\n\n    private String quizAttemptId;\n\n    private String quizId;\n\n    private String userId;\n\n    private LocalDateTime startedAt;\n\n}"}, {"color": "#3b82f6", "id": "SubmitAnswerRequest", "label": "Class: SubmitAnswerRequest", "shape": "dot", "title": "@Data\npublic class SubmitAnswerRequest {\n\n    private String questionId;\n\n    private List\u003cString\u003e selectedOptions;\n\n    private List\u003cString\u003e fillInBlanksAnswers;\n\n    private String answerText;\n\n    private Boolean userAnswerTrueFalse;\n\n    private Integer timeTaken;\n\n    private String audioUrl;\n\n}"}, {"color": "#3b82f6", "id": "GetResourceResponse", "label": "Class: GetResourceResponse", "shape": "dot", "title": "@Data\n@Builder\npublic class GetResourceResponse {\n\n    private String url;\n\n    private String name;\n\n}"}, {"color": "#3b82f6", "id": "BasicUserDto", "label": "Class: BasicUserDto", "shape": "dot", "title": "@Data\n@JsonNaming(PropertyNamingStrategies.SnakeCaseStrategy.class)\npublic class BasicUserDto {\n\n    private UUID id;\n\n    private String username;\n\n    private String email;\n\n    private String firstName;\n\n    private String lastName;\n\n}"}, {"color": "#3b82f6", "id": "JpaQuestionRepository", "label": "Class: JpaQuestionRepository", "shape": "dot", "title": "@Repository\npublic interface JpaQuestionRepository extends JpaRepository\u003cQuestion, UUID\u003e {\n\n     List\u003cQuestion\u003e findByQuizId(UUID quizId);\n\n     Integer countByQuizId(UUID quizId);\n\n}"}, {"color": "#22c55e", "id": "JpaQuestionRepository.findByQuizId", "label": "JpaQuestionRepository.findByQuizId()", "shape": "dot", "title": "List\u003cQuestion\u003e findByQuizId(UUID quizId);"}, {"color": "#22c55e", "id": "JpaQuestionRepository.countByQuizId", "label": "JpaQuestionRepository.countByQuizId()", "shape": "dot", "title": "Integer countByQuizId(UUID quizId);"}, {"color": "#3b82f6", "id": "JpaQuizAnswerRepository", "label": "Class: JpaQuizAnswerRepository", "shape": "dot", "title": "public interface JpaQuizAnswerRepository extends JpaRepository\u003cQuizAnswer, UUID\u003e {\n    List\u003cQuizAnswer\u003e findByQuizAttemptId(UUID quizAttemptId);\n}"}, {"color": "#22c55e", "id": "JpaQuizAnswerRepository.findByQuizAttemptId", "label": "JpaQuizAnswerRepository.findByQuizAttemptId()", "shape": "dot", "title": "List\u003cQuizAnswer\u003e findByQuizAttemptId(UUID quizAttemptId);"}, {"color": "#3b82f6", "id": "JpaQuizAttemptRepository", "label": "Class: JpaQuizAttemptRepository", "shape": "dot", "title": "@Repository\npublic interface JpaQuizAttemptRepository extends JpaRepository\u003cQuizAttempt, UUID\u003e {\n\n    List\u003cQuizAttempt\u003e findByUserId(UUID id);\n\n    List\u003cQuizAttempt\u003e findByQuizId(UUID quizId);\n}"}, {"color": "#22c55e", "id": "JpaQuizAttemptRepository.findByUserId", "label": "JpaQuizAttemptRepository.findByUserId()", "shape": "dot", "title": "List\u003cQuizAttempt\u003e findByUserId(UUID id);"}, {"color": "#22c55e", "id": "JpaQuizAttemptRepository.findByQuizId", "label": "JpaQuizAttemptRepository.findByQuizId()", "shape": "dot", "title": "List\u003cQuizAttempt\u003e findByQuizId(UUID quizId);"}, {"color": "#3b82f6", "id": "JpaQuizRepository", "label": "Class: JpaQuizRepository", "shape": "dot", "title": "@Repository\npublic interface JpaQuizRepository extends JpaRepository\u003cQuiz, UUID\u003e {\n    List\u003cQuiz\u003e findByAuthorId(UUID authorId);\n\n    List\u003cQuiz\u003e findByIdIn(Collection\u003cUUID\u003e ids);\n\n    List\u003cQuiz\u003e findByStatus(QuizStatus status);\n}"}, {"color": "#22c55e", "id": "JpaQuizRepository.findByAuthorId", "label": "JpaQuizRepository.findByAuthorId()", "shape": "dot", "title": "List\u003cQuiz\u003e findByAuthorId(UUID authorId);"}, {"color": "#22c55e", "id": "JpaQuizRepository.findByIdIn", "label": "JpaQuizRepository.findByIdIn()", "shape": "dot", "title": "List\u003cQuiz\u003e findByIdIn(Collection\u003cUUID\u003e ids);"}, {"color": "#22c55e", "id": "JpaQuizRepository.findByStatus", "label": "JpaQuizRepository.findByStatus()", "shape": "dot", "title": "List\u003cQuiz\u003e findByStatus(QuizStatus status);"}, {"color": "#3b82f6", "id": "JpaResourceRepository", "label": "Class: JpaResourceRepository", "shape": "dot", "title": "public interface JpaResourceRepository extends JpaRepository\u003cResource, UUID\u003e {\n}"}, {"color": "#3b82f6", "id": "JpaSavedQuizRepository", "label": "Class: JpaSavedQuizRepository", "shape": "dot", "title": "@Repository\npublic interface JpaSavedQuizRepository extends JpaRepository\u003cUserSavedQuiz,  UUID\u003e {\n    List\u003cUserSavedQuiz\u003e findByUserId(UUID userId);\n\n    void deleteByQuizIdAndUserId(UUID quizId, UUID userId);\n\n    boolean existsByQuizIdAndUserId(UUID quizId, UUID userId);\n\n    List\u003cUserSavedQuiz\u003e findAllByQuizId(UUID quizId);\n}"}, {"color": "#22c55e", "id": "JpaSavedQuizRepository.findByUserId", "label": "JpaSavedQuizRepository.findByUserId()", "shape": "dot", "title": "List\u003cUserSavedQuiz\u003e findByUserId(UUID userId);"}, {"color": "#22c55e", "id": "JpaSavedQuizRepository.deleteByQuizIdAndUserId", "label": "JpaSavedQuizRepository.deleteByQuizIdAndUserId()", "shape": "dot", "title": "void deleteByQuizIdAndUserId(UUID quizId, UUID userId);"}, {"color": "#22c55e", "id": "JpaSavedQuizRepository.existsByQuizIdAndUserId", "label": "JpaSavedQuizRepository.existsByQuizIdAndUserId()", "shape": "dot", "title": "boolean existsByQuizIdAndUserId(UUID quizId, UUID userId);"}, {"color": "#22c55e", "id": "JpaSavedQuizRepository.findAllByQuizId", "label": "JpaSavedQuizRepository.findAllByQuizId()", "shape": "dot", "title": "List\u003cUserSavedQuiz\u003e findAllByQuizId(UUID quizId);"}, {"color": "#3b82f6", "id": "JpaUserCredentialRepository", "label": "Class: JpaUserCredentialRepository", "shape": "dot", "title": "@Repository\npublic interface JpaUserCredentialRepository extends JpaRepository\u003cUserCredential, UUID\u003e {\n\n    UserCredential findByUserId(UUID userId);\n\n}"}, {"color": "#22c55e", "id": "JpaUserCredentialRepository.findByUserId", "label": "JpaUserCredentialRepository.findByUserId()", "shape": "dot", "title": "UserCredential findByUserId(UUID userId);"}, {"color": "#3b82f6", "id": "JpaUserRepository", "label": "Class: JpaUserRepository", "shape": "dot", "title": "@Repository\npublic interface JpaUserRepository extends JpaRepository\u003cUser, UUID\u003e {\n\n    Optional\u003cUser\u003e findByUsername(String username);\n\n    List\u003cUser\u003e findAllByIdIn(List\u003cUUID\u003e userIds);\n\n    Optional\u003cUser\u003e findByEmail(String email);\n}"}, {"color": "#22c55e", "id": "JpaUserRepository.findByUsername", "label": "JpaUserRepository.findByUsername()", "shape": "dot", "title": "Optional\u003cUser\u003e findByUsername(String username);"}, {"color": "#22c55e", "id": "JpaUserRepository.findAllByIdIn", "label": "JpaUserRepository.findAllByIdIn()", "shape": "dot", "title": "List\u003cUser\u003e findAllByIdIn(List\u003cUUID\u003e userIds);"}, {"color": "#22c55e", "id": "JpaUserRepository.findByEmail", "label": "JpaUserRepository.findByEmail()", "shape": "dot", "title": "Optional\u003cUser\u003e findByEmail(String email);"}, {"color": "#3b82f6", "id": "QuestionRepositoryImpl", "label": "Class: QuestionRepositoryImpl", "shape": "dot", "title": "@Repository\npublic class QuestionRepositoryImpl implements QuestionRepository {\n\n    private final JpaQuestionRepository repository;\n\n    public QuestionRepositoryImpl(JpaQuestionRepository repository) {\n        this.repository = repository;\n    }\n\n    @Override\n    public Question save(Question question) {\n        return repository.save(question);\n    }\n\n    @Override\n    @Transactional(readOnly = true)\n    public Optional\u003cQuestion\u003e findById(String id) {\n        return repository.findById(UUID.fromString(id));\n    }\n\n    @Override\n    @Transactional(readOnly = true)\n    public List\u003cQuestion\u003e findByQuizId(String quizId) {\n        return repository.findByQuizId(UUID.fromString(quizId));\n    }\n\n    @Override\n    public void saveAll(List\u003cQuestion\u003e questions) {\n        repository.saveAll(questions);\n    }\n\n    @Override\n    public void deleteAll(List\u003cQuestion\u003e questions) {\n        repository.deleteAll(questions);\n    }\n\n    @Override\n    public Integer countByQuizId(String quizId) {\n        return repository.countByQuizId(UUID.fromString(quizId));\n    }\n}"}, {"color": "#22c55e", "id": "QuestionRepositoryImpl.save", "label": "QuestionRepositoryImpl.save()", "shape": "dot", "title": "@Override\n    public Question save(Question question) {\n        return repository.save(question);\n    }"}, {"color": "#22c55e", "id": "QuestionRepositoryImpl.findById", "label": "QuestionRepositoryImpl.findById()", "shape": "dot", "title": "@Override\n    @Transactional(readOnly = true)\n    public Optional\u003cQuestion\u003e findById(String id) {\n        return repository.findById(UUID.fromString(id));\n    }"}, {"color": "#22c55e", "id": "QuestionRepositoryImpl.findByQuizId", "label": "QuestionRepositoryImpl.findByQuizId()", "shape": "dot", "title": "@Override\n    @Transactional(readOnly = true)\n    public List\u003cQuestion\u003e findByQuizId(String quizId) {\n        return repository.findByQuizId(UUID.fromString(quizId));\n    }"}, {"color": "#22c55e", "id": "QuestionRepositoryImpl.saveAll", "label": "QuestionRepositoryImpl.saveAll()", "shape": "dot", "title": "@Override\n    public void saveAll(List\u003cQuestion\u003e questions) {\n        repository.saveAll(questions);\n    }"}, {"color": "#22c55e", "id": "QuestionRepositoryImpl.deleteAll", "label": "QuestionRepositoryImpl.deleteAll()", "shape": "dot", "title": "@Override\n    public void deleteAll(List\u003cQuestion\u003e questions) {\n        repository.deleteAll(questions);\n    }"}, {"color": "#22c55e", "id": "QuestionRepositoryImpl.countByQuizId", "label": "QuestionRepositoryImpl.countByQuizId()", "shape": "dot", "title": "@Override\n    public Integer countByQuizId(String quizId) {\n        return repository.countByQuizId(UUID.fromString(quizId));\n    }"}, {"color": "#3b82f6", "id": "QuizAnswerRepositoryImpl", "label": "Class: QuizAnswerRepositoryImpl", "shape": "dot", "title": "@Repository\npublic class QuizAnswerRepositoryImpl implements QuizAnswerRepository {\n\n    private final JpaQuizAnswerRepository repository;\n\n    public QuizAnswerRepositoryImpl(JpaQuizAnswerRepository repository) {\n        this.repository = repository;\n    }\n\n    @Override\n    public QuizAnswer save(QuizAnswer answer) {\n        return repository.save(answer);\n    }\n\n    @Override\n    public void saveAll(List\u003cQuizAnswer\u003e answers) {\n        repository.saveAll(answers);\n    }\n\n    @Override\n    public Optional\u003cQuizAnswer\u003e findById(String id) {\n        return repository.findById(UUID.fromString(id));\n    }\n\n    @Override\n    public List\u003cQuizAnswer\u003e findByQuizAttemptId(String attemptId) {\n        return repository.findByQuizAttemptId(UUID.fromString(attemptId));\n    }\n\n    @Override\n    public void delete(QuizAnswer oldAnswer) {\n        repository.delete(oldAnswer);\n    }\n}"}, {"color": "#22c55e", "id": "QuizAnswerRepositoryImpl.save", "label": "QuizAnswerRepositoryImpl.save()", "shape": "dot", "title": "@Override\n    public QuizAnswer save(QuizAnswer answer) {\n        return repository.save(answer);\n    }"}, {"color": "#22c55e", "id": "QuizAnswerRepositoryImpl.saveAll", "label": "QuizAnswerRepositoryImpl.saveAll()", "shape": "dot", "title": "@Override\n    public void saveAll(List\u003cQuizAnswer\u003e answers) {\n        repository.saveAll(answers);\n    }"}, {"color": "#22c55e", "id": "QuizAnswerRepositoryImpl.findById", "label": "QuizAnswerRepositoryImpl.findById()", "shape": "dot", "title": "@Override\n    public Optional\u003cQuizAnswer\u003e findById(String id) {\n        return repository.findById(UUID.fromString(id));\n    }"}, {"color": "#22c55e", "id": "QuizAnswerRepositoryImpl.findByQuizAttemptId", "label": "QuizAnswerRepositoryImpl.findByQuizAttemptId()", "shape": "dot", "title": "@Override\n    public List\u003cQuizAnswer\u003e findByQuizAttemptId(String attemptId) {\n        return repository.findByQuizAttemptId(UUID.fromString(attemptId));\n    }"}, {"color": "#22c55e", "id": "QuizAnswerRepositoryImpl.delete", "label": "QuizAnswerRepositoryImpl.delete()", "shape": "dot", "title": "@Override\n    public void delete(QuizAnswer oldAnswer) {\n        repository.delete(oldAnswer);\n    }"}, {"color": "#3b82f6", "id": "QuizAttemptRepositoryImpl", "label": "Class: QuizAttemptRepositoryImpl", "shape": "dot", "title": "@Repository\npublic class QuizAttemptRepositoryImpl implements QuizAttemptRepository {\n\n    private final JpaQuizAttemptRepository jpaQuizAttemptRepository;\n\n    public QuizAttemptRepositoryImpl(JpaQuizAttemptRepository jpaQuizAttemptRepository) {\n        this.jpaQuizAttemptRepository = jpaQuizAttemptRepository;\n    }\n\n    @Override\n    public QuizAttempt save(QuizAttempt attempt) {\n        return jpaQuizAttemptRepository.save(attempt);\n    }\n\n    @Override\n    public Optional\u003cQuizAttempt\u003e findById(String id) {\n        return jpaQuizAttemptRepository.findById(UUID.fromString(id));\n    }\n\n    @Override\n    public List\u003cQuizAttempt\u003e findAll() {\n        return jpaQuizAttemptRepository.findAll();\n    }\n\n    @Override\n    public List\u003cQuizAttempt\u003e findByUserId(UUID id) {\n        return jpaQuizAttemptRepository.findByUserId(id);\n    }\n\n    @Override\n    public List\u003cQuizAttempt\u003e findByQuizId(String id) {\n        return jpaQuizAttemptRepository.findByQuizId(UUID.fromString(id));\n    }\n}"}, {"color": "#22c55e", "id": "QuizAttemptRepositoryImpl.save", "label": "QuizAttemptRepositoryImpl.save()", "shape": "dot", "title": "@Override\n    public QuizAttempt save(QuizAttempt attempt) {\n        return jpaQuizAttemptRepository.save(attempt);\n    }"}, {"color": "#22c55e", "id": "QuizAttemptRepositoryImpl.findById", "label": "QuizAttemptRepositoryImpl.findById()", "shape": "dot", "title": "@Override\n    public Optional\u003cQuizAttempt\u003e findById(String id) {\n        return jpaQuizAttemptRepository.findById(UUID.fromString(id));\n    }"}, {"color": "#22c55e", "id": "QuizAttemptRepositoryImpl.findAll", "label": "QuizAttemptRepositoryImpl.findAll()", "shape": "dot", "title": "@Override\n    public List\u003cQuizAttempt\u003e findAll() {\n        return jpaQuizAttemptRepository.findAll();\n    }"}, {"color": "#22c55e", "id": "QuizAttemptRepositoryImpl.findByUserId", "label": "QuizAttemptRepositoryImpl.findByUserId()", "shape": "dot", "title": "@Override\n    public List\u003cQuizAttempt\u003e findByUserId(UUID id) {\n        return jpaQuizAttemptRepository.findByUserId(id);\n    }"}, {"color": "#22c55e", "id": "QuizAttemptRepositoryImpl.findByQuizId", "label": "QuizAttemptRepositoryImpl.findByQuizId()", "shape": "dot", "title": "@Override\n    public List\u003cQuizAttempt\u003e findByQuizId(String id) {\n        return jpaQuizAttemptRepository.findByQuizId(UUID.fromString(id));\n    }"}, {"color": "#3b82f6", "id": "QuizRepositoryImpl", "label": "Class: QuizRepositoryImpl", "shape": "dot", "title": "@Repository\npublic class QuizRepositoryImpl implements QuizRepository {\n\n    private final JpaQuizRepository repository;\n\n    public QuizRepositoryImpl(JpaQuizRepository repository) {\n        this.repository = repository;\n    }\n\n    @Override\n    public void save(Quiz quiz) {\n        repository.save(quiz);\n    }\n\n    @Override\n    public Optional\u003cQuiz\u003e findById(String id) {\n        return repository.findById(UUID.fromString(id));\n    }\n\n    @Override\n    public List\u003cQuiz\u003e findAll() {\n        return repository.findAll();\n    }\n\n    @Override\n    public List\u003cQuiz\u003e findByUserId(UUID id) {\n        return repository.findByAuthorId(id);\n    }\n\n    @Override\n    public List\u003cQuiz\u003e findByIdIn(Set\u003cString\u003e quizId) {\n        return repository.findByIdIn(quizId.stream()\n                .map(UUID::fromString)\n                .toList());\n    }\n\n    @Override\n    public List\u003cQuiz\u003e findAllPublic() {\n        return repository.findByStatus(QuizStatus.PUBLIC);\n    }\n}"}, {"color": "#22c55e", "id": "QuizRepositoryImpl.save", "label": "QuizRepositoryImpl.save()", "shape": "dot", "title": "@Override\n    public void save(Quiz quiz) {\n        repository.save(quiz);\n    }"}, {"color": "#22c55e", "id": "QuizRepositoryImpl.findById", "label": "QuizRepositoryImpl.findById()", "shape": "dot", "title": "@Override\n    public Optional\u003cQuiz\u003e findById(String id) {\n        return repository.findById(UUID.fromString(id));\n    }"}, {"color": "#22c55e", "id": "QuizRepositoryImpl.findAll", "label": "QuizRepositoryImpl.findAll()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e findAll() {\n        return repository.findAll();\n    }"}, {"color": "#22c55e", "id": "QuizRepositoryImpl.findByUserId", "label": "QuizRepositoryImpl.findByUserId()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e findByUserId(UUID id) {\n        return repository.findByAuthorId(id);\n    }"}, {"color": "#22c55e", "id": "QuizRepositoryImpl.findByIdIn", "label": "QuizRepositoryImpl.findByIdIn()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e findByIdIn(Set\u003cString\u003e quizId) {\n        return repository.findByIdIn(quizId.stream()\n                .map(UUID::fromString)\n                .toList());\n    }"}, {"color": "#22c55e", "id": "QuizRepositoryImpl.findAllPublic", "label": "QuizRepositoryImpl.findAllPublic()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e findAllPublic() {\n        return repository.findByStatus(QuizStatus.PUBLIC);\n    }"}, {"color": "#3b82f6", "id": "ResourceRepositoryImpl", "label": "Class: ResourceRepositoryImpl", "shape": "dot", "title": "@Repository\npublic class ResourceRepositoryImpl implements ResourceRepository {\n\n    private final JpaResourceRepository repository;\n\n    public ResourceRepositoryImpl(JpaResourceRepository repository) {\n        this.repository = repository;\n    }\n\n    @Override\n    public Resource save(Resource resource) {\n        return repository.save(resource);\n    }\n\n    @Override\n    public Resource findById(String id) {\n        return repository.findById(UUID.fromString(id)).orElse(null);\n    }\n}"}, {"color": "#22c55e", "id": "ResourceRepositoryImpl.save", "label": "ResourceRepositoryImpl.save()", "shape": "dot", "title": "@Override\n    public Resource save(Resource resource) {\n        return repository.save(resource);\n    }"}, {"color": "#22c55e", "id": "ResourceRepositoryImpl.findById", "label": "ResourceRepositoryImpl.findById()", "shape": "dot", "title": "@Override\n    public Resource findById(String id) {\n        return repository.findById(UUID.fromString(id)).orElse(null);\n    }"}, {"color": "#3b82f6", "id": "SavedQuizRepositoryImpl", "label": "Class: SavedQuizRepositoryImpl", "shape": "dot", "title": "@Repository\npublic class SavedQuizRepositoryImpl implements SavedQuizRepository {\n\n    private final JpaSavedQuizRepository jpaSavedQuizRepository;\n\n    public SavedQuizRepositoryImpl(JpaSavedQuizRepository jpaSavedQuizRepository) {\n        this.jpaSavedQuizRepository = jpaSavedQuizRepository;\n    }\n\n    @Override\n    public void saveQuiz(String quizId, String userId) {\n        UserSavedQuiz savedQuiz = new UserSavedQuiz();\n        savedQuiz.setSavedAt(LocalDateTime.now());\n        savedQuiz.setQuizId(UUID.fromString(quizId));\n        savedQuiz.setUserId(UUID.fromString(userId));\n        jpaSavedQuizRepository.save(savedQuiz);\n    }\n\n    @Override\n    public List\u003cUserSavedQuiz\u003e findAllByUserId(String userId) {\n        return jpaSavedQuizRepository.findByUserId(UUID.fromString(userId));\n    }\n\n    @Override\n    public void deleteByQuizIdAndUserId(String quizId, String userId) {\n        jpaSavedQuizRepository.deleteByQuizIdAndUserId(UUID.fromString(quizId), UUID.fromString(userId));\n    }\n\n    @Override\n    public boolean existsByQuizIdAndUserId(String quizId, String userId) {\n        return jpaSavedQuizRepository.existsByQuizIdAndUserId(UUID.fromString(quizId), UUID.fromString(userId));\n    }\n\n    @Override\n    public List\u003cUserSavedQuiz\u003e findAllByQuizId(String quizId) {\n        return jpaSavedQuizRepository.findAllByQuizId(UUID.fromString(quizId));\n    }\n\n    @Override\n    public void update(UserSavedQuiz savedQuiz) {\n        jpaSavedQuizRepository.save(savedQuiz);\n    }\n}"}, {"color": "#22c55e", "id": "SavedQuizRepositoryImpl.saveQuiz", "label": "SavedQuizRepositoryImpl.saveQuiz()", "shape": "dot", "title": "@Override\n    public void saveQuiz(String quizId, String userId) {\n        UserSavedQuiz savedQuiz = new UserSavedQuiz();\n        savedQuiz.setSavedAt(LocalDateTime.now());\n        savedQuiz.setQuizId(UUID.fromString(quizId));\n        savedQuiz.setUserId(UUID.fromString(userId));\n        jpaSavedQuizRepository.save(savedQuiz);\n    }"}, {"color": "#22c55e", "id": "SavedQuizRepositoryImpl.findAllByUserId", "label": "SavedQuizRepositoryImpl.findAllByUserId()", "shape": "dot", "title": "@Override\n    public List\u003cUserSavedQuiz\u003e findAllByUserId(String userId) {\n        return jpaSavedQuizRepository.findByUserId(UUID.fromString(userId));\n    }"}, {"color": "#22c55e", "id": "SavedQuizRepositoryImpl.deleteByQuizIdAndUserId", "label": "SavedQuizRepositoryImpl.deleteByQuizIdAndUserId()", "shape": "dot", "title": "@Override\n    public void deleteByQuizIdAndUserId(String quizId, String userId) {\n        jpaSavedQuizRepository.deleteByQuizIdAndUserId(UUID.fromString(quizId), UUID.fromString(userId));\n    }"}, {"color": "#22c55e", "id": "SavedQuizRepositoryImpl.existsByQuizIdAndUserId", "label": "SavedQuizRepositoryImpl.existsByQuizIdAndUserId()", "shape": "dot", "title": "@Override\n    public boolean existsByQuizIdAndUserId(String quizId, String userId) {\n        return jpaSavedQuizRepository.existsByQuizIdAndUserId(UUID.fromString(quizId), UUID.fromString(userId));\n    }"}, {"color": "#22c55e", "id": "SavedQuizRepositoryImpl.findAllByQuizId", "label": "SavedQuizRepositoryImpl.findAllByQuizId()", "shape": "dot", "title": "@Override\n    public List\u003cUserSavedQuiz\u003e findAllByQuizId(String quizId) {\n        return jpaSavedQuizRepository.findAllByQuizId(UUID.fromString(quizId));\n    }"}, {"color": "#22c55e", "id": "SavedQuizRepositoryImpl.update", "label": "SavedQuizRepositoryImpl.update()", "shape": "dot", "title": "@Override\n    public void update(UserSavedQuiz savedQuiz) {\n        jpaSavedQuizRepository.save(savedQuiz);\n    }"}, {"color": "#3b82f6", "id": "UserRepositoryImpl", "label": "Class: UserRepositoryImpl", "shape": "dot", "title": "@Repository\npublic class UserRepositoryImpl implements UserRepository {\n\n    private final JpaUserRepository repository;\n\n    private final JpaUserCredentialRepository userCredentialRepository;\n\n    public UserRepositoryImpl(JpaUserRepository repository, JpaUserCredentialRepository userCredentialRepository) {\n        this.repository = repository;\n        this.userCredentialRepository = userCredentialRepository;\n    }\n\n    @Override\n    public Optional\u003cUser\u003e getUserById(String userId) {\n        return repository.findById(UUID.fromString(userId));\n    }\n\n    @Override\n    public Optional\u003cUser\u003e getByUsername(String username) {\n        return repository.findByUsername(username);\n    }\n\n    @Override\n    public Optional\u003cUser\u003e getByUsernameForAuth(String username) {\n        Optional\u003cUser\u003e user = repository.findByUsername(username);\n        if (user.isPresent()) {\n            UserCredential credentials = userCredentialRepository.findByUserId(user.get().getId());\n            user.get().setCredentials(credentials);\n            return user;\n        }\n        return Optional.empty();\n    }\n\n    @Override\n    public User persist(User user) {\n        User userRes = repository.save(user);\n        UserCredential credentials = user.getCredentials();\n        credentials.setUserId(userRes.getId());\n        userCredentialRepository.save(credentials);\n        return userRes;\n    }\n\n    @Override\n    public List\u003cUser\u003e getByUserIdList(List\u003cUUID\u003e studentIds) {\n        return repository.findAllById(studentIds);\n    }\n\n    @Override\n    public List\u003cBasicUserDto\u003e basicSearch(String keyword) {\n        return List.of();\n    }\n\n    @Override\n    public Optional\u003cUser\u003e getByEmail(String email) {\n        return repository.findByEmail(email);\n    }\n}"}, {"color": "#22c55e", "id": "UserRepositoryImpl.getUserById", "label": "UserRepositoryImpl.getUserById()", "shape": "dot", "title": "@Override\n    public Optional\u003cUser\u003e getUserById(String userId) {\n        return repository.findById(UUID.fromString(userId));\n    }"}, {"color": "#22c55e", "id": "UserRepositoryImpl.getByUsername", "label": "UserRepositoryImpl.getByUsername()", "shape": "dot", "title": "@Override\n    public Optional\u003cUser\u003e getByUsername(String username) {\n        return repository.findByUsername(username);\n    }"}, {"color": "#22c55e", "id": "UserRepositoryImpl.getByUsernameForAuth", "label": "UserRepositoryImpl.getByUsernameForAuth()", "shape": "dot", "title": "@Override\n    public Optional\u003cUser\u003e getByUsernameForAuth(String username) {\n        Optional\u003cUser\u003e user = repository.findByUsername(username);\n        if (user.isPresent()) {\n            UserCredential credentials = userCredentialRepository.findByUserId(user.get().getId());\n            user.get().setCredentials(credentials);\n            return user;\n        }\n        return Optional.empty();\n    }"}, {"color": "#22c55e", "id": "UserRepositoryImpl.persist", "label": "UserRepositoryImpl.persist()", "shape": "dot", "title": "@Override\n    public User persist(User user) {\n        User userRes = repository.save(user);\n        UserCredential credentials = user.getCredentials();\n        credentials.setUserId(userRes.getId());\n        userCredentialRepository.save(credentials);\n        return userRes;\n    }"}, {"color": "#22c55e", "id": "UserRepositoryImpl.getByUserIdList", "label": "UserRepositoryImpl.getByUserIdList()", "shape": "dot", "title": "@Override\n    public List\u003cUser\u003e getByUserIdList(List\u003cUUID\u003e studentIds) {\n        return repository.findAllById(studentIds);\n    }"}, {"color": "#22c55e", "id": "UserRepositoryImpl.basicSearch", "label": "UserRepositoryImpl.basicSearch()", "shape": "dot", "title": "@Override\n    public List\u003cBasicUserDto\u003e basicSearch(String keyword) {\n        return List.of();\n    }"}, {"color": "#22c55e", "id": "UserRepositoryImpl.getByEmail", "label": "UserRepositoryImpl.getByEmail()", "shape": "dot", "title": "@Override\n    public Optional\u003cUser\u003e getByEmail(String email) {\n        return repository.findByEmail(email);\n    }"}, {"color": "#3b82f6", "id": "AuthServiceImpl", "label": "Class: AuthServiceImpl", "shape": "dot", "title": "@Service\n@Slf4j\npublic class AuthServiceImpl implements AuthService {\n\n    private final AuthenticationManager authenticationManager;\n\n    private final JwtProvider jwtProvider;\n\n    private final UserRepository userRepository;\n\n    private final PasswordEncoder passwordEncoder;\n\n    private final UserMapper userMapper;\n\n    public AuthServiceImpl(AuthenticationManager authenticationManager,\n                           JwtProvider jwtProvider,\n                           UserRepository userRepository,\n                           PasswordEncoder passwordEncoder,\n                           UserMapper userMapper) {\n        this.authenticationManager = authenticationManager;\n        this.jwtProvider = jwtProvider;\n        this.userRepository = userRepository;\n        this.passwordEncoder = passwordEncoder;\n        this.userMapper = userMapper;\n    }\n\n    @Override\n    public AuthRegisterResponse register(AuthRegisterRequest request) {\n        Optional\u003cUser\u003e user = userRepository.getByUsername(request.getUsername());\n        if (user.isPresent()) {\n            throw new RuntimeException(\"Username already exists\");\n        }\n\n        User userData = userMapper.authRegisterRequestToUser(request);\n        userData.setRole(UserRole.USER);\n        UserCredential credentials = UserCredential\n                .builder()\n                .passwordHash(passwordEncoder.encode(request.getPassword()))\n                .userId(userData.getId())\n                .build();\n        userData.setCredentials(credentials);\n        userRepository.persist(userData);\n        return new AuthRegisterResponse(userData.getId().toString());\n    }\n\n    @Override\n    public AuthProfileResponse getAuthProfile(String id) {\n        User user = userRepository.getUserById(id).orElseThrow(() -\u003e new RuntimeException(\"User not found\"));\n\n        return userMapper.userToAuthProfileResponse(user);\n    }\n\n    @Override\n    public AuthLoginResponse login(AuthLoginRequest request) {\n        try {\n            UsernamePasswordAuthenticationToken authenticationToken = new UsernamePasswordAuthenticationToken(\n                    request.getUsername(),\n                    request.getPassword()\n            );\n            Authentication authentication = authenticationManager.authenticate(authenticationToken);\n\n            return new AuthLoginResponse(\n                    jwtProvider.generateAccessToken(authentication),\n                    jwtProvider.generateRefreshToken(authentication));\n        } catch (Exception ex) {\n            log.error(\"Login failed for user {}: {}\", request.getUsername(), ex.getMessage());\n            throw new BusinessException(ErrorConstant.USERNAME_PASSWORD_WRONG);\n        }\n    }\n\n}"}, {"color": "#22c55e", "id": "AuthServiceImpl.register", "label": "AuthServiceImpl.register()", "shape": "dot", "title": "@Override\n    public AuthRegisterResponse register(AuthRegisterRequest request) {\n        Optional\u003cUser\u003e user = userRepository.getByUsername(request.getUsername());\n        if (user.isPresent()) {\n            throw new RuntimeException(\"Username already exists\");\n        }\n\n        User userData = userMapper.authRegisterRequestToUser(request);\n        userData.setRole(UserRole.USER);\n        UserCredential credentials = UserCredential\n                .builder()\n                .passwordHash(passwordEncoder.encode(request.getPassword()))\n                .userId(userData.getId())\n                .build();\n        userData.setCredentials(credentials);\n        userRepository.persist(userData);\n        return new AuthRegisterResponse(userData.getId().toString());\n    }"}, {"color": "#22c55e", "id": "AuthServiceImpl.getAuthProfile", "label": "AuthServiceImpl.getAuthProfile()", "shape": "dot", "title": "@Override\n    public AuthProfileResponse getAuthProfile(String id) {\n        User user = userRepository.getUserById(id).orElseThrow(() -\u003e new RuntimeException(\"User not found\"));\n\n        return userMapper.userToAuthProfileResponse(user);\n    }"}, {"color": "#22c55e", "id": "AuthServiceImpl.login", "label": "AuthServiceImpl.login()", "shape": "dot", "title": "@Override\n    public AuthLoginResponse login(AuthLoginRequest request) {\n        try {\n            UsernamePasswordAuthenticationToken authenticationToken = new UsernamePasswordAuthenticationToken(\n                    request.getUsername(),\n                    request.getPassword()\n            );\n            Authentication authentication = authenticationManager.authenticate(authenticationToken);\n\n            return new AuthLoginResponse(\n                    jwtProvider.generateAccessToken(authentication),\n                    jwtProvider.generateRefreshToken(authentication));\n        } catch (Exception ex) {\n            log.error(\"Login failed for user {}: {}\", request.getUsername(), ex.getMessage());\n            throw new BusinessException(ErrorConstant.USERNAME_PASSWORD_WRONG);\n        }\n    }"}, {"color": "#3b82f6", "id": "QuestionServiceImpl", "label": "Class: QuestionServiceImpl", "shape": "dot", "title": "@Service\npublic class QuestionServiceImpl implements QuestionService {\n\n    private final QuestionRepository questionRepository;\n\n    public QuestionServiceImpl(QuestionRepository questionRepository) {\n        this.questionRepository = questionRepository;\n    }\n\n    @Override\n    public BaseCreateUpdateResponse createQuestion(QuestionDto request, UUID authorId) {\n        return null;\n    }\n\n    @Override\n    public BaseCreateUpdateResponse updateQuestion(QuestionDto request) {\n        return null;\n    }\n\n    @Override\n    public List\u003cQuestion\u003e getAllQuestions() {\n        return List.of();\n    }\n\n    @Override\n    public List\u003cQuestion\u003e getMyQuestions(UUID id) {\n        return List.of();\n    }\n\n    @Override\n    public Question getById(String id) {\n        return null;\n    }\n\n    @Override\n    public void deleteQuestion(String id) {\n\n    }\n}"}, {"color": "#22c55e", "id": "QuestionServiceImpl.createQuestion", "label": "QuestionServiceImpl.createQuestion()", "shape": "dot", "title": "@Override\n    public BaseCreateUpdateResponse createQuestion(QuestionDto request, UUID authorId) {\n        return null;\n    }"}, {"color": "#22c55e", "id": "QuestionServiceImpl.updateQuestion", "label": "QuestionServiceImpl.updateQuestion()", "shape": "dot", "title": "@Override\n    public BaseCreateUpdateResponse updateQuestion(QuestionDto request) {\n        return null;\n    }"}, {"color": "#22c55e", "id": "QuestionServiceImpl.getAllQuestions", "label": "QuestionServiceImpl.getAllQuestions()", "shape": "dot", "title": "@Override\n    public List\u003cQuestion\u003e getAllQuestions() {\n        return List.of();\n    }"}, {"color": "#22c55e", "id": "QuestionServiceImpl.getMyQuestions", "label": "QuestionServiceImpl.getMyQuestions()", "shape": "dot", "title": "@Override\n    public List\u003cQuestion\u003e getMyQuestions(UUID id) {\n        return List.of();\n    }"}, {"color": "#22c55e", "id": "QuestionServiceImpl.getById", "label": "QuestionServiceImpl.getById()", "shape": "dot", "title": "@Override\n    public Question getById(String id) {\n        return null;\n    }"}, {"color": "#22c55e", "id": "QuestionServiceImpl.deleteQuestion", "label": "QuestionServiceImpl.deleteQuestion()", "shape": "dot", "title": "@Override\n    public void deleteQuestion(String id) {\n\n    }"}, {"color": "#3b82f6", "id": "QuizServiceImpl", "label": "Class: QuizServiceImpl", "shape": "dot", "title": "@Service\n@Slf4j\npublic class QuizServiceImpl implements QuizService {\n\n    private final QuizMapper quizMapper;\n\n    private final QuestionMapper questionMapper;\n\n    private final QuizRepository quizRepository;\n\n    private final QuestionRepository questionRepository;\n\n    private final QuizAttemptRepository quizAttemptRepository;\n\n    private final QuizAnswerRepository quizAnswerRepository;\n\n    private final UserRepository userRepository;\n\n    private final SavedQuizRepository savedQuizRepository;\n\n    private final PronunciationServiceImpl pronunciationService;\n\n    private final ResourceService resourceService;\n\n    public QuizServiceImpl(QuizMapper quizMapper,\n                           QuestionMapper questionMapper,\n                           QuizRepository quizRepository,\n                           QuestionRepository questionRepository,\n                           QuizAttemptRepository quizAttemptRepository,\n                           QuizAnswerRepository quizAnswerRepository,\n                           UserRepository userRepository,\n                           SavedQuizRepository savedQuizRepository,\n                           PronunciationServiceImpl pronunciationService,\n                           ResourceService resourceService) {\n        this.quizMapper = quizMapper;\n        this.questionMapper = questionMapper;\n        this.quizRepository = quizRepository;\n        this.questionRepository = questionRepository;\n        this.quizAttemptRepository = quizAttemptRepository;\n        this.quizAnswerRepository = quizAnswerRepository;\n        this.userRepository = userRepository;\n        this.savedQuizRepository = savedQuizRepository;\n        this.pronunciationService = pronunciationService;\n        this.resourceService = resourceService;\n    }\n\n    @Override\n    public BaseCreateUpdateResponse createQuiz(CreateQuizDto request, UUID authorId) {\n        Quiz q = quizMapper.createQuizDtoToQuiz(request);\n        q.setAuthorId(authorId);\n        quizRepository.save(q);\n        return new BaseCreateUpdateResponse(q.getId().toString());\n    }\n\n    @Override\n    @Transactional(rollbackFor = Exception.class)\n    public BaseCreateUpdateResponse updateQuiz(CreateQuizDto request) {\n        if (request.getId() == null) {\n            throw new IllegalArgumentException(\"Quiz ID must be provided for update operation.\");\n        }\n        UUID quizId = UUID.fromString(request.getId());\n        Quiz existingQuiz = quizRepository.findById(request.getId())\n                .orElseThrow(() -\u003e new EntityNotFoundException(\"Quiz with ID \" + request.getId() + \" not found.\"));\n\n        quizMapper.updateQuizFromDto(request, existingQuiz);\n        existingQuiz.setUpdatedAt(LocalDateTime.now());\n        if (request.getIsPublic()) {\n            existingQuiz.setStatus(QuizStatus.PUBLIC);\n        } else {\n            existingQuiz.setStatus(QuizStatus.DRAFT);\n        }\n\n        List\u003cQuestion\u003e existingQuestions = questionRepository.findByQuizId(request.getId());\n        Map\u003cUUID, Question\u003e existingQuestionMap = existingQuestions.stream()\n                .collect(Collectors.toMap(Question::getId, q -\u003e q));\n\n        List\u003cQuestion\u003e questionsToSaveOrUpdate = new ArrayList\u003c\u003e();\n        Set\u003cUUID\u003e questionIdsInDto = request.getQuestions().stream()\n                .filter(qDto -\u003e qDto.getId() != null)\n                .map(qDto -\u003e UUID.fromString(qDto.getId()))\n                .collect(Collectors.toSet());\n\n        for (QuestionDto qDto : request.getQuestions()) {\n            if (qDto.getId() == null) {\n                Question newQuestion = questionMapper.questionDtoToQuestion(qDto);\n                newQuestion.setQuizId(quizId);\n                newQuestion.setCreatedAt(LocalDateTime.now());\n                newQuestion.setUpdatedAt(LocalDateTime.now());\n                if (!CollectionUtils.isEmpty(newQuestion.getOptions())) {\n                    for (QuestionOption option : newQuestion.getOptions()) {\n                        option.setId(UUID.randomUUID());\n                    }\n                }\n                questionsToSaveOrUpdate.add(newQuestion);\n            } else {\n                UUID qId = UUID.fromString(qDto.getId());\n                Question questionToUpdate = existingQuestionMap.get(qId);\n                if (questionToUpdate != null) {\n                    questionMapper.updateQuestionFromDto(qDto, questionToUpdate);\n                    questionToUpdate.setUpdatedAt(LocalDateTime.now());\n                    \n                    if (!CollectionUtils.isEmpty(questionToUpdate.getOptions())) {\n                        for (QuestionOption option : questionToUpdate.getOptions()) {\n                            if (option.getId() == null) {\n                                option.setId(UUID.randomUUID());\n                            }\n                        }\n                    }\n                    questionsToSaveOrUpdate.add(questionToUpdate);\n                }\n            }\n        }\n\n        List\u003cQuestion\u003e questionsToDelete = existingQuestions.stream()\n                .filter(eq -\u003e !questionIdsInDto.contains(eq.getId()))\n                .collect(Collectors.toList());\n\n        if (!questionsToDelete.isEmpty()) {\n            questionRepository.deleteAll(questionsToDelete);\n        }\n        if (!questionsToSaveOrUpdate.isEmpty()) {\n            questionRepository.saveAll(questionsToSaveOrUpdate);\n        }\n\n        existingQuiz.setQuestionCount(questionRepository.countByQuizId(quizId.toString()));\n\n        quizRepository.save(existingQuiz);\n        return new BaseCreateUpdateResponse(existingQuiz.getId().toString());\n    }\n\n    @Override\n    public List\u003cQuiz\u003e getAllPublicQuizzes() {\n        List\u003cQuiz\u003e quizzes = quizRepository.findAllPublic();\n        getQuizAuthor(quizzes);\n        return quizzes;\n    }\n\n    @Override\n    public List\u003cQuiz\u003e getMyQuizzes(UUID id) {\n        List\u003cQuiz\u003e quizzes = quizRepository.findByUserId(id);\n        getQuizAuthor(quizzes);\n        return quizzes;\n    }\n\n    @Override\n    public Quiz getById(String id) {\n        Quiz quiz = quizRepository.findById(id)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n        Set\u003cQuestion\u003e questions = new HashSet\u003c\u003e(questionRepository.findByQuizId(id));\n        quiz.setQuestions(questions);\n        getQuizAuthor(Collections.singletonList(quiz));\n        return quiz;\n    }\n\n    @Override\n    public void deleteQuiz(String id) {\n        Quiz quiz = quizRepository.findById(id)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n        quiz.setDeletedAt(LocalDateTime.now());\n        quizRepository.save(quiz);\n    }\n\n    @Override\n    @Transactional\n    public BaseCreateUpdateResponse startQuiz(String quizId, UUID userId) {\n        quizRepository.findById(quizId)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n\n        QuizAttempt quizAttempt = new QuizAttempt();\n        quizAttempt.setQuizId(UUID.fromString(quizId));\n        quizAttempt.setUserId(userId);\n        quizAttempt.setScore(BigDecimal.ZERO);\n        quizAttempt.setCorrectAnswers(0);\n        quizAttempt.setTimeSpent(0L);\n        quizAttempt.setCompletedAt(null);\n        quizAttempt.setPassed(false);\n\n        QuizAttempt savedAttempt = quizAttemptRepository.save(quizAttempt);\n        return new BaseCreateUpdateResponse(savedAttempt.getId().toString());\n    }\n\n    @Override\n    @Transactional\n    public BaseCreateUpdateResponse submitQuizQuestion(String attemptId, SubmitAnswerRequest request, UUID id) {\n        UUID questionId = UUID.fromString(request.getQuestionId());\n\n        QuizAttempt quizAttempt = quizAttemptRepository.findById(attemptId)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_ATTEMPT_NOT_FOUND));\n\n        if (quizAttempt.getCompletedAt() != null) {\n            throw new BusinessException(ErrorConstant.QUIZ_ATTEMPT_SUBMITTED);\n        }\n\n        Quiz quiz = quizRepository.findById(quizAttempt.getQuizId().toString()).orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n\n        if (quiz.getTimeLimit() != null \u0026\u0026 quizAttempt.getCreatedAt() != null) {\n            LocalDateTime start = quizAttempt.getCreatedAt();\n            LocalDateTime end = LocalDateTime.now();\n            long timeSpent = Duration.between(start, end).toMinutes();\n            if (timeSpent \u003e quiz.getTimeLimit()) {\n                quizAttempt.setTimeSpent(timeSpent);\n                quizAttempt.setCompletedAt(quizAttempt.getCreatedAt().plusMinutes(timeSpent));\n                quizAttemptRepository.save(quizAttempt);\n                throw new BusinessException(ErrorConstant.QUIZ_TIME_LIMIT_EXCEEDED);\n            }\n        }\n\n        Question question = questionRepository.findById(request.getQuestionId())\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUESTION_NOT_FOUND));\n\n        if (!Objects.equals(question.getQuizId(), quizAttempt.getQuizId())) {\n            throw new BusinessException(ErrorConstant.QUESTION_DOES_NOT_BELONG_TO_QUIZ);\n        }\n\n        QuizAnswer quizAnswer = new QuizAnswer();\n        quizAnswer.setQuestionId(questionId);\n\n        if (QuestionType.MULTIPLE_CHOICE.name().equals(question.getType()) \u0026\u0026 !CollectionUtils.isEmpty(question.getOptions())) {\n            List\u003cQuestionOption\u003e options = question.getOptions().stream()\n                    .filter(option -\u003e option.getId() != null \u0026\u0026 request.getSelectedOptions().contains(option.getId().toString()))\n                    .collect(Collectors.toList());\n            quizAnswer.setSelectedAnswers(options);\n        }\n        quizAnswer.setFillInBlanksAnswers(request.getFillInBlanksAnswers());\n        quizAnswer.setAnswerText(request.getAnswerText());\n        quizAnswer.setTimeTaken(request.getTimeTaken());\n        quizAnswer.setAudioUrl(request.getAudioUrl());\n\n        boolean isCorrect = false;\n        Integer scoreAchieved = 0;\n\n        switch (question.getType().toLowerCase()) {\n            case \"multiple_choice\":\n                List\u003cString\u003e userSelectedValues = request.getSelectedOptions() != null ?\n                        request.getSelectedOptions().stream()\n                                .filter(Objects::nonNull)\n                                .collect(Collectors.toList()) : new ArrayList\u003c\u003e();\n\n                List\u003cString\u003e correctOptionValues = question.getCorrectAnswer() != null ?\n                        question.getOptions().stream().filter(QuestionOption::getIsCorrect).map(i -\u003e i.getId().toString()).sorted().toList() : new ArrayList\u003c\u003e();\n                userSelectedValues.sort(String::compareTo);\n\n                isCorrect = userSelectedValues.equals(correctOptionValues);\n                break;\n            case \"true_false\":\n                isCorrect = (request.getUserAnswerTrueFalse() != null \u0026\u0026\n                        request.getUserAnswerTrueFalse().equals(question.getTrueFalseAnswer()));\n                break;\n            case \"fill_in_the_blank\":\n                List\u003cString\u003e userFillInBlanks = request.getFillInBlanksAnswers() != null ?\n                        request.getFillInBlanksAnswers().stream()\n                                .filter(Objects::nonNull)\n                                .map(i -\u003e i.toLowerCase().trim())\n                                .collect(Collectors.toList()) : new ArrayList\u003c\u003e();\n\n                List\u003cString\u003e correctBlanks = question.getCorrectBlanks() != null ?\n                        question.getCorrectBlanks().stream()\n                                .filter(Objects::nonNull)\n                                .map(i -\u003e i.toLowerCase().trim())\n                                .collect(Collectors.toList()) : new ArrayList\u003c\u003e();\n\n                Collections.sort(userFillInBlanks);\n                Collections.sort(correctBlanks);\n\n                isCorrect = userFillInBlanks.equals(correctBlanks);\n                break;\n            case \"short_answer\":\n                isCorrect = (request.getAnswerText() != null \u0026\u0026\n                        question.getCorrectAnswer() != null \u0026\u0026\n                        !question.getCorrectAnswer().isEmpty() \u0026\u0026\n                        question.getCorrectAnswer().getFirst().equalsIgnoreCase(request.getAnswerText().trim()));\n                break;\n            case \"pronunciation\":\n                if (request.getAudioUrl() == null || request.getAudioUrl().isEmpty()) {\n                    break;\n                }\n                File audioFile = resourceService.downloadResourceFromUrl(request.getAudioUrl());\n                if (audioFile == null || !audioFile.exists()) {\n                    break;\n                }\n                String base64File = \"data:audio/ogg;;base64,\" + FileUtils.convertToBase64(audioFile);\n                if (base64File == null) {\n                    break;\n                }\n                try {\n                    PronunciationAccuracyResponseDto pronunAccuracy = pronunciationService.getAccuracy(\n                            PronunciationAccuracyRequestDto.builder()\n                                    .base64Audio(base64File)\n                                    .text(question.getPronunciationText())\n                                    .build()\n                    );\n                    isCorrect = pronunAccuracy.getPronunciationAccuracy() \u003e= question.getAcceptRate();\n                    quizAnswer.setAnswerText(JsonUtils.toJsonString(pronunAccuracy));\n                } catch (Exception e) {\n                    log.error(\"Error while checking pronunciation accuracy: {}\", e.getMessage());\n                }\n                break;\n\n            default:\n                System.err.println(\"Unknown question type: \" + question.getType());\n        }\n\n        if (isCorrect) {\n            scoreAchieved = question.getPoints() != null ? question.getPoints() : 0;\n        }\n\n        quizAnswer.setCorrect(isCorrect);\n        quizAnswer.setScoreAchieved(scoreAchieved);\n\n        List\u003cQuizAnswer\u003e currentAnswers = quizAnswerRepository.findByQuizAttemptId(attemptId);\n\n        for (int i = 0; i \u003c currentAnswers.size(); i++) {\n            if (currentAnswers.get(i).getQuestionId().equals(questionId)) {\n                QuizAnswer oldAnswer = currentAnswers.get(i);\n                quizAttempt.setScore(quizAttempt.getScore().subtract(BigDecimal.valueOf(oldAnswer.getScoreAchieved())));\n                if (oldAnswer.isCorrect()) {\n                    quizAttempt.setCorrectAnswers(quizAttempt.getCorrectAnswers() - 1);\n                }\n                quizAnswerRepository.delete(oldAnswer);\n                break;\n            }\n        }\n\n        quizAnswer.setQuizAttemptId(UUID.fromString(attemptId));\n        \n        quizAnswerRepository.save(quizAnswer);\n\n        quizAttempt.setScore(quizAttempt.getScore().add(BigDecimal.valueOf(scoreAchieved)));\n        if (isCorrect) {\n            quizAttempt.setCorrectAnswers(quizAttempt.getCorrectAnswers() + 1);\n        }\n\n        quizAttemptRepository.save(quizAttempt);\n\n        return new BaseCreateUpdateResponse(quizAnswer.getId().toString());\n    }\n\n    @Override\n    public List\u003cQuiz\u003e getMyQuizAttempts(String userId) {\n        List\u003cQuizAttempt\u003e attempts = quizAttemptRepository.findByUserId(UUID.fromString(userId));\n        if (CollectionUtils.isEmpty(attempts)) {\n            return Collections.emptyList();\n        }\n\n        Set\u003cString\u003e quizId = attempts.stream()\n                .map(QuizAttempt::getQuizId)\n                .map(UUID::toString)\n                .collect(Collectors.toSet());\n\n        List\u003cQuiz\u003e quizzes = quizRepository.findByIdIn(quizId);\n        if (CollectionUtils.isEmpty(quizzes)) {\n            return Collections.emptyList();\n        }\n\n        getQuizAuthor(quizzes);\n\n        Map\u003cUUID, List\u003cQuizAttempt\u003e\u003e attemptMap = attempts.stream()\n                .collect(Collectors.groupingBy(QuizAttempt::getQuizId));\n        for (Quiz quiz : quizzes) {\n            quiz.setQuizAttempts(new HashSet\u003c\u003e(attemptMap.get(quiz.getId())));\n        }\n\n        return quizzes;\n    }\n\n    @Override\n    public QuizAttempt getAttempt(String attemptId, UUID userId) {\n        \n        QuizAttempt attempt = quizAttemptRepository.findById(attemptId).orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_ATTEMPT_NOT_FOUND));\n        Quiz quiz = this.getById(attempt.getQuizId().toString());\n        getQuizAuthor(Collections.singletonList(quiz));\n        attempt.setQuiz(quiz);\n        List\u003cQuizAnswer\u003e answers = quizAnswerRepository.findByQuizAttemptId(attemptId);\n        attempt.setAnswers(answers);\n\n        return attempt;\n    }\n\n    @Override\n    public void submitQuizComplete(String attemptId, UUID id) {\n        QuizAttempt attempt = quizAttemptRepository.findById(attemptId).orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_ATTEMPT_NOT_FOUND));\n        if (!id.equals(attempt.getUserId())) {\n            throw new BusinessException(ErrorConstant.QUIZ_ATTEMPT_NOT_BELONG_TO_USER);\n        }\n\n        if (attempt.getCompletedAt() != null) {\n            throw new BusinessException(ErrorConstant.QUIZ_ATTEMPT_SUBMITTED);\n        }\n        attempt.setCompletedAt(LocalDateTime.now());\n        quizAttemptRepository.save(attempt);\n        log.info(\"saved quiz attempt with id: {}\", attemptId);\n    }\n\n    @Override\n    public Quiz getQuizStatsById(String id) {\n        Quiz quiz = quizRepository.findById(id)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n        getQuizAuthor(Collections.singletonList(quiz));\n        List\u003cQuestion\u003e questions = questionRepository.findByQuizId(id);\n        quiz.setQuestions(new HashSet\u003c\u003e(questions));\n        List\u003cQuizAttempt\u003e attempts = quizAttemptRepository.findByQuizId(quiz.getId().toString());\n\n        attempts.forEach(attempt -\u003e {\n            userRepository.getUserById(attempt.getUserId().toString()).ifPresent(attempt::setUser);\n        });\n\n        quiz.setQuizAttempts(new HashSet\u003c\u003e(attempts));\n        List\u003cUser\u003e savedUsers = savedQuizRepository.findAllByQuizId(id)\n                .stream()\n                .map(savedQuiz -\u003e userRepository.getUserById(savedQuiz.getUserId().toString()).orElse(null))\n                .filter(Objects::nonNull)\n                .toList();\n        quiz.setSavedByUsers(new HashSet\u003c\u003e(savedUsers));\n\n        return quiz;\n    }\n\n    @Override\n    public void saveQuiz(String quizId, UUID userId) {\n        savedQuizRepository.saveQuiz(quizId, userId.toString());\n    }\n\n    @Override\n    public List\u003cQuiz\u003e getSavedQuizzes(UUID userId) {\n        List\u003cUserSavedQuiz\u003e savedQuizzes = savedQuizRepository.findAllByUserId(userId.toString());\n        if (CollectionUtils.isEmpty(savedQuizzes)) {\n            return Collections.emptyList();\n        }\n\n        Set\u003cString\u003e quizIds = savedQuizzes.stream()\n                .map(UserSavedQuiz::getQuizId)\n                .map(UUID::toString)\n                .collect(Collectors.toSet());\n        if (CollectionUtils.isEmpty(quizIds)) {\n            return Collections.emptyList();\n        }\n\n        List\u003cQuiz\u003e quizzes = quizRepository.findByIdIn(quizIds);\n        if (CollectionUtils.isEmpty(quizzes)) {\n            return Collections.emptyList();\n        }\n\n        getQuizAuthor(quizzes);\n\n        return quizzes;\n    }\n\n    @Override\n    public void unsaveQuiz(String quizId, UUID userId) {\n        UserSavedQuiz savedQuiz = savedQuizRepository.findAllByQuizId(quizId)\n                .stream()\n                .filter(q -\u003e q.getUserId().equals(userId))\n                .findFirst()\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_SAVED));\n\n        savedQuiz.setSavedAt(LocalDateTime.now());\n        savedQuiz.setDeletedAt(null);\n        savedQuizRepository.update(savedQuiz);\n    }\n\n    @Override\n    public List\u003cUserSavedQuiz\u003e getUserSavedQuiz(String quizId, UUID userId) {\n        List\u003cUserSavedQuiz\u003e savedQuizzes = savedQuizRepository.findAllByUserId(userId.toString());\n        savedQuizzes.forEach(savedQuiz -\u003e {\n            userRepository.getUserById(savedQuiz.getUserId().toString()).ifPresent(savedQuiz::setUser);\n        });\n        return savedQuizzes;\n    }\n\n    @Override\n    public List\u003cQuiz\u003e search(String query) {\n        if (query == null) throw new BusinessException(ErrorConstant.QUIZ_NOT_FOUND); \n\n        return quizRepository.findAll();\n    }\n\n    @Override\n    public List\u003cQuiz\u003e search2(String query) {\n        if (query == null) throw new BusinessException(ErrorConstant.QUIZ_NOT_FOUND); \n\n        return quizRepository.findAll();\n    }\n\n    private void getQuizAuthor(List\u003cQuiz\u003e quizzes) {\n        quizzes.forEach(q -\u003e {\n            if (q.getAuthorId() != null) {\n                q.setAuthor(userRepository.getUserById(q.getAuthorId().toString()).orElse(null));\n            }\n        });\n    }\n\n}"}, {"color": "#22c55e", "id": "QuizServiceImpl.createQuiz", "label": "QuizServiceImpl.createQuiz()", "shape": "dot", "title": "@Override\n    public BaseCreateUpdateResponse createQuiz(CreateQuizDto request, UUID authorId) {\n        Quiz q = quizMapper.createQuizDtoToQuiz(request);\n        q.setAuthorId(authorId);\n        quizRepository.save(q);\n        return new BaseCreateUpdateResponse(q.getId().toString());\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.updateQuiz", "label": "QuizServiceImpl.updateQuiz()", "shape": "dot", "title": "@Override\n    @Transactional(rollbackFor = Exception.class)\n    public BaseCreateUpdateResponse updateQuiz(CreateQuizDto request) {\n        if (request.getId() == null) {\n            throw new IllegalArgumentException(\"Quiz ID must be provided for update operation.\");\n        }\n        UUID quizId = UUID.fromString(request.getId());\n        Quiz existingQuiz = quizRepository.findById(request.getId())\n                .orElseThrow(() -\u003e new EntityNotFoundException(\"Quiz with ID \" + request.getId() + \" not found.\"));\n\n        quizMapper.updateQuizFromDto(request, existingQuiz);\n        existingQuiz.setUpdatedAt(LocalDateTime.now());\n        if (request.getIsPublic()) {\n            existingQuiz.setStatus(QuizStatus.PUBLIC);\n        } else {\n            existingQuiz.setStatus(QuizStatus.DRAFT);\n        }\n\n        List\u003cQuestion\u003e existingQuestions = questionRepository.findByQuizId(request.getId());\n        Map\u003cUUID, Question\u003e existingQuestionMap = existingQuestions.stream()\n                .collect(Collectors.toMap(Question::getId, q -\u003e q));\n\n        List\u003cQuestion\u003e questionsToSaveOrUpdate = new ArrayList\u003c\u003e();\n        Set\u003cUUID\u003e questionIdsInDto = request.getQuestions().stream()\n                .filter(qDto -\u003e qDto.getId() != null)\n                .map(qDto -\u003e UUID.fromString(qDto.getId()))\n                .collect(Collectors.toSet());\n\n        for (QuestionDto qDto : request.getQuestions()) {\n            if (qDto.getId() == null) {\n                Question newQuestion = questionMapper.questionDtoToQuestion(qDto);\n                newQuestion.setQuizId(quizId);\n                newQuestion.setCreatedAt(LocalDateTime.now());\n                newQuestion.setUpdatedAt(LocalDateTime.now());\n                if (!CollectionUtils.isEmpty(newQuestion.getOptions())) {\n                    for (QuestionOption option : newQuestion.getOptions()) {\n                        option.setId(UUID.randomUUID());\n                    }\n                }\n                questionsToSaveOrUpdate.add(newQuestion);\n            } else {\n                UUID qId = UUID.fromString(qDto.getId());\n                Question questionToUpdate = existingQuestionMap.get(qId);\n                if (questionToUpdate != null) {\n                    questionMapper.updateQuestionFromDto(qDto, questionToUpdate);\n                    questionToUpdate.setUpdatedAt(LocalDateTime.now());\n                    \n                    if (!CollectionUtils.isEmpty(questionToUpdate.getOptions())) {\n                        for (QuestionOption option : questionToUpdate.getOptions()) {\n                            if (option.getId() == null) {\n                                option.setId(UUID.randomUUID());\n                            }\n                        }\n                    }\n                    questionsToSaveOrUpdate.add(questionToUpdate);\n                }\n            }\n        }\n\n        List\u003cQuestion\u003e questionsToDelete = existingQuestions.stream()\n                .filter(eq -\u003e !questionIdsInDto.contains(eq.getId()))\n                .collect(Collectors.toList());\n\n        if (!questionsToDelete.isEmpty()) {\n            questionRepository.deleteAll(questionsToDelete);\n        }\n        if (!questionsToSaveOrUpdate.isEmpty()) {\n            questionRepository.saveAll(questionsToSaveOrUpdate);\n        }\n\n        existingQuiz.setQuestionCount(questionRepository.countByQuizId(quizId.toString()));\n\n        quizRepository.save(existingQuiz);\n        return new BaseCreateUpdateResponse(existingQuiz.getId().toString());\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getAllPublicQuizzes", "label": "QuizServiceImpl.getAllPublicQuizzes()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e getAllPublicQuizzes() {\n        List\u003cQuiz\u003e quizzes = quizRepository.findAllPublic();\n        getQuizAuthor(quizzes);\n        return quizzes;\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getMyQuizzes", "label": "QuizServiceImpl.getMyQuizzes()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e getMyQuizzes(UUID id) {\n        List\u003cQuiz\u003e quizzes = quizRepository.findByUserId(id);\n        getQuizAuthor(quizzes);\n        return quizzes;\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getById", "label": "QuizServiceImpl.getById()", "shape": "dot", "title": "@Override\n    public Quiz getById(String id) {\n        Quiz quiz = quizRepository.findById(id)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n        Set\u003cQuestion\u003e questions = new HashSet\u003c\u003e(questionRepository.findByQuizId(id));\n        quiz.setQuestions(questions);\n        getQuizAuthor(Collections.singletonList(quiz));\n        return quiz;\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.deleteQuiz", "label": "QuizServiceImpl.deleteQuiz()", "shape": "dot", "title": "@Override\n    public void deleteQuiz(String id) {\n        Quiz quiz = quizRepository.findById(id)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n        quiz.setDeletedAt(LocalDateTime.now());\n        quizRepository.save(quiz);\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.startQuiz", "label": "QuizServiceImpl.startQuiz()", "shape": "dot", "title": "@Override\n    @Transactional\n    public BaseCreateUpdateResponse startQuiz(String quizId, UUID userId) {\n        quizRepository.findById(quizId)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n\n        QuizAttempt quizAttempt = new QuizAttempt();\n        quizAttempt.setQuizId(UUID.fromString(quizId));\n        quizAttempt.setUserId(userId);\n        quizAttempt.setScore(BigDecimal.ZERO);\n        quizAttempt.setCorrectAnswers(0);\n        quizAttempt.setTimeSpent(0L);\n        quizAttempt.setCompletedAt(null);\n        quizAttempt.setPassed(false);\n\n        QuizAttempt savedAttempt = quizAttemptRepository.save(quizAttempt);\n        return new BaseCreateUpdateResponse(savedAttempt.getId().toString());\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.submitQuizQuestion", "label": "QuizServiceImpl.submitQuizQuestion()", "shape": "dot", "title": "@Override\n    @Transactional\n    public BaseCreateUpdateResponse submitQuizQuestion(String attemptId, SubmitAnswerRequest request, UUID id) {\n        UUID questionId = UUID.fromString(request.getQuestionId());\n\n        QuizAttempt quizAttempt = quizAttemptRepository.findById(attemptId)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_ATTEMPT_NOT_FOUND));\n\n        if (quizAttempt.getCompletedAt() != null) {\n            throw new BusinessException(ErrorConstant.QUIZ_ATTEMPT_SUBMITTED);\n        }\n\n        Quiz quiz = quizRepository.findById(quizAttempt.getQuizId().toString()).orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n\n        if (quiz.getTimeLimit() != null \u0026\u0026 quizAttempt.getCreatedAt() != null) {\n            LocalDateTime start = quizAttempt.getCreatedAt();\n            LocalDateTime end = LocalDateTime.now();\n            long timeSpent = Duration.between(start, end).toMinutes();\n            if (timeSpent \u003e quiz.getTimeLimit()) {\n                quizAttempt.setTimeSpent(timeSpent);\n                quizAttempt.setCompletedAt(quizAttempt.getCreatedAt().plusMinutes(timeSpent));\n                quizAttemptRepository.save(quizAttempt);\n                throw new BusinessException(ErrorConstant.QUIZ_TIME_LIMIT_EXCEEDED);\n            }\n        }\n\n        Question question = questionRepository.findById(request.getQuestionId())\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUESTION_NOT_FOUND));\n\n        if (!Objects.equals(question.getQuizId(), quizAttempt.getQuizId())) {\n            throw new BusinessException(ErrorConstant.QUESTION_DOES_NOT_BELONG_TO_QUIZ);\n        }\n\n        QuizAnswer quizAnswer = new QuizAnswer();\n        quizAnswer.setQuestionId(questionId);\n\n        if (QuestionType.MULTIPLE_CHOICE.name().equals(question.getType()) \u0026\u0026 !CollectionUtils.isEmpty(question.getOptions())) {\n            List\u003cQuestionOption\u003e options = question.getOptions().stream()\n                    .filter(option -\u003e option.getId() != null \u0026\u0026 request.getSelectedOptions().contains(option.getId().toString()))\n                    .collect(Collectors.toList());\n            quizAnswer.setSelectedAnswers(options);\n        }\n        quizAnswer.setFillInBlanksAnswers(request.getFillInBlanksAnswers());\n        quizAnswer.setAnswerText(request.getAnswerText());\n        quizAnswer.setTimeTaken(request.getTimeTaken());\n        quizAnswer.setAudioUrl(request.getAudioUrl());\n\n        boolean isCorrect = false;\n        Integer scoreAchieved = 0;\n\n        switch (question.getType().toLowerCase()) {\n            case \"multiple_choice\":\n                List\u003cString\u003e userSelectedValues = request.getSelectedOptions() != null ?\n                        request.getSelectedOptions().stream()\n                                .filter(Objects::nonNull)\n                                .collect(Collectors.toList()) : new ArrayList\u003c\u003e();\n\n                List\u003cString\u003e correctOptionValues = question.getCorrectAnswer() != null ?\n                        question.getOptions().stream().filter(QuestionOption::getIsCorrect).map(i -\u003e i.getId().toString()).sorted().toList() : new ArrayList\u003c\u003e();\n                userSelectedValues.sort(String::compareTo);\n\n                isCorrect = userSelectedValues.equals(correctOptionValues);\n                break;\n            case \"true_false\":\n                isCorrect = (request.getUserAnswerTrueFalse() != null \u0026\u0026\n                        request.getUserAnswerTrueFalse().equals(question.getTrueFalseAnswer()));\n                break;\n            case \"fill_in_the_blank\":\n                List\u003cString\u003e userFillInBlanks = request.getFillInBlanksAnswers() != null ?\n                        request.getFillInBlanksAnswers().stream()\n                                .filter(Objects::nonNull)\n                                .map(i -\u003e i.toLowerCase().trim())\n                                .collect(Collectors.toList()) : new ArrayList\u003c\u003e();\n\n                List\u003cString\u003e correctBlanks = question.getCorrectBlanks() != null ?\n                        question.getCorrectBlanks().stream()\n                                .filter(Objects::nonNull)\n                                .map(i -\u003e i.toLowerCase().trim())\n                                .collect(Collectors.toList()) : new ArrayList\u003c\u003e();\n\n                Collections.sort(userFillInBlanks);\n                Collections.sort(correctBlanks);\n\n                isCorrect = userFillInBlanks.equals(correctBlanks);\n                break;\n            case \"short_answer\":\n                isCorrect = (request.getAnswerText() != null \u0026\u0026\n                        question.getCorrectAnswer() != null \u0026\u0026\n                        !question.getCorrectAnswer().isEmpty() \u0026\u0026\n                        question.getCorrectAnswer().getFirst().equalsIgnoreCase(request.getAnswerText().trim()));\n                break;\n            case \"pronunciation\":\n                if (request.getAudioUrl() == null || request.getAudioUrl().isEmpty()) {\n                    break;\n                }\n                File audioFile = resourceService.downloadResourceFromUrl(request.getAudioUrl());\n                if (audioFile == null || !audioFile.exists()) {\n                    break;\n                }\n                String base64File = \"data:audio/ogg;;base64,\" + FileUtils.convertToBase64(audioFile);\n                if (base64File == null) {\n                    break;\n                }\n                try {\n                    PronunciationAccuracyResponseDto pronunAccuracy = pronunciationService.getAccuracy(\n                            PronunciationAccuracyRequestDto.builder()\n                                    .base64Audio(base64File)\n                                    .text(question.getPronunciationText())\n                                    .build()\n                    );\n                    isCorrect = pronunAccuracy.getPronunciationAccuracy() \u003e= question.getAcceptRate();\n                    quizAnswer.setAnswerText(JsonUtils.toJsonString(pronunAccuracy));\n                } catch (Exception e) {\n                    log.error(\"Error while checking pronunciation accuracy: {}\", e.getMessage());\n                }\n                break;\n\n            default:\n                System.err.println(\"Unknown question type: \" + question.getType());\n        }\n\n        if (isCorrect) {\n            scoreAchieved = question.getPoints() != null ? question.getPoints() : 0;\n        }\n\n        quizAnswer.setCorrect(isCorrect);\n        quizAnswer.setScoreAchieved(scoreAchieved);\n\n        List\u003cQuizAnswer\u003e currentAnswers = quizAnswerRepository.findByQuizAttemptId(attemptId);\n\n        for (int i = 0; i \u003c currentAnswers.size(); i++) {\n            if (currentAnswers.get(i).getQuestionId().equals(questionId)) {\n                QuizAnswer oldAnswer = currentAnswers.get(i);\n                quizAttempt.setScore(quizAttempt.getScore().subtract(BigDecimal.valueOf(oldAnswer.getScoreAchieved())));\n                if (oldAnswer.isCorrect()) {\n                    quizAttempt.setCorrectAnswers(quizAttempt.getCorrectAnswers() - 1);\n                }\n                quizAnswerRepository.delete(oldAnswer);\n                break;\n            }\n        }\n\n        quizAnswer.setQuizAttemptId(UUID.fromString(attemptId));\n        \n        quizAnswerRepository.save(quizAnswer);\n\n        quizAttempt.setScore(quizAttempt.getScore().add(BigDecimal.valueOf(scoreAchieved)));\n        if (isCorrect) {\n            quizAttempt.setCorrectAnswers(quizAttempt.getCorrectAnswers() + 1);\n        }\n\n        quizAttemptRepository.save(quizAttempt);\n\n        return new BaseCreateUpdateResponse(quizAnswer.getId().toString());\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getMyQuizAttempts", "label": "QuizServiceImpl.getMyQuizAttempts()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e getMyQuizAttempts(String userId) {\n        List\u003cQuizAttempt\u003e attempts = quizAttemptRepository.findByUserId(UUID.fromString(userId));\n        if (CollectionUtils.isEmpty(attempts)) {\n            return Collections.emptyList();\n        }\n\n        Set\u003cString\u003e quizId = attempts.stream()\n                .map(QuizAttempt::getQuizId)\n                .map(UUID::toString)\n                .collect(Collectors.toSet());\n\n        List\u003cQuiz\u003e quizzes = quizRepository.findByIdIn(quizId);\n        if (CollectionUtils.isEmpty(quizzes)) {\n            return Collections.emptyList();\n        }\n\n        getQuizAuthor(quizzes);\n\n        Map\u003cUUID, List\u003cQuizAttempt\u003e\u003e attemptMap = attempts.stream()\n                .collect(Collectors.groupingBy(QuizAttempt::getQuizId));\n        for (Quiz quiz : quizzes) {\n            quiz.setQuizAttempts(new HashSet\u003c\u003e(attemptMap.get(quiz.getId())));\n        }\n\n        return quizzes;\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getAttempt", "label": "QuizServiceImpl.getAttempt()", "shape": "dot", "title": "@Override\n    public QuizAttempt getAttempt(String attemptId, UUID userId) {\n        \n        QuizAttempt attempt = quizAttemptRepository.findById(attemptId).orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_ATTEMPT_NOT_FOUND));\n        Quiz quiz = this.getById(attempt.getQuizId().toString());\n        getQuizAuthor(Collections.singletonList(quiz));\n        attempt.setQuiz(quiz);\n        List\u003cQuizAnswer\u003e answers = quizAnswerRepository.findByQuizAttemptId(attemptId);\n        attempt.setAnswers(answers);\n\n        return attempt;\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.submitQuizComplete", "label": "QuizServiceImpl.submitQuizComplete()", "shape": "dot", "title": "@Override\n    public void submitQuizComplete(String attemptId, UUID id) {\n        QuizAttempt attempt = quizAttemptRepository.findById(attemptId).orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_ATTEMPT_NOT_FOUND));\n        if (!id.equals(attempt.getUserId())) {\n            throw new BusinessException(ErrorConstant.QUIZ_ATTEMPT_NOT_BELONG_TO_USER);\n        }\n\n        if (attempt.getCompletedAt() != null) {\n            throw new BusinessException(ErrorConstant.QUIZ_ATTEMPT_SUBMITTED);\n        }\n        attempt.setCompletedAt(LocalDateTime.now());\n        quizAttemptRepository.save(attempt);\n        log.info(\"saved quiz attempt with id: {}\", attemptId);\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getQuizStatsById", "label": "QuizServiceImpl.getQuizStatsById()", "shape": "dot", "title": "@Override\n    public Quiz getQuizStatsById(String id) {\n        Quiz quiz = quizRepository.findById(id)\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_FOUND));\n        getQuizAuthor(Collections.singletonList(quiz));\n        List\u003cQuestion\u003e questions = questionRepository.findByQuizId(id);\n        quiz.setQuestions(new HashSet\u003c\u003e(questions));\n        List\u003cQuizAttempt\u003e attempts = quizAttemptRepository.findByQuizId(quiz.getId().toString());\n\n        attempts.forEach(attempt -\u003e {\n            userRepository.getUserById(attempt.getUserId().toString()).ifPresent(attempt::setUser);\n        });\n\n        quiz.setQuizAttempts(new HashSet\u003c\u003e(attempts));\n        List\u003cUser\u003e savedUsers = savedQuizRepository.findAllByQuizId(id)\n                .stream()\n                .map(savedQuiz -\u003e userRepository.getUserById(savedQuiz.getUserId().toString()).orElse(null))\n                .filter(Objects::nonNull)\n                .toList();\n        quiz.setSavedByUsers(new HashSet\u003c\u003e(savedUsers));\n\n        return quiz;\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.saveQuiz", "label": "QuizServiceImpl.saveQuiz()", "shape": "dot", "title": "@Override\n    public void saveQuiz(String quizId, UUID userId) {\n        savedQuizRepository.saveQuiz(quizId, userId.toString());\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getSavedQuizzes", "label": "QuizServiceImpl.getSavedQuizzes()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e getSavedQuizzes(UUID userId) {\n        List\u003cUserSavedQuiz\u003e savedQuizzes = savedQuizRepository.findAllByUserId(userId.toString());\n        if (CollectionUtils.isEmpty(savedQuizzes)) {\n            return Collections.emptyList();\n        }\n\n        Set\u003cString\u003e quizIds = savedQuizzes.stream()\n                .map(UserSavedQuiz::getQuizId)\n                .map(UUID::toString)\n                .collect(Collectors.toSet());\n        if (CollectionUtils.isEmpty(quizIds)) {\n            return Collections.emptyList();\n        }\n\n        List\u003cQuiz\u003e quizzes = quizRepository.findByIdIn(quizIds);\n        if (CollectionUtils.isEmpty(quizzes)) {\n            return Collections.emptyList();\n        }\n\n        getQuizAuthor(quizzes);\n\n        return quizzes;\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.unsaveQuiz", "label": "QuizServiceImpl.unsaveQuiz()", "shape": "dot", "title": "@Override\n    public void unsaveQuiz(String quizId, UUID userId) {\n        UserSavedQuiz savedQuiz = savedQuizRepository.findAllByQuizId(quizId)\n                .stream()\n                .filter(q -\u003e q.getUserId().equals(userId))\n                .findFirst()\n                .orElseThrow(() -\u003e new BusinessException(ErrorConstant.QUIZ_NOT_SAVED));\n\n        savedQuiz.setSavedAt(LocalDateTime.now());\n        savedQuiz.setDeletedAt(null);\n        savedQuizRepository.update(savedQuiz);\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getUserSavedQuiz", "label": "QuizServiceImpl.getUserSavedQuiz()", "shape": "dot", "title": "@Override\n    public List\u003cUserSavedQuiz\u003e getUserSavedQuiz(String quizId, UUID userId) {\n        List\u003cUserSavedQuiz\u003e savedQuizzes = savedQuizRepository.findAllByUserId(userId.toString());\n        savedQuizzes.forEach(savedQuiz -\u003e {\n            userRepository.getUserById(savedQuiz.getUserId().toString()).ifPresent(savedQuiz::setUser);\n        });\n        return savedQuizzes;\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.search", "label": "QuizServiceImpl.search()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e search(String query) {\n        if (query == null) throw new BusinessException(ErrorConstant.QUIZ_NOT_FOUND); \n\n        return quizRepository.findAll();\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.search2", "label": "QuizServiceImpl.search2()", "shape": "dot", "title": "@Override\n    public List\u003cQuiz\u003e search2(String query) {\n        if (query == null) throw new BusinessException(ErrorConstant.QUIZ_NOT_FOUND); \n\n        return quizRepository.findAll();\n    }"}, {"color": "#22c55e", "id": "QuizServiceImpl.getQuizAuthor", "label": "QuizServiceImpl.getQuizAuthor()", "shape": "dot", "title": "private void getQuizAuthor(List\u003cQuiz\u003e quizzes) {\n        quizzes.forEach(q -\u003e {\n            if (q.getAuthorId() != null) {\n                q.setAuthor(userRepository.getUserById(q.getAuthorId().toString()).orElse(null));\n            }\n        });\n    }"}, {"color": "#3b82f6", "id": "ResourceServiceImpl", "label": "Class: ResourceServiceImpl", "shape": "dot", "title": "@Service\n@Slf4j\npublic class ResourceServiceImpl implements ResourceService {\n\n    private final ResourceRepository resourceRepository;\n\n    private final StorageService storageService;\n\n    public ResourceServiceImpl(StorageFactory storageFactory, ResourceRepository resourceRepository) {\n        this.resourceRepository = resourceRepository;\n        this.storageService = storageFactory.getStorageService(Constant.STORAGE_AWS);\n    }\n\n    @Override\n    public Resource uploadResource(MultipartFile file, UUID requestId) {\n\n        String url = storageService.uploadFile(file);\n\n        Resource resource = Resource.builder()\n                .name(file.getOriginalFilename())\n                .url(url)\n                .ownerId(requestId)\n                .extension(file.getContentType())\n                .sizeBytes(file.getSize())\n                .cloudId(storageService.getProviderName())\n                .build();\n        resourceRepository.save(resource);\n        return resource;\n    }\n\n    @Override\n    public GetResourceResponse getResource(String id, UUID requestId) {\n        Resource resource = resourceRepository.findById(requestId.toString());\n\n        if (Objects.isNull(resource)) {\n            throw new RuntimeException(\"Resource not found\");\n        }\n\n        try {\n            if (!requestId.equals(resource.getOwnerId())) {\n                throw new RuntimeException(\"You are not allowed to access this resource\");\n            }\n\n            String url = storageService.getFileUrl(resource.getUrl());\n\n            return GetResourceResponse.builder()\n                    .name(resource.getName())\n                    .url(url)\n                    .build();\n\n        } catch (Exception e) {\n            log.info(\"Generate url failed {}\", e.getMessage());\n            throw new RuntimeException(\"Generate url failed\");\n        }\n    }\n\n    @Override\n    public File downloadResourceFromUrl(String urlString) {\n        try {\n            URI uri = URI.create(urlString);\n            URL url = uri.toURL();\n\n            String fileName = Path.of(uri.getPath()).getFileName().toString();\n            File outputFile = File.createTempFile(\"download_\", \"_\" + fileName);\n\n            try (InputStream in = url.openStream();\n                 FileOutputStream out = new FileOutputStream(outputFile)) {\n                byte[] buffer = new byte[8192];\n                int bytesRead;\n                while ((bytesRead = in.read(buffer)) != -1) {\n                    out.write(buffer, 0, bytesRead);\n                }\n            }\n\n            return outputFile;\n\n        } catch (IOException e) {\n            throw new RuntimeException(\"Failed to download file from URL: \" + urlString, e);\n        }\n    }\n}"}, {"color": "#22c55e", "id": "ResourceServiceImpl.uploadResource", "label": "ResourceServiceImpl.uploadResource()", "shape": "dot", "title": "@Override\n    public Resource uploadResource(MultipartFile file, UUID requestId) {\n\n        String url = storageService.uploadFile(file);\n\n        Resource resource = Resource.builder()\n                .name(file.getOriginalFilename())\n                .url(url)\n                .ownerId(requestId)\n                .extension(file.getContentType())\n                .sizeBytes(file.getSize())\n                .cloudId(storageService.getProviderName())\n                .build();\n        resourceRepository.save(resource);\n        return resource;\n    }"}, {"color": "#22c55e", "id": "ResourceServiceImpl.getResource", "label": "ResourceServiceImpl.getResource()", "shape": "dot", "title": "@Override\n    public GetResourceResponse getResource(String id, UUID requestId) {\n        Resource resource = resourceRepository.findById(requestId.toString());\n\n        if (Objects.isNull(resource)) {\n            throw new RuntimeException(\"Resource not found\");\n        }\n\n        try {\n            if (!requestId.equals(resource.getOwnerId())) {\n                throw new RuntimeException(\"You are not allowed to access this resource\");\n            }\n\n            String url = storageService.getFileUrl(resource.getUrl());\n\n            return GetResourceResponse.builder()\n                    .name(resource.getName())\n                    .url(url)\n                    .build();\n\n        } catch (Exception e) {\n            log.info(\"Generate url failed {}\", e.getMessage());\n            throw new RuntimeException(\"Generate url failed\");\n        }\n    }"}, {"color": "#22c55e", "id": "ResourceServiceImpl.downloadResourceFromUrl", "label": "ResourceServiceImpl.downloadResourceFromUrl()", "shape": "dot", "title": "@Override\n    public File downloadResourceFromUrl(String urlString) {\n        try {\n            URI uri = URI.create(urlString);\n            URL url = uri.toURL();\n\n            String fileName = Path.of(uri.getPath()).getFileName().toString();\n            File outputFile = File.createTempFile(\"download_\", \"_\" + fileName);\n\n            try (InputStream in = url.openStream();\n                 FileOutputStream out = new FileOutputStream(outputFile)) {\n                byte[] buffer = new byte[8192];\n                int bytesRead;\n                while ((bytesRead = in.read(buffer)) != -1) {\n                    out.write(buffer, 0, bytesRead);\n                }\n            }\n\n            return outputFile;\n\n        } catch (IOException e) {\n            throw new RuntimeException(\"Failed to download file from URL: \" + urlString, e);\n        }\n    }"}, {"color": "#3b82f6", "id": "PronunciationFeignClient", "label": "Class: PronunciationFeignClient", "shape": "dot", "title": "@FeignClient(\n        name = \"pronunciation-service\",\n        url = \"${thirdparty.pronunciation.service.url}\"\n)\npublic interface PronunciationFeignClient {\n\n    @PostMapping(value = \"/GetAccuracyFromRecordedAudio\", produces = \"application/json\")\n    PronunciationAccuracyResponse getAccuracyFromRecordedAudio(@RequestBody PronunciationAccuracyRequest request);\n\n    @PostMapping(value = \"/getSample\", produces = \"application/json\")\n    GetSampleResponse getSample(@RequestBody GetSampleRequest request);\n\n}"}, {"color": "#22c55e", "id": "PronunciationFeignClient.getAccuracyFromRecordedAudio", "label": "PronunciationFeignClient.getAccuracyFromRecordedAudio()", "shape": "dot", "title": "@PostMapping(value = \"/GetAccuracyFromRecordedAudio\", produces = \"application/json\")\n    PronunciationAccuracyResponse getAccuracyFromRecordedAudio(@RequestBody PronunciationAccuracyRequest request);"}, {"color": "#22c55e", "id": "PronunciationFeignClient.getSample", "label": "PronunciationFeignClient.getSample()", "shape": "dot", "title": "@PostMapping(value = \"/getSample\", produces = \"application/json\")\n    GetSampleResponse getSample(@RequestBody GetSampleRequest request);"}, {"color": "#3b82f6", "id": "PronunciationServiceImpl", "label": "Class: PronunciationServiceImpl", "shape": "dot", "title": "@Service\npublic class PronunciationServiceImpl implements PronunciationService {\n\n    private final PronunciationFeignClient pronunciationFeignClient;\n\n    private final PronunciationMapper pronunciationMapper;\n\n    public PronunciationServiceImpl(PronunciationFeignClient pronunciationFeignClient, PronunciationMapper pronunciationMapper) {\n        this.pronunciationFeignClient = pronunciationFeignClient;\n        this.pronunciationMapper = pronunciationMapper;\n    }\n\n    @Override\n    public GetPronunciationSampleResponseDto getSample(GetSampleRequestDto request) {\n        GetSampleRequest req = pronunciationMapper.toSampleRequest(request);\n        req.setCategory(request.getLevel().getValue());\n        req.setLanguage(\"en\");\n        GetSampleResponse response = pronunciationFeignClient.getSample(req);\n\n        if (response == null) {\n            throw new BusinessException(ErrorConstant.GET_PRONUNCIATION_SAMPLE_ERROR);\n        }\n\n        return pronunciationMapper.toGetPronunciationSampleResponseDto(response);\n    }\n\n    @Override\n    public PronunciationAccuracyResponseDto getAccuracy(PronunciationAccuracyRequestDto request) {\n        PronunciationAccuracyRequest req = pronunciationMapper.toPronunciationAccuracyRequest(request);\n        req.setLanguage(\"en\");\n        PronunciationAccuracyResponse response = pronunciationFeignClient.getAccuracyFromRecordedAudio(req);\n\n        if (response == null) {\n            throw new BusinessException(ErrorConstant.GET_PRONUNCIATION_ACCURACY_ERROR);\n        }\n\n        return pronunciationMapper.toPronunciationAccuracyResponseDto(response);\n    }\n}"}, {"color": "#22c55e", "id": "PronunciationServiceImpl.getSample", "label": "PronunciationServiceImpl.getSample()", "shape": "dot", "title": "@Override\n    public GetPronunciationSampleResponseDto getSample(GetSampleRequestDto request) {\n        GetSampleRequest req = pronunciationMapper.toSampleRequest(request);\n        req.setCategory(request.getLevel().getValue());\n        req.setLanguage(\"en\");\n        GetSampleResponse response = pronunciationFeignClient.getSample(req);\n\n        if (response == null) {\n            throw new BusinessException(ErrorConstant.GET_PRONUNCIATION_SAMPLE_ERROR);\n        }\n\n        return pronunciationMapper.toGetPronunciationSampleResponseDto(response);\n    }"}, {"color": "#22c55e", "id": "PronunciationServiceImpl.getAccuracy", "label": "PronunciationServiceImpl.getAccuracy()", "shape": "dot", "title": "@Override\n    public PronunciationAccuracyResponseDto getAccuracy(PronunciationAccuracyRequestDto request) {\n        PronunciationAccuracyRequest req = pronunciationMapper.toPronunciationAccuracyRequest(request);\n        req.setLanguage(\"en\");\n        PronunciationAccuracyResponse response = pronunciationFeignClient.getAccuracyFromRecordedAudio(req);\n\n        if (response == null) {\n            throw new BusinessException(ErrorConstant.GET_PRONUNCIATION_ACCURACY_ERROR);\n        }\n\n        return pronunciationMapper.toPronunciationAccuracyResponseDto(response);\n    }"}, {"color": "#3b82f6", "id": "AwsStorageServiceImpl", "label": "Class: AwsStorageServiceImpl", "shape": "dot", "title": "@Component(\"awsStorageService\")\n@Slf4j\npublic class AwsStorageServiceImpl extends StorageService {\n    private final S3Client s3Client;\n\n    @Value(\"${aws.s3.bucket.name}\")\n    private String bucketName;\n\n    @Value(\"${aws.s3.bucket.domain}\")\n    private String domain;\n\n    public AwsStorageServiceImpl(S3Client s3Client) {\n        this.s3Client = s3Client;\n    }\n\n    @Override\n    public String getFileUrl(String fileName) {\n        return String.format(\"%s/%s\", domain, fileName);\n    }\n\n    @Override\n    public String uploadFile(MultipartFile file) {\n        File fileObj = null;\n        try {\n            fileObj = convertMultiPartFileToFile(file);\n            String fileName = Objects.requireNonNull(file.getOriginalFilename()).replace(\" \", \"\") + \"_\" + System.currentTimeMillis() + \".\"\n                    + Objects.requireNonNull(file.getContentType()).split(\"/\")[1];\n\n            PutObjectRequest putObjectRequest = PutObjectRequest.builder()\n                    .bucket(bucketName)\n                    .key(fileName)\n                    .contentType(file.getContentType())\n                    .build();\n\n            s3Client.putObject(putObjectRequest, RequestBody.fromFile(fileObj));\n\n            return getFileUrl(fileName);\n        } catch (IOException e) {\n            log.error(\"Error during file processing (conversion or deletion): {}\", e.getMessage(), e);\n            throw new RuntimeException(\"Error processing file for S3 upload\", e);\n        }\n        catch (Exception e) {\n            log.error(\"Error while uploading file to S3: {}\", e.getMessage(), e);\n            throw new RuntimeException(\"Error while uploading file to S3\", e);\n        } finally {\n            if (fileObj != null \u0026\u0026 fileObj.exists()) {\n                if (!fileObj.delete()) {\n                    log.warn(\"Failed to delete temporary file: {}\", fileObj.getAbsolutePath());\n                }\n            }\n        }\n    }\n\n    @Override\n    public String getProviderName() {\n        return Constant.STORAGE_AWS;\n    }\n\n    @Override\n    public byte[] downloadFile(String fileName) {\n        try {\n            \n            GetObjectRequest getObjectRequest = GetObjectRequest.builder()\n                    .bucket(bucketName)\n                    .key(fileName)\n                    .build();\n\n            ResponseInputStream\u003cGetObjectResponse\u003e s3Object = s3Client.getObject(getObjectRequest);\n            return s3Object.readAllBytes();\n        } catch (IOException e) {\n            log.error(\"Error reading downloaded file content: {}\", e.getMessage(), e);\n            throw new RuntimeException(\"Error while reading downloaded file content\", e);\n        } catch (Exception e) {\n            log.error(\"Error while downloading file from S3: {}\", e.getMessage(), e);\n            throw new RuntimeException(\"Error while downloading file from S3\", e);\n        }\n    }\n\n    @Override\n    public String deleteFile(String fileName) {\n        try {\n            \n            DeleteObjectRequest deleteObjectRequest = DeleteObjectRequest.builder()\n                    .bucket(bucketName)\n                    .key(fileName)\n                    .build();\n            s3Client.deleteObject(deleteObjectRequest);\n            return fileName + \" removed ...\";\n        } catch (Exception e) {\n            log.error(\"Error while deleting file from S3: {}\", e.getMessage(), e);\n            throw new RuntimeException(\"Error while deleting file from S3\", e);\n        }\n    }\n}"}, {"color": "#22c55e", "id": "AwsStorageServiceImpl.getFileUrl", "label": "AwsStorageServiceImpl.getFileUrl()", "shape": "dot", "title": "@Override\n    public String getFileUrl(String fileName) {\n        return String.format(\"%s/%s\", domain, fileName);\n    }"}, {"color": "#22c55e", "id": "AwsStorageServiceImpl.uploadFile", "label": "AwsStorageServiceImpl.uploadFile()", "shape": "dot", "title": "@Override\n    public String uploadFile(MultipartFile file) {\n        File fileObj = null;\n        try {\n            fileObj = convertMultiPartFileToFile(file);\n            String fileName = Objects.requireNonNull(file.getOriginalFilename()).replace(\" \", \"\") + \"_\" + System.currentTimeMillis() + \".\"\n                    + Objects.requireNonNull(file.getContentType()).split(\"/\")[1];\n\n            PutObjectRequest putObjectRequest = PutObjectRequest.builder()\n                    .bucket(bucketName)\n                    .key(fileName)\n                    .contentType(file.getContentType())\n                    .build();\n\n            s3Client.putObject(putObjectRequest, RequestBody.fromFile(fileObj));\n\n            return getFileUrl(fileName);\n        } catch (IOException e) {\n            log.error(\"Error during file processing (conversion or deletion): {}\", e.getMessage(), e);\n            throw new RuntimeException(\"Error processing file for S3 upload\", e);\n        }\n        catch (Exception e) {\n            log.error(\"Error while uploading file to S3: {}\", e.getMessage(), e);\n            throw new RuntimeException(\"Error while uploading file to S3\", e);\n        } finally {\n            if (fileObj != null \u0026\u0026 fileObj.exists()) {\n                if (!fileObj.delete()) {\n                    log.warn(\"Failed to delete temporary file: {}\", fileObj.getAbsolutePath());\n                }\n            }\n        }\n    }"}, {"color": "#22c55e", "id": "AwsStorageServiceImpl.getProviderName", "label": "AwsStorageServiceImpl.getProviderName()", "shape": "dot", "title": "@Override\n    public String getProviderName() {\n        return Constant.STORAGE_AWS;\n    }"}, {"color": "#22c55e", "id": "AwsStorageServiceImpl.downloadFile", "label": "AwsStorageServiceImpl.downloadFile()", "shape": "dot", "title": "@Override\n    public byte[] downloadFile(String fileName) {\n        try {\n            \n            GetObjectRequest getObjectRequest = GetObjectRequest.builder()\n                    .bucket(bucketName)\n                    .key(fileName)\n                    .build();\n\n            ResponseInputStream\u003cGetObjectResponse\u003e s3Object = s3Client.getObject(getObjectRequest);\n            return s3Object.readAllBytes();\n        } catch (IOException e) {\n            log.error(\"Error reading downloaded file content: {}\", e.getMessage(), e);\n            throw new RuntimeException(\"Error while reading downloaded file content\", e);\n        } catch (Exception e) {\n            log.error(\"Error while downloading file from S3: {}\", e.getMessage(), e);\n            throw new RuntimeException(\"Error while downloading file from S3\", e);\n        }\n    }"}, {"color": "#22c55e", "id": "AwsStorageServiceImpl.deleteFile", "label": "AwsStorageServiceImpl.deleteFile()", "shape": "dot", "title": "@Override\n    public String deleteFile(String fileName) {\n        try {\n            \n            DeleteObjectRequest deleteObjectRequest = DeleteObjectRequest.builder()\n                    .bucket(bucketName)\n                    .key(fileName)\n                    .build();\n            s3Client.deleteObject(deleteObjectRequest);\n            return fileName + \" removed ...\";\n        } catch (Exception e) {\n            log.error(\"Error while deleting file from S3: {}\", e.getMessage(), e);\n            throw new RuntimeException(\"Error while deleting file from S3\", e);\n        }\n    }"}, {"color": "#3b82f6", "id": "GoogleStorageServiceImpl", "label": "Class: GoogleStorageServiceImpl", "shape": "dot", "title": "@Component(\"googleStorageService\")\n@Slf4j\npublic class GoogleStorageServiceImpl extends StorageService {\n\n    @Value(\"${gcp.bucket.name}\")\n    private String bucketName;\n\n    @Value(\"${gcp.project.id}\")\n    private String projectId;\n\n    @Value(\"${gcp.bucket.domain}\")\n    private String domain;\n\n    @Value(\"${gcp.credentials.file}\")\n    private String gcpCredentials;\n\n    public GoogleStorageServiceImpl() {\n\n    }\n\n    @Override\n    public String getFileUrl(String fileName) {\n        return String.format(\"%s/%s\", domain, fileName);\n    }\n\n    @Override\n    public String uploadFile(MultipartFile file) {\n        File tempFile = null;\n        String uploadedFileName = null;\n        try {\n            \n            if (file.isEmpty()) {\n                throw new IllegalArgumentException(\"Cannot upload empty file.\");\n            }\n\n            String originalFilename = Objects.requireNonNull(file.getOriginalFilename());\n            String fileExtension = \"\";\n            int dotIndex = originalFilename.lastIndexOf(\u0027.\u0027);\n            if (dotIndex \u003e 0 \u0026\u0026 dotIndex \u003c originalFilename.length() - 1) {\n                fileExtension = originalFilename.substring(dotIndex);\n            }\n            \n            uploadedFileName = UUID.randomUUID().toString() + fileExtension;\n\n            tempFile = File.createTempFile(\"upload-\", fileExtension);\n            file.transferTo(tempFile);\n\n            InputStream inputStream = new ClassPathResource(gcpCredentials).getInputStream();\n\n            Storage storage = StorageOptions.newBuilder().setProjectId(projectId).setCredentials(GoogleCredentials.fromStream(inputStream)).build().getService();\n            BlobId blobId = BlobId.of(bucketName, uploadedFileName);\n            String contentType = file.getContentType() != null ? file.getContentType() : \"application/octet-stream\";\n            BlobInfo blobInfo = BlobInfo.newBuilder(blobId)\n                    .setContentType(contentType)\n                    .build();\n\n            storage.createFrom(blobInfo, Files.newInputStream(tempFile.toPath()));\n\n            log.info(\"File {} uploaded to Google Cloud Storage bucket {} as {}\", originalFilename, bucketName, uploadedFileName);\n            return uploadedFileName;\n\n        } catch (IOException e) {\n            log.error(\"Error during file processing or upload to Google Cloud Storage: {}\", e.getMessage(), e);\n            throw new RuntimeException(\"Error processing file for Google Cloud Storage upload\", e);\n        } catch (Exception e) {\n            log.error(\"An unexpected error occurred while uploading file to Google Cloud Storage: {}\", e.getMessage(), e);\n            throw new RuntimeException(\"An unexpected error occurred during Google Cloud Storage upload\", e);\n        } finally {\n            \n            if (tempFile != null \u0026\u0026 tempFile.exists()) {\n                try {\n                    Files.delete(tempFile.toPath());\n                    log.debug(\"Temporary file deleted: {}\", tempFile.getAbsolutePath());\n                } catch (IOException e) {\n                    log.warn(\"Failed to delete temporary file: {}\", tempFile.getAbsolutePath(), e);\n                }\n            }\n        }\n    }\n\n    @Override\n    public String getProviderName() {\n        return Constant.STORAGE_GCP;\n    }\n\n    @Override\n    public byte[] downloadFile(String fileName) {\n        try {\n            Storage storage = StorageOptions.newBuilder().setProjectId(projectId).build().getService();\n            BlobId blobId = BlobId.of(bucketName, fileName);\n            return storage.readAllBytes(blobId);\n        } catch (Exception e) {\n            log.error(\"Error while downloading file {} from Google Cloud Storage: {}\", fileName, e.getMessage(), e);\n            throw new RuntimeException(\"Error while downloading file from Google Cloud Storage\", e);\n        }\n    }\n\n    @Override\n    public String deleteFile(String fileName) {\n        try {\n            Storage storage = StorageOptions.newBuilder().setProjectId(projectId).build().getService();\n            BlobId blobId = BlobId.of(bucketName, fileName);\n            boolean deleted = storage.delete(blobId);\n\n            if (deleted) {\n                log.info(\"File {} deleted from Google Cloud Storage bucket {}\", fileName, bucketName);\n                return fileName + \" removed ...\";\n            } else {\n                log.warn(\"File {} not found in Google Cloud Storage bucket {} for deletion.\", fileName, bucketName);\n                return fileName + \" not found or could not be deleted.\";\n            }\n        } catch (Exception e) {\n            log.error(\"Error while deleting file {} from Google Cloud Storage: {}\", fileName, e.getMessage(), e);\n            throw new RuntimeException(\"Error while deleting file from Google Cloud Storage\", e);\n        }\n    }\n}"}, {"color": "#22c55e", "id": "GoogleStorageServiceImpl.getFileUrl", "label": "GoogleStorageServiceImpl.getFileUrl()", "shape": "dot", "title": "@Override\n    public String getFileUrl(String fileName) {\n        return String.format(\"%s/%s\", domain, fileName);\n    }"}, {"color": "#22c55e", "id": "GoogleStorageServiceImpl.uploadFile", "label": "GoogleStorageServiceImpl.uploadFile()", "shape": "dot", "title": "@Override\n    public String uploadFile(MultipartFile file) {\n        File tempFile = null;\n        String uploadedFileName = null;\n        try {\n            \n            if (file.isEmpty()) {\n                throw new IllegalArgumentException(\"Cannot upload empty file.\");\n            }\n\n            String originalFilename = Objects.requireNonNull(file.getOriginalFilename());\n            String fileExtension = \"\";\n            int dotIndex = originalFilename.lastIndexOf(\u0027.\u0027);\n            if (dotIndex \u003e 0 \u0026\u0026 dotIndex \u003c originalFilename.length() - 1) {\n                fileExtension = originalFilename.substring(dotIndex);\n            }\n            \n            uploadedFileName = UUID.randomUUID().toString() + fileExtension;\n\n            tempFile = File.createTempFile(\"upload-\", fileExtension);\n            file.transferTo(tempFile);\n\n            InputStream inputStream = new ClassPathResource(gcpCredentials).getInputStream();\n\n            Storage storage = StorageOptions.newBuilder().setProjectId(projectId).setCredentials(GoogleCredentials.fromStream(inputStream)).build().getService();\n            BlobId blobId = BlobId.of(bucketName, uploadedFileName);\n            String contentType = file.getContentType() != null ? file.getContentType() : \"application/octet-stream\";\n            BlobInfo blobInfo = BlobInfo.newBuilder(blobId)\n                    .setContentType(contentType)\n                    .build();\n\n            storage.createFrom(blobInfo, Files.newInputStream(tempFile.toPath()));\n\n            log.info(\"File {} uploaded to Google Cloud Storage bucket {} as {}\", originalFilename, bucketName, uploadedFileName);\n            return uploadedFileName;\n\n        } catch (IOException e) {\n            log.error(\"Error during file processing or upload to Google Cloud Storage: {}\", e.getMessage(), e);\n            throw new RuntimeException(\"Error processing file for Google Cloud Storage upload\", e);\n        } catch (Exception e) {\n            log.error(\"An unexpected error occurred while uploading file to Google Cloud Storage: {}\", e.getMessage(), e);\n            throw new RuntimeException(\"An unexpected error occurred during Google Cloud Storage upload\", e);\n        } finally {\n            \n            if (tempFile != null \u0026\u0026 tempFile.exists()) {\n                try {\n                    Files.delete(tempFile.toPath());\n                    log.debug(\"Temporary file deleted: {}\", tempFile.getAbsolutePath());\n                } catch (IOException e) {\n                    log.warn(\"Failed to delete temporary file: {}\", tempFile.getAbsolutePath(), e);\n                }\n            }\n        }\n    }"}, {"color": "#22c55e", "id": "GoogleStorageServiceImpl.getProviderName", "label": "GoogleStorageServiceImpl.getProviderName()", "shape": "dot", "title": "@Override\n    public String getProviderName() {\n        return Constant.STORAGE_GCP;\n    }"}, {"color": "#22c55e", "id": "GoogleStorageServiceImpl.downloadFile", "label": "GoogleStorageServiceImpl.downloadFile()", "shape": "dot", "title": "@Override\n    public byte[] downloadFile(String fileName) {\n        try {\n            Storage storage = StorageOptions.newBuilder().setProjectId(projectId).build().getService();\n            BlobId blobId = BlobId.of(bucketName, fileName);\n            return storage.readAllBytes(blobId);\n        } catch (Exception e) {\n            log.error(\"Error while downloading file {} from Google Cloud Storage: {}\", fileName, e.getMessage(), e);\n            throw new RuntimeException(\"Error while downloading file from Google Cloud Storage\", e);\n        }\n    }"}, {"color": "#22c55e", "id": "GoogleStorageServiceImpl.deleteFile", "label": "GoogleStorageServiceImpl.deleteFile()", "shape": "dot", "title": "@Override\n    public String deleteFile(String fileName) {\n        try {\n            Storage storage = StorageOptions.newBuilder().setProjectId(projectId).build().getService();\n            BlobId blobId = BlobId.of(bucketName, fileName);\n            boolean deleted = storage.delete(blobId);\n\n            if (deleted) {\n                log.info(\"File {} deleted from Google Cloud Storage bucket {}\", fileName, bucketName);\n                return fileName + \" removed ...\";\n            } else {\n                log.warn(\"File {} not found in Google Cloud Storage bucket {} for deletion.\", fileName, bucketName);\n                return fileName + \" not found or could not be deleted.\";\n            }\n        } catch (Exception e) {\n            log.error(\"Error while deleting file {} from Google Cloud Storage: {}\", fileName, e.getMessage(), e);\n            throw new RuntimeException(\"Error while deleting file from Google Cloud Storage\", e);\n        }\n    }"}, {"color": "#3b82f6", "id": "StorageFactory", "label": "Class: StorageFactory", "shape": "dot", "title": "@Component\npublic class StorageFactory {\n\n    private final List\u003cStorageService\u003e services;\n\n    public StorageFactory(List\u003cStorageService\u003e services) {\n        this.services = services;\n    }\n\n    public StorageService getStorageService(String providerName) {\n        return services.stream()\n                .filter(service -\u003e service.getProviderName().equalsIgnoreCase(providerName))\n                .findFirst()\n                .orElseThrow(() -\u003e new IllegalArgumentException(\"No storage service found for provider: \" + providerName));\n    }\n}"}, {"color": "#22c55e", "id": "StorageFactory.getStorageService", "label": "StorageFactory.getStorageService()", "shape": "dot", "title": "public StorageService getStorageService(String providerName) {\n        return services.stream()\n                .filter(service -\u003e service.getProviderName().equalsIgnoreCase(providerName))\n                .findFirst()\n                .orElseThrow(() -\u003e new IllegalArgumentException(\"No storage service found for provider: \" + providerName));\n    }"}, {"color": "#3b82f6", "id": "StorageService", "label": "Class: StorageService", "shape": "dot", "title": "@Slf4j\npublic abstract class StorageService {\n\n    public abstract String getFileUrl(String fileName);\n\n    public abstract String uploadFile(MultipartFile file);\n\n    public abstract String getProviderName();\n\n    public abstract byte[] downloadFile(String fileName);\n\n    public abstract String deleteFile(String fileName);\n\n    protected File convertMultiPartFileToFile(MultipartFile file) throws IOException {\n        String originalFilename = Objects.requireNonNull(file.getOriginalFilename());\n        String name = originalFilename;\n        String extension = \"\";\n        int lastDotIndex = originalFilename.lastIndexOf(\".\");\n        if (lastDotIndex != -1) {\n            name = originalFilename.substring(0, lastDotIndex);\n            extension = originalFilename.substring(lastDotIndex);\n        }\n\n        Path tempFilePath = Files.createTempFile(name + \"_\", extension);\n\n        file.transferTo(tempFilePath.toFile());\n\n        log.debug(\"Created temporary file: {}\", tempFilePath.toAbsolutePath());\n        return tempFilePath.toFile();\n    }\n}"}, {"color": "#22c55e", "id": "StorageService.getFileUrl", "label": "StorageService.getFileUrl()", "shape": "dot", "title": "public abstract String getFileUrl(String fileName);"}, {"color": "#22c55e", "id": "StorageService.uploadFile", "label": "StorageService.uploadFile()", "shape": "dot", "title": "public abstract String uploadFile(MultipartFile file);"}, {"color": "#22c55e", "id": "StorageService.getProviderName", "label": "StorageService.getProviderName()", "shape": "dot", "title": "public abstract String getProviderName();"}, {"color": "#22c55e", "id": "StorageService.downloadFile", "label": "StorageService.downloadFile()", "shape": "dot", "title": "public abstract byte[] downloadFile(String fileName);"}, {"color": "#22c55e", "id": "StorageService.deleteFile", "label": "StorageService.deleteFile()", "shape": "dot", "title": "public abstract String deleteFile(String fileName);"}, {"color": "#22c55e", "id": "StorageService.convertMultiPartFileToFile", "label": "StorageService.convertMultiPartFileToFile()", "shape": "dot", "title": "protected File convertMultiPartFileToFile(MultipartFile file) throws IOException {\n        String originalFilename = Objects.requireNonNull(file.getOriginalFilename());\n        String name = originalFilename;\n        String extension = \"\";\n        int lastDotIndex = originalFilename.lastIndexOf(\".\");\n        if (lastDotIndex != -1) {\n            name = originalFilename.substring(0, lastDotIndex);\n            extension = originalFilename.substring(lastDotIndex);\n        }\n\n        Path tempFilePath = Files.createTempFile(name + \"_\", extension);\n\n        file.transferTo(tempFilePath.toFile());\n\n        log.debug(\"Created temporary file: {}\", tempFilePath.toAbsolutePath());\n        return tempFilePath.toFile();\n    }"}, {"color": "#3b82f6", "id": "GetSampleRequest", "label": "Class: GetSampleRequest", "shape": "dot", "title": "@Data\npublic class GetSampleRequest {\n\n    private String category;\n\n    private String language;\n\n    @JsonInclude(JsonInclude.Include.NON_NULL)\n    private String transcript;\n\n}"}, {"color": "#3b82f6", "id": "PronunciationAccuracyRequest", "label": "Class: PronunciationAccuracyRequest", "shape": "dot", "title": "@Data\npublic class PronunciationAccuracyRequest {\n\n    private String base64Audio;\n\n    private String language;\n\n    @JsonProperty(\"title\")\n    private String text;\n\n}"}, {"color": "#3b82f6", "id": "GetSampleResponse", "label": "Class: GetSampleResponse", "shape": "dot", "title": "@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class GetSampleResponse {\n\n    @JsonProperty(\"ipa_transcript\")\n    private String ipaTranscript;\n\n    @JsonProperty(\"real_transcript\")\n    private String realTranscript;\n\n    @JsonProperty(\"transcript_translation\")\n    private String transcriptTranslation;\n\n}"}, {"color": "#3b82f6", "id": "PronunciationAccuracyResponse", "label": "Class: PronunciationAccuracyResponse", "shape": "dot", "title": "@JsonNaming(PropertyNamingStrategies.SnakeCaseStrategy.class)\n@Data\npublic class PronunciationAccuracyResponse {\n\n    private String startTime;\n\n    private String endTime;\n\n    private String ipaScript;\n\n    private String isLetterCorrectAllWords;\n\n    private String matchedTranscripts;\n\n    private String matchedTranscriptsIpa;\n\n    private String pairAccuracyCategory;\n\n    private Integer pronunciationAccuracy;\n\n    private String realTranscript;\n\n    private String realTranscripts;\n\n    private String realTranscriptsIpa;\n\n}"}, {"color": "#3b82f6", "id": "OnestudyApplicationTests", "label": "Class: OnestudyApplicationTests", "shape": "dot", "title": "@SpringBootTest\nclass OnestudyApplicationTests {\n\n    @Test\n    void contextLoads() {\n    }\n\n}"}, {"color": "#22c55e", "id": "OnestudyApplicationTests.contextLoads", "label": "OnestudyApplicationTests.contextLoads()", "shape": "dot", "title": "@Test\n    void contextLoads() {\n    }"}]);
                  edges = new vis.DataSet([{"arrows": "to", "color": "#222", "from": "BaseResponse.ofSucceeded", "title": "calls", "to": "BaseResponse.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "BaseResponse.ofFailed", "title": "calls", "to": "BaseResponse.ofFailed"}, {"arrows": "to", "color": "#222", "from": "BaseResponse.ofGetListSucceeded", "title": "calls", "to": "BaseResponse.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "BeanConfig.authenticationProvider", "title": "calls", "to": "BeanConfig.passwordEncoder"}, {"arrows": "to", "color": "#222", "from": "BeanConfig.authenticationProvider", "title": "calls", "to": "BeanConfig.userDetailsService"}, {"arrows": "to", "color": "#222", "from": "JwtFilter.doFilterInternal", "title": "calls", "to": "JwtProvider.extractUsername"}, {"arrows": "to", "color": "#222", "from": "JwtFilter.doFilterInternal", "title": "calls", "to": "JwtProvider.isTokenValid"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.extractUsername", "title": "calls", "to": "JwtProvider.extractAllClaims"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.extractClaims", "title": "calls", "to": "JwtProvider.extractAllClaims"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.extractAllClaims", "title": "calls", "to": "JwtProvider.getSignInKey"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.generateAccessToken", "title": "calls", "to": "JwtProvider.generateToken"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.generateRefreshToken", "title": "calls", "to": "JwtProvider.generateToken"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.generateToken", "title": "calls", "to": "JwtProvider.buildScope"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.generateToken", "title": "calls", "to": "JwtProvider.getSignInKey"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.generateToken", "title": "calls", "to": "UserPrincipal.getAuthorities"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.generateToken", "title": "calls", "to": "UserPrincipal.getUsername"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.isTokenExpired", "title": "calls", "to": "JwtProvider.extractExpiration"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.extractExpiration", "title": "calls", "to": "JwtProvider.extractClaims"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.isTokenValid", "title": "calls", "to": "JwtProvider.extractUsername"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.isTokenValid", "title": "calls", "to": "JwtProvider.isTokenExpired"}, {"arrows": "to", "color": "#222", "from": "JwtProvider.isTokenValid", "title": "calls", "to": "UserPrincipal.getUsername"}, {"arrows": "to", "color": "#222", "from": "AppUserDetailsService.loadUserByUsername", "title": "calls", "to": "UserPrincipal.from"}, {"arrows": "to", "color": "#222", "from": "AppUserDetailsService.loadUserByUsername", "title": "calls", "to": "UserRepository.getByUsernameForAuth"}, {"arrows": "to", "color": "#222", "from": "BaseService.getMessage", "title": "calls", "to": "BaseService.getMessage"}, {"arrows": "to", "color": "#222", "from": "BaseService.getRequestStringValue", "title": "calls", "to": "BaseService.getRequestValue"}, {"arrows": "to", "color": "#222", "from": "BaseService.getRequestId", "title": "calls", "to": "BaseService.getRequestValue"}, {"arrows": "to", "color": "#222", "from": "BaseService.getRequestBody", "title": "calls", "to": "BaseService.getRequestValue"}, {"arrows": "to", "color": "#222", "from": "BaseService.ofSucceeded", "title": "calls", "to": "BaseResponse.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "BaseService.ofSucceeded", "title": "calls", "to": "BaseService.getRequestId"}, {"arrows": "to", "color": "#222", "from": "BaseService.ofGetListSucceeded", "title": "calls", "to": "BaseResponse.ofGetListSucceeded"}, {"arrows": "to", "color": "#222", "from": "BaseService.ofFailed", "title": "calls", "to": "BaseResponse.ofFailed"}, {"arrows": "to", "color": "#222", "from": "BaseService.ofFailed", "title": "calls", "to": "BaseService.getBusinessError"}, {"arrows": "to", "color": "#222", "from": "BaseService.ofFailed", "title": "calls", "to": "BaseService.getRequestId"}, {"arrows": "to", "color": "#222", "from": "BaseService.getBusinessError", "title": "calls", "to": "BaseService.getMessage"}, {"arrows": "to", "color": "#222", "from": "LogsActivityAOPHandler.logsActivityAnnotation", "title": "calls", "to": "JsonUtils.convertObjectToString"}, {"arrows": "to", "color": "#222", "from": "LogsActivityAOPHandler.logsActivityAnnotation", "title": "calls", "to": "LogsActivityAOPHandler.displayLog"}, {"arrows": "to", "color": "#222", "from": "LogsActivityAOPHandler.logsActivityAnnotation", "title": "calls", "to": "Utils.redact"}, {"arrows": "to", "color": "#222", "from": "LogsActivityAOPHandler.displayLog", "title": "calls", "to": "JsonUtils.getGenericObject"}, {"arrows": "to", "color": "#222", "from": "LogsActivityAOPHandler.displayLog", "title": "calls", "to": "Utils.redact"}, {"arrows": "to", "color": "#222", "from": "AuthController.whoAmI", "title": "calls", "to": "AuthService.getAuthProfile"}, {"arrows": "to", "color": "#222", "from": "AuthController.whoAmI", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.createQuiz", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.createQuiz", "title": "calls", "to": "QuizService.createQuiz"}, {"arrows": "to", "color": "#222", "from": "QuizController.updateQuiz", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.updateQuiz", "title": "calls", "to": "QuizService.updateQuiz"}, {"arrows": "to", "color": "#222", "from": "QuizController.getQuizById", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.getQuizById", "title": "calls", "to": "QuizService.getById"}, {"arrows": "to", "color": "#222", "from": "QuizController.getQuizStatsById", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.getQuizStatsById", "title": "calls", "to": "QuizService.getQuizStatsById"}, {"arrows": "to", "color": "#222", "from": "QuizController.getMyQuizzes", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.getMyQuizzes", "title": "calls", "to": "QuizService.getMyQuizzes"}, {"arrows": "to", "color": "#222", "from": "QuizController.deleteQuiz", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.deleteQuiz", "title": "calls", "to": "QuizService.deleteQuiz"}, {"arrows": "to", "color": "#222", "from": "QuizController.saveQuiz", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.saveQuiz", "title": "calls", "to": "QuizService.saveQuiz"}, {"arrows": "to", "color": "#222", "from": "QuizController.unsaveQuiz", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.unsaveQuiz", "title": "calls", "to": "QuizService.unsaveQuiz"}, {"arrows": "to", "color": "#222", "from": "QuizController.getListUserSavedQuiz", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.getListUserSavedQuiz", "title": "calls", "to": "QuizService.getUserSavedQuiz"}, {"arrows": "to", "color": "#222", "from": "QuizController.getSavedQuizzes", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.getSavedQuizzes", "title": "calls", "to": "QuizService.getSavedQuizzes"}, {"arrows": "to", "color": "#222", "from": "QuizController.attemptQuiz", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.attemptQuiz", "title": "calls", "to": "QuizService.startQuiz"}, {"arrows": "to", "color": "#222", "from": "QuizController.getQuizAttempts", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.getQuizAttempts", "title": "calls", "to": "QuizService.getMyQuizAttempts"}, {"arrows": "to", "color": "#222", "from": "QuizController.getQuizAttempt", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.getQuizAttempt", "title": "calls", "to": "QuizService.getAttempt"}, {"arrows": "to", "color": "#222", "from": "QuizController.submitQuizQuestion", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.submitQuizQuestion", "title": "calls", "to": "QuizService.submitQuizQuestion"}, {"arrows": "to", "color": "#222", "from": "QuizController.submitQuizComplete", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.submitQuizComplete", "title": "calls", "to": "QuizService.submitQuizComplete"}, {"arrows": "to", "color": "#222", "from": "QuizController.search", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.search", "title": "calls", "to": "QuizService.search"}, {"arrows": "to", "color": "#222", "from": "QuizController.search2", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizController.search2", "title": "calls", "to": "QuizService.search2"}, {"arrows": "to", "color": "#222", "from": "ResourceController.uploadResource", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "ResourceController.uploadResource", "title": "calls", "to": "ResourceService.uploadResource"}, {"arrows": "to", "color": "#222", "from": "ResourceController.getResource", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "ResourceController.getResource", "title": "calls", "to": "ResourceService.getResource"}, {"arrows": "to", "color": "#222", "from": "UserController.uploadResource", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "AuthPubController.login", "title": "calls", "to": "AuthService.login"}, {"arrows": "to", "color": "#222", "from": "AuthPubController.login", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "AuthPubController.register", "title": "calls", "to": "AuthService.register"}, {"arrows": "to", "color": "#222", "from": "AuthPubController.register", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "PronunciationController.getSamplePronunciations", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "PronunciationController.getSamplePronunciations", "title": "calls", "to": "PronunciationService.getSample"}, {"arrows": "to", "color": "#222", "from": "PronunciationController.getAccuracy", "title": "calls", "to": "BaseService.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "PronunciationController.getAccuracy", "title": "calls", "to": "PronunciationService.getAccuracy"}, {"arrows": "to", "color": "#222", "from": "QuizPubController.getAllQuizzes", "title": "calls", "to": "BaseResponse.ofSucceeded"}, {"arrows": "to", "color": "#222", "from": "QuizPubController.getAllQuizzes", "title": "calls", "to": "QuizService.getAllPublicQuizzes"}, {"arrows": "to", "color": "#a21caf", "from": "QuestionRepositoryImpl", "title": "implements", "to": "QuestionRepository"}, {"arrows": "to", "color": "#222", "from": "QuestionRepositoryImpl.findByQuizId", "title": "calls", "to": "JpaQuestionRepository.findByQuizId"}, {"arrows": "to", "color": "#222", "from": "QuestionRepositoryImpl.countByQuizId", "title": "calls", "to": "JpaQuestionRepository.countByQuizId"}, {"arrows": "to", "color": "#a21caf", "from": "QuizAnswerRepositoryImpl", "title": "implements", "to": "QuizAnswerRepository"}, {"arrows": "to", "color": "#222", "from": "QuizAnswerRepositoryImpl.findByQuizAttemptId", "title": "calls", "to": "JpaQuizAnswerRepository.findByQuizAttemptId"}, {"arrows": "to", "color": "#a21caf", "from": "QuizAttemptRepositoryImpl", "title": "implements", "to": "QuizAttemptRepository"}, {"arrows": "to", "color": "#222", "from": "QuizAttemptRepositoryImpl.findByUserId", "title": "calls", "to": "JpaQuizAttemptRepository.findByUserId"}, {"arrows": "to", "color": "#222", "from": "QuizAttemptRepositoryImpl.findByQuizId", "title": "calls", "to": "JpaQuizAttemptRepository.findByQuizId"}, {"arrows": "to", "color": "#a21caf", "from": "QuizRepositoryImpl", "title": "implements", "to": "QuizRepository"}, {"arrows": "to", "color": "#222", "from": "QuizRepositoryImpl.findByUserId", "title": "calls", "to": "JpaQuizRepository.findByAuthorId"}, {"arrows": "to", "color": "#222", "from": "QuizRepositoryImpl.findByIdIn", "title": "calls", "to": "JpaQuizRepository.findByIdIn"}, {"arrows": "to", "color": "#222", "from": "QuizRepositoryImpl.findAllPublic", "title": "calls", "to": "JpaQuizRepository.findByStatus"}, {"arrows": "to", "color": "#a21caf", "from": "ResourceRepositoryImpl", "title": "implements", "to": "ResourceRepository"}, {"arrows": "to", "color": "#a21caf", "from": "SavedQuizRepositoryImpl", "title": "implements", "to": "SavedQuizRepository"}, {"arrows": "to", "color": "#222", "from": "SavedQuizRepositoryImpl.findAllByUserId", "title": "calls", "to": "JpaSavedQuizRepository.findByUserId"}, {"arrows": "to", "color": "#222", "from": "SavedQuizRepositoryImpl.deleteByQuizIdAndUserId", "title": "calls", "to": "JpaSavedQuizRepository.deleteByQuizIdAndUserId"}, {"arrows": "to", "color": "#222", "from": "SavedQuizRepositoryImpl.existsByQuizIdAndUserId", "title": "calls", "to": "JpaSavedQuizRepository.existsByQuizIdAndUserId"}, {"arrows": "to", "color": "#222", "from": "SavedQuizRepositoryImpl.findAllByQuizId", "title": "calls", "to": "JpaSavedQuizRepository.findAllByQuizId"}, {"arrows": "to", "color": "#a21caf", "from": "UserRepositoryImpl", "title": "implements", "to": "UserRepository"}, {"arrows": "to", "color": "#222", "from": "UserRepositoryImpl.getByUsername", "title": "calls", "to": "JpaUserRepository.findByUsername"}, {"arrows": "to", "color": "#222", "from": "UserRepositoryImpl.getByUsernameForAuth", "title": "calls", "to": "JpaUserCredentialRepository.findByUserId"}, {"arrows": "to", "color": "#222", "from": "UserRepositoryImpl.getByUsernameForAuth", "title": "calls", "to": "JpaUserRepository.findByUsername"}, {"arrows": "to", "color": "#222", "from": "UserRepositoryImpl.getByEmail", "title": "calls", "to": "JpaUserRepository.findByEmail"}, {"arrows": "to", "color": "#a21caf", "from": "AuthServiceImpl", "title": "implements", "to": "AuthService"}, {"arrows": "to", "color": "#222", "from": "AuthServiceImpl.register", "title": "calls", "to": "UserMapper.authRegisterRequestToUser"}, {"arrows": "to", "color": "#222", "from": "AuthServiceImpl.register", "title": "calls", "to": "UserRepository.getByUsername"}, {"arrows": "to", "color": "#222", "from": "AuthServiceImpl.register", "title": "calls", "to": "UserRepository.persist"}, {"arrows": "to", "color": "#222", "from": "AuthServiceImpl.getAuthProfile", "title": "calls", "to": "UserMapper.userToAuthProfileResponse"}, {"arrows": "to", "color": "#222", "from": "AuthServiceImpl.getAuthProfile", "title": "calls", "to": "UserRepository.getUserById"}, {"arrows": "to", "color": "#222", "from": "AuthServiceImpl.login", "title": "calls", "to": "JwtProvider.generateAccessToken"}, {"arrows": "to", "color": "#222", "from": "AuthServiceImpl.login", "title": "calls", "to": "JwtProvider.generateRefreshToken"}, {"arrows": "to", "color": "#a21caf", "from": "QuestionServiceImpl", "title": "implements", "to": "QuestionService"}, {"arrows": "to", "color": "#a21caf", "from": "QuizServiceImpl", "title": "implements", "to": "QuizService"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.createQuiz", "title": "calls", "to": "QuizMapper.createQuizDtoToQuiz"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.createQuiz", "title": "calls", "to": "QuizRepository.save"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.updateQuiz", "title": "calls", "to": "QuestionMapper.questionDtoToQuestion"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.updateQuiz", "title": "calls", "to": "QuestionMapper.updateQuestionFromDto"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.updateQuiz", "title": "calls", "to": "QuestionRepository.countByQuizId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.updateQuiz", "title": "calls", "to": "QuestionRepository.deleteAll"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.updateQuiz", "title": "calls", "to": "QuestionRepository.findByQuizId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.updateQuiz", "title": "calls", "to": "QuestionRepository.saveAll"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.updateQuiz", "title": "calls", "to": "QuizMapper.updateQuizFromDto"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.updateQuiz", "title": "calls", "to": "QuizRepository.findById"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.updateQuiz", "title": "calls", "to": "QuizRepository.save"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getAllPublicQuizzes", "title": "calls", "to": "QuizRepository.findAllPublic"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getAllPublicQuizzes", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getMyQuizzes", "title": "calls", "to": "QuizRepository.findByUserId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getMyQuizzes", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getById", "title": "calls", "to": "QuestionRepository.findByQuizId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getById", "title": "calls", "to": "QuizRepository.findById"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getById", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.deleteQuiz", "title": "calls", "to": "QuizRepository.findById"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.deleteQuiz", "title": "calls", "to": "QuizRepository.save"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.startQuiz", "title": "calls", "to": "QuizAttemptRepository.save"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.startQuiz", "title": "calls", "to": "QuizRepository.findById"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizQuestion", "title": "calls", "to": "FileUtils.convertToBase64"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizQuestion", "title": "calls", "to": "JsonUtils.toJsonString"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizQuestion", "title": "calls", "to": "PronunciationServiceImpl.getAccuracy"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizQuestion", "title": "calls", "to": "QuestionRepository.findById"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizQuestion", "title": "calls", "to": "QuizAnswerRepository.delete"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizQuestion", "title": "calls", "to": "QuizAnswerRepository.findByQuizAttemptId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizQuestion", "title": "calls", "to": "QuizAnswerRepository.save"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizQuestion", "title": "calls", "to": "QuizAttemptRepository.findById"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizQuestion", "title": "calls", "to": "QuizAttemptRepository.save"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizQuestion", "title": "calls", "to": "QuizRepository.findById"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizQuestion", "title": "calls", "to": "ResourceService.downloadResourceFromUrl"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getMyQuizAttempts", "title": "calls", "to": "QuizAttemptRepository.findByUserId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getMyQuizAttempts", "title": "calls", "to": "QuizRepository.findByIdIn"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getMyQuizAttempts", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getAttempt", "title": "calls", "to": "QuizAnswerRepository.findByQuizAttemptId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getAttempt", "title": "calls", "to": "QuizAttemptRepository.findById"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getAttempt", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizComplete", "title": "calls", "to": "QuizAttemptRepository.findById"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.submitQuizComplete", "title": "calls", "to": "QuizAttemptRepository.save"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getQuizStatsById", "title": "calls", "to": "QuestionRepository.findByQuizId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getQuizStatsById", "title": "calls", "to": "QuizAttemptRepository.findByQuizId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getQuizStatsById", "title": "calls", "to": "QuizRepository.findById"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getQuizStatsById", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getQuizStatsById", "title": "calls", "to": "SavedQuizRepository.findAllByQuizId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getQuizStatsById", "title": "calls", "to": "UserRepository.getUserById"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.saveQuiz", "title": "calls", "to": "SavedQuizRepository.saveQuiz"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getSavedQuizzes", "title": "calls", "to": "QuizRepository.findByIdIn"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getSavedQuizzes", "title": "calls", "to": "QuizServiceImpl.getQuizAuthor"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getSavedQuizzes", "title": "calls", "to": "SavedQuizRepository.findAllByUserId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.unsaveQuiz", "title": "calls", "to": "SavedQuizRepository.findAllByQuizId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.unsaveQuiz", "title": "calls", "to": "SavedQuizRepository.update"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getUserSavedQuiz", "title": "calls", "to": "SavedQuizRepository.findAllByUserId"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getUserSavedQuiz", "title": "calls", "to": "UserRepository.getUserById"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.search", "title": "calls", "to": "QuizRepository.findAll"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.search2", "title": "calls", "to": "QuizRepository.findAll"}, {"arrows": "to", "color": "#222", "from": "QuizServiceImpl.getQuizAuthor", "title": "calls", "to": "UserRepository.getUserById"}, {"arrows": "to", "color": "#a21caf", "from": "ResourceServiceImpl", "title": "implements", "to": "ResourceService"}, {"arrows": "to", "color": "#222", "from": "ResourceServiceImpl.uploadResource", "title": "calls", "to": "ResourceRepository.save"}, {"arrows": "to", "color": "#222", "from": "ResourceServiceImpl.uploadResource", "title": "calls", "to": "StorageService.getProviderName"}, {"arrows": "to", "color": "#222", "from": "ResourceServiceImpl.uploadResource", "title": "calls", "to": "StorageService.uploadFile"}, {"arrows": "to", "color": "#222", "from": "ResourceServiceImpl.getResource", "title": "calls", "to": "ResourceRepository.findById"}, {"arrows": "to", "color": "#222", "from": "ResourceServiceImpl.getResource", "title": "calls", "to": "StorageService.getFileUrl"}, {"arrows": "to", "color": "#a21caf", "from": "PronunciationServiceImpl", "title": "implements", "to": "PronunciationService"}, {"arrows": "to", "color": "#222", "from": "PronunciationServiceImpl.getSample", "title": "calls", "to": "PronunciationFeignClient.getSample"}, {"arrows": "to", "color": "#222", "from": "PronunciationServiceImpl.getSample", "title": "calls", "to": "PronunciationMapper.toGetPronunciationSampleResponseDto"}, {"arrows": "to", "color": "#222", "from": "PronunciationServiceImpl.getSample", "title": "calls", "to": "PronunciationMapper.toSampleRequest"}, {"arrows": "to", "color": "#222", "from": "PronunciationServiceImpl.getAccuracy", "title": "calls", "to": "PronunciationFeignClient.getAccuracyFromRecordedAudio"}, {"arrows": "to", "color": "#222", "from": "PronunciationServiceImpl.getAccuracy", "title": "calls", "to": "PronunciationMapper.toPronunciationAccuracyRequest"}, {"arrows": "to", "color": "#222", "from": "PronunciationServiceImpl.getAccuracy", "title": "calls", "to": "PronunciationMapper.toPronunciationAccuracyResponseDto"}, {"arrows": "to", "color": "#222", "from": "AwsStorageServiceImpl.uploadFile", "title": "calls", "to": "AwsStorageServiceImpl.getFileUrl"}]);

                  nodeColors = {};
                  allNodes = nodes.get({ returnType: "Object" });
                  for (nodeId in allNodes) {
                    nodeColors[nodeId] = allNodes[nodeId].color;
                  }
                  allEdges = edges.get({ returnType: "Object" });
                  // adding nodes and edges to the graph
                  data = {nodes: nodes, edges: edges};

                  var options = {
    "configure": {
        "enabled": false
    },
    "edges": {
        "color": {
            "inherit": true
        },
        "smooth": {
            "enabled": true,
            "type": "dynamic"
        }
    },
    "interaction": {
        "dragNodes": true,
        "hideEdgesOnDrag": false,
        "hideNodesOnDrag": false
    },
    "physics": {
        "barnesHut": {
            "avoidOverlap": 0,
            "centralGravity": 0.3,
            "damping": 0.09,
            "gravitationalConstant": -80000,
            "springConstant": 0.001,
            "springLength": 250
        },
        "enabled": true,
        "stabilization": {
            "enabled": true,
            "fit": true,
            "iterations": 1000,
            "onlyDynamicEdges": false,
            "updateInterval": 50
        }
    }
};

                  


                  

                  network = new vis.Network(container, data, options);

                  

                  

                  


                  
                      network.on("stabilizationProgress", function(params) {
                          document.getElementById('loadingBar').removeAttribute("style");
                          var maxWidth = 496;
                          var minWidth = 20;
                          var widthFactor = params.iterations/params.total;
                          var width = Math.max(minWidth,maxWidth * widthFactor);
                          document.getElementById('bar').style.width = width + 'px';
                          document.getElementById('text').innerHTML = Math.round(widthFactor*100) + '%';
                      });
                      network.once("stabilizationIterationsDone", function() {
                          document.getElementById('text').innerHTML = '100%';
                          document.getElementById('bar').style.width = '496px';
                          document.getElementById('loadingBar').style.opacity = 0;
                          // really clean the dom element
                          setTimeout(function () {document.getElementById('loadingBar').style.display = 'none';}, 500);
                      });
                  

                  return network;

              }
              drawGraph();
        </script>
    </body>
</html>